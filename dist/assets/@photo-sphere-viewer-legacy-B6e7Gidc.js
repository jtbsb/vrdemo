System.register(["./three-legacy-ulRJQmLS.js"],(function(t,e){"use strict";var i,s,o,n,r,a,h,l,c,d,p,u,v,m,g,f,w,y,b,x,E,_,k,M,C,T,L,S,z,P,O;return{setters:[t=>{i=t.M,s=t.V,o=t.C,n=t.W,r=t.L,a=t.a,h=t.S,l=t.P,c=t.b,d=t.c,p=t.d,u=t.R,v=t.F,m=t.G,g=t.e,f=t.f,w=t.g,y=t.B,b=t.E,x=t.h,E=t.Q,_=t.T,k=t.i,M=t.j,C=t.k,T=t.l,L=t.m,S=t.O,z=t.n,P=t.o,O=t.p}],execute:function(){var e=document.createElement("style");e.textContent='/*!\n * Photo Sphere Viewer / Map Plugin 5.13.2\n * @copyright 2015-2025 Damien "Mistic" Sorel\n * @licence MIT (https://opensource.org/licenses/MIT)\n */.psv-container{--psv-map-plugin-loaded: true}.psv-map{position:absolute;margin:10px;z-index:40;transition:all ease-in-out .3s}.psv-map__container{position:absolute;top:0;left:0;width:100%;height:100%;z-index:-1;background:rgba(61,61,61,.7);overflow:hidden;transition:all ease-in-out .3s}.psv-map__container svg,.psv-map__container img,.psv-map__container canvas{width:100%;height:100%}.psv-map--round .psv-map__container{border-radius:50%;box-shadow:0 0 5px rgba(0,0,0,.7)}.psv-map--square{border-radius:8px;box-shadow:0 0 5px rgba(0,0,0,.7);overflow:hidden}.psv-map__overlay{position:absolute;top:0;left:0;width:100%;height:100%;pointer-events:none}.psv-map__toolbar{position:absolute;bottom:1em;left:calc(50% - 3.25em);display:flex;justify-content:center;align-items:center;font:12px sans-serif;padding:.25em;border-radius:1.5em;background:#222;color:#fff;user-select:none;transition:opacity ease-in-out .3s}.psv-map__toolbar svg{height:1em;cursor:pointer}.psv-map__toolbar-text{width:4em;text-align:center}.psv-map__button{position:absolute;width:34px;aspect-ratio:1;line-height:0;background:rgba(0,0,0,.5);display:flex;justify-content:center;align-items:center;transform-origin:center;color:rgba(255,255,255,.7);cursor:pointer;transition:all ease-in-out .3s}.psv-map__button svg{width:60%}.psv-map__button--top-left{left:0;top:0;border-bottom-right-radius:8px;transform:translate(-3px,-3px)}.psv-map__button--top-right{right:0;top:0;border-bottom-left-radius:8px;transform:translate(3px,-3px)}.psv-map__button--bottom-left{left:0;bottom:0;border-top-right-radius:8px;transform:translate(-3px,3px)}.psv-map__button--bottom-right{right:0;bottom:0;border-top-left-radius:8px;transform:translate(3px,3px)}.psv-map--round .psv-map__button{border-radius:50%}.psv-map--square .psv-map__button{transform:unset}.psv-map--maximized{margin:0!important;width:100%!important;height:100%!important}.psv--has-navbar .psv-map--maximized{height:calc(100% - 40px)!important}.psv-map--maximized,.psv-map--maximized .psv-map__container{border-radius:0}.psv-map--round.psv-map--maximized .psv-map__button{outline:2px solid currentcolor}.psv-map--round.psv-map--maximized .psv-map__button--top-left{left:10px;top:10px}.psv-map--round.psv-map--maximized .psv-map__button--top-right{right:10px;top:10px}.psv-map--round.psv-map--maximized .psv-map__button--bottom-left{left:10px;bottom:10px}.psv-map--round.psv-map--maximized .psv-map__button--bottom-right{right:10px;bottom:10px}.psv-map--collapsed{width:34px!important;height:34px!important}.psv-map--collapsed>*{opacity:0}.psv-map--collapsed .psv-map__button-close{opacity:1;transform:translate(0);z-index:1}.psv-map--top-left{top:0;left:0}.psv-map--top-right{top:0;right:0}.psv-map--bottom-left{bottom:0;left:0}.psv--has-navbar .psv-map--bottom-left{bottom:40px}.psv-map--bottom-right{bottom:0;right:0}.psv--has-navbar .psv-map--bottom-right{bottom:40px}/*!\n* Photo Sphere Viewer 5.13.2\n* @copyright 2014-2015 Jérémy Heleine\n* @copyright 2015-2025 Damien "Mistic" Sorel\n* @licence MIT (https://opensource.org/licenses/MIT)\n*/.psv-container{--psv-core-loaded: true;container-name:psv-container;container-type:size;width:100%;height:100%;margin:0;padding:0;position:relative;background:radial-gradient(#fff,#fdfdfd 16%,#fbfbfb 33%,#f8f8f8 49%,#efefef 66%,#dfdfdf 82%,#bfbfbf);overflow:hidden}.psv-container *{box-sizing:content-box}.psv-canvas-container{position:absolute;top:0;left:0;z-index:0;transition:opacity linear .1s}.psv-fullscreen-emulation{position:fixed!important;top:0!important;left:0!important;width:100%!important;height:100%!important}.psv-loader-container{display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:0;width:100%;height:100%;z-index:80}.psv-loader{--psv-loader-border: 3px;--psv-loader-tickness: 10px;position:relative;display:flex;justify-content:center;align-items:center;color:rgba(255,255,255,.7);width:150px;height:150px}.psv-loader-canvas{position:absolute;top:0;left:0;width:100%;height:100%;color:rgba(61,61,61,.5);z-index:-1}.psv-loader-text{font:600 16px sans-serif;text-align:center}.psv-loader--undefined .psv-loader-canvas{animation:psv-loader 2s cubic-bezier(.75,.25,.25,.75) infinite}@keyframes psv-loader{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.psv-navbar{display:flex;position:absolute;z-index:90;bottom:-40px;left:0;width:100%;height:40px;background:rgba(61,61,61,.5);transition:bottom ease-in-out .1s;font:16px sans-serif;cursor:default}.psv-navbar--open{bottom:0}.psv-navbar,.psv-navbar *{box-sizing:content-box}.psv-button{flex:0 0 auto;padding:10px;position:relative;cursor:pointer;height:20px;width:20px;background:transparent;color:rgba(255,255,255,.7)}.psv-button--active{background:rgba(255,255,255,.2)}.psv-button--disabled{pointer-events:none;opacity:.5}.psv-button-svg{width:100%;transform:scale(1);transition:transform .2s ease;vertical-align:initial}.psv-button:not(.psv-button--disabled):focus-visible{outline:2px solid #007cff;outline-offset:-2px}.psv-container:not(.psv--is-touch) .psv-button--hover-scale:not(.psv-button--disabled):hover .psv-button-svg{transform:scale(1.2)}.psv-move-button+.psv-move-button{margin-left:-10px}.psv-download-button{color:rgba(255,255,255,.7)!important;text-decoration:none!important}.psv-download-button:before,.psv-download-button:after{display:none!important}.psv-custom-button{width:auto;min-width:20px}.psv-custom-button--no-padding{padding:0;height:100%}.psv-caption{flex:1 1 100%;color:rgba(255,255,255,.7);overflow:hidden;text-align:center;cursor:unset;padding:unset;height:unset;width:unset}.psv-caption-content{display:inline-block;padding:10px;white-space:nowrap}.psv-zoom-range.psv-button{width:80px;height:1px;margin:10px 0;padding:9.5px 0;max-width:600px}.psv-zoom-range-line{position:relative;width:80px;height:1px;background:rgba(255,255,255,.7);transition:all .3s ease}.psv-zoom-range-handle{position:absolute;border-radius:50%;top:-3px;width:7px;height:7px;background:rgba(255,255,255,.7);transform:scale(1);transition:transform .3s ease}.psv-zoom-range:not(.psv-button--disabled):hover .psv-zoom-range-line{box-shadow:0 0 2px rgba(255,255,255,.7)}.psv-zoom-range:not(.psv-button--disabled):hover .psv-zoom-range-handle{transform:scale(1.3)}.psv-notification{position:absolute;z-index:100;bottom:-40px;display:flex;justify-content:center;box-sizing:border-box;width:100%;padding:0 2em;opacity:0;transition-property:opacity,bottom;transition-timing-function:ease-in-out;transition-duration:.2s}.psv-notification-content{max-width:50em;background:rgba(61,61,61,.8);border-radius:4px;padding:.5em 1em;font:14px sans-serif;color:#fff}.psv-notification--visible{opacity:100;bottom:80px}.psv-overlay{display:flex;flex-direction:column;align-items:center;justify-content:center;position:absolute;z-index:110;top:0;right:0;bottom:0;left:0;background:radial-gradient(#fff,#fdfdfd 16%,#fbfbfb 33%,#f8f8f8 49%,#efefef 66%,#dfdfdf 82%,#bfbfbf);opacity:.8;cursor:default}.psv-overlay-image{width:100%;text-align:center;color:#303030}.psv-overlay-image svg{width:50%}@container psv-container (orientation: landscape){.psv-overlay-image svg{width:33%}}.psv-overlay-title{color:#000;margin-top:1em;font:30px sans-serif;text-align:center}.psv-overlay-text{color:rgba(0,0,0,.8);font:20px sans-serif;opacity:.8;text-align:center}.psv-panel{position:absolute;z-index:90;right:0;height:100%;width:400px;max-width:calc(100% - 9px);background:rgba(10,10,10,.7);transform:translate3d(100%,0,0);opacity:0;transition-property:opacity,transform;transition-timing-function:ease-in-out;transition-duration:.1s;cursor:default;margin-left:9px}.psv--has-navbar .psv-panel{height:calc(100% - 40px)}.psv-panel-close-button{display:none;position:absolute;top:-1px;right:0;width:19.2px;height:19.2px;padding:6.4px;background:transparent;color:#fff;transition:background .3s ease-in-out;cursor:pointer}.psv-panel-close-button svg{transition:transform .3s ease-in-out}.psv-panel-close-button:hover{background:rgba(0,0,0,.9)}.psv-panel-close-button:hover svg{transform:scale(-1)}.psv-panel-resizer{display:none;position:absolute;top:0;left:-9px;width:9px;height:100%;background-color:rgba(0,0,0,.9);cursor:col-resize}.psv-panel-resizer:before{content:"";position:absolute;top:50%;left:5.5px;margin-top:-14.5px;width:1px;height:1px;box-shadow:1px 0 #fff,3px 0 #fff,5px 0 #fff,1px 2px #fff,3px 2px #fff,5px 2px #fff,1px 4px #fff,3px 4px #fff,5px 4px #fff,1px 6px #fff,3px 6px #fff,5px 6px #fff,1px 8px #fff,3px 8px #fff,5px 8px #fff,1px 10px #fff,3px 10px #fff,5px 10px #fff,1px 12px #fff,3px 12px #fff,5px 12px #fff,1px 14px #fff,3px 14px #fff,5px 14px #fff,1px 16px #fff,3px 16px #fff,5px 16px #fff,1px 18px #fff,3px 18px #fff,5px 18px #fff,1px 20px #fff,3px 20px #fff,5px 20px #fff,1px 22px #fff,3px 22px #fff,5px 22px #fff,1px 24px #fff,3px 24px #fff,5px 24px #fff,1px 26px #fff,3px 26px #fff,5px 26px #fff,1px 28px #fff,3px 28px #fff,5px 28px #fff;background:transparent}.psv-panel-content{width:100%;height:100%;box-sizing:border-box;color:#dcdcdc;font:16px sans-serif;overflow:auto}.psv-panel-content:not(.psv-panel-content--no-margin){padding:1em}.psv-panel-content--no-interaction{user-select:none;pointer-events:none}.psv-panel--open{transform:translateZ(0);opacity:1;transition-duration:.2s}.psv-panel--open .psv-panel-close-button,.psv-panel--open .psv-panel-resizer{display:block}@container psv-container (max-width: 400px){.psv-panel{width:100%!important;max-width:none}.psv-panel-resizer{display:none!important}}.psv-panel-menu{height:100%;display:flex;flex-direction:column}.psv-panel-menu-title{flex:none;display:flex;align-items:center;font:24px sans-serif;margin:24px 12px}.psv-panel-menu-title svg{width:24px;height:24px;margin-right:12px}.psv-panel-menu-list{flex:1;list-style:none;margin:0;padding:0;overflow-x:hidden}.psv-panel-menu-item{min-height:1.5em;padding:.5em 1em;cursor:pointer;display:flex;align-items:center;justify-content:flex-start;transition:background .1s ease-in-out}.psv-panel-menu-item--active{outline:1px solid currentcolor;outline-offset:-1px}.psv-panel-menu-item-icon{flex:none;height:1.5em;width:1.5em;margin-right:.5em}.psv-panel-menu-item-icon img{max-width:100%;max-height:100%}.psv-panel-menu-item-icon svg{width:100%;height:100%}.psv-panel-menu-item:focus-visible{outline:2px solid #007cff;outline-offset:-2px}.psv-panel-menu--stripped .psv-panel-menu-item:hover{background:rgba(255,255,255,.2)}.psv-panel-menu--stripped .psv-panel-menu-item:nth-child(odd),.psv-panel-menu--stripped .psv-panel-menu-item:nth-child(odd):before{background:rgba(255,255,255,.1)}.psv-panel-menu--stripped .psv-panel-menu-item:nth-child(2n),.psv-panel-menu--stripped .psv-panel-menu-item:nth-child(2n):before{background:transparent}.psv-container:not(.psv--is-touch) .psv-panel-menu-item:hover{background:rgba(255,255,255,.2)}.psv-tooltip{position:absolute;z-index:50;box-sizing:border-box;max-width:200px;background:rgba(61,61,61,.8);border-radius:4px;opacity:0;transition-property:opacity,transform;transition-timing-function:ease-in-out;transition-duration:.1s;cursor:default}.psv-tooltip-content{color:#fff;font:14px sans-serif;text-shadow:0 1px #000;padding:.5em 1em}.psv-tooltip-arrow{position:absolute;height:0;width:0;border:7px solid transparent}.psv-tooltip--top-left,.psv-tooltip--top-center,.psv-tooltip--top-right{transform:translate3d(0,5px,0)}.psv-tooltip--top-left .psv-tooltip-arrow,.psv-tooltip--top-center .psv-tooltip-arrow,.psv-tooltip--top-right .psv-tooltip-arrow{border-top-color:rgba(61,61,61,.8)}.psv-tooltip--bottom-left,.psv-tooltip--bottom-center,.psv-tooltip--bottom-right{transform:translate3d(0,-5px,0)}.psv-tooltip--bottom-left .psv-tooltip-arrow,.psv-tooltip--bottom-center .psv-tooltip-arrow,.psv-tooltip--bottom-right .psv-tooltip-arrow{border-bottom-color:rgba(61,61,61,.8)}.psv-tooltip--left-top,.psv-tooltip--center-left,.psv-tooltip--left-bottom{transform:translate3d(5px,0,0)}.psv-tooltip--left-top .psv-tooltip-arrow,.psv-tooltip--center-left .psv-tooltip-arrow,.psv-tooltip--left-bottom .psv-tooltip-arrow{border-left-color:rgba(61,61,61,.8)}.psv-tooltip--right-top,.psv-tooltip--center-right,.psv-tooltip--right-bottom{transform:translate3d(-5px,0,0)}.psv-tooltip--right-top .psv-tooltip-arrow,.psv-tooltip--center-right .psv-tooltip-arrow,.psv-tooltip--right-bottom .psv-tooltip-arrow{border-right-color:rgba(61,61,61,.8)}.psv-tooltip--left-top,.psv-tooltip--top-left{box-shadow:-3px -3px rgba(90,90,90,.7)}.psv-tooltip--top-center{box-shadow:0 -3px rgba(90,90,90,.7)}.psv-tooltip--right-top,.psv-tooltip--top-right{box-shadow:3px -3px rgba(90,90,90,.7)}.psv-tooltip--left-bottom,.psv-tooltip--bottom-left{box-shadow:-3px 3px rgba(90,90,90,.7)}.psv-tooltip--bottom-center{box-shadow:0 3px rgba(90,90,90,.7)}.psv-tooltip--right-bottom,.psv-tooltip--bottom-right{box-shadow:3px 3px rgba(90,90,90,.7)}.psv-tooltip--center-left{box-shadow:-3px 0 rgba(90,90,90,.7)}.psv-tooltip--center-right{box-shadow:3px 0 rgba(90,90,90,.7)}.psv-tooltip--visible{transform:translateZ(0);opacity:1}/*!\n* Photo Sphere Viewer / Markers Plugin 5.13.2\n* @copyright 2015-2025 Damien "Mistic" Sorel\n* @licence MIT (https://opensource.org/licenses/MIT)\n*/.psv-container{--psv-markers-plugin-loaded: true}.psv-markers{pointer-events:none;position:absolute;z-index:10;width:100%;height:100%}.psv-markers-svg-container{position:absolute;top:0;left:0;width:100%;height:100%;z-index:20}.psv-markers-css3d-container{position:absolute;z-index:21}.psv-marker{display:none;pointer-events:auto}.psv-marker--normal{position:absolute;top:0;left:0;z-index:30;overflow:visible;background-size:contain;background-repeat:no-repeat}.psv-marker--css3d{display:block}.psv-marker--transparent{display:block;opacity:0}.psv-marker--visible{display:block}.psv-marker--has-tooltip,.psv-marker--has-content{cursor:pointer}\n/*$vite$:1*/',document.head.appendChild(e);
/*!
 * Photo Sphere Viewer 5.13.2
 * @copyright 2014-2015 Jérémy Heleine
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */
var I=Object.defineProperty,D=(t,e)=>{for(var i in e)I(t,i,{get:e[i],enumerable:!0})},A={};D(A,{ACTIONS:()=>Z,ANIMATION_MIN_DURATION:()=>R,CAPTURE_EVENTS_CLASS:()=>Y,CTRLZOOM_TIMEOUT:()=>$,DBLCLICK_DELAY:()=>j,EASINGS:()=>q,ICONS:()=>K,IDS:()=>B,KEY_CODES:()=>X,LONGTOUCH_DELAY:()=>V,MOVE_THRESHOLD:()=>N,SPHERE_RADIUS:()=>F,TWOFINGERSOVERLAY_DELAY:()=>U,VIEWER_DATA:()=>W});var H,R=500,N=4,j=300,V=500,U=100,$=2e3,F=10,W="photoSphereViewer",Y="psv--capture-event",Z=(t=>(t.ROTATE_UP="ROTATE_UP",t.ROTATE_DOWN="ROTATE_DOWN",t.ROTATE_RIGHT="ROTATE_RIGHT",t.ROTATE_LEFT="ROTATE_LEFT",t.ZOOM_IN="ZOOM_IN",t.ZOOM_OUT="ZOOM_OUT",t))(Z||{}),B={MENU:"menu",TWO_FINGERS:"twoFingers",CTRL_ZOOM:"ctrlZoom",ERROR:"error",DESCRIPTION:"description"},X={Enter:"Enter",Control:"Control",Escape:"Escape",Space:" ",PageUp:"PageUp",PageDown:"PageDown",ArrowLeft:"ArrowLeft",ArrowUp:"ArrowUp",ArrowRight:"ArrowRight",ArrowDown:"ArrowDown",Delete:"Delete",Plus:"+",Minus:"-"},K={arrow:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="40 40 432 432"><g transform="rotate(0, 256, 256)"><path fill="currentColor" d="M425.23 210.55H227.39a5 5 0 01-3.53-8.53l56.56-56.57a45.5 45.5 0 000-64.28 45.15 45.15 0 00-32.13-13.3 45.15 45.15 0 00-32.14 13.3L41.32 256l174.83 174.83a45.15 45.15 0 0032.14 13.3 45.15 45.15 0 0032.13-13.3 45.5 45.5 0 000-64.28l-56.57-56.57a5 5 0 013.54-8.53h197.84c25.06 0 45.45-20.39 45.45-45.45s-20.4-45.45-45.45-45.45z"/></g>\x3c!-- Created by Flatart from the Noun Project --\x3e</svg>\n',close:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><g fill="currentColor" transform=" translate(50, 50) rotate(45)"><rect x="-5" y="-65" width="10" height="130"/><rect x="-65" y="-5" width="130" height="10"/></g></svg>',download:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M83.3 35.6h-17V3H32.2v32.6H16.6l33.6 32.7 33-32.7z"/><path fill="currentColor" d="M83.3 64.2v16.3H16.6V64.2H-.1v32.6H100V64.2H83.3z"/>\x3c!--Created by Michael Zenaty from the Noun Project--\x3e</svg>\n',fullscreenIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M100 40H87.1V18.8h-21V6H100zM100 93.2H66V80.3h21.1v-21H100zM34 93.2H0v-34h12.9v21.1h21zM12.9 40H0V6h34v12.9H12.8z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',fullscreenOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M66 7h13v21h21v13H66zM66 60.3h34v12.9H79v21H66zM0 60.3h34v34H21V73.1H0zM21 7h13v34H0V28h21z"/>\x3c!--Created by Garrett Knoll from the Noun Project--\x3e</svg>\n',info:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 64 64"><path fill="currentColor" d="M28.3 26.1c-1 2.6-1.9 4.8-2.6 7-2.5 7.4-5 14.7-7.2 22-1.3 4.4.5 7.2 4.3 7.8 1.3.2 2.8.2 4.2-.1 8.2-2 11.9-8.6 15.7-15.2l-2.2 2a18.8 18.8 0 0 1-7.4 5.2 2 2 0 0 1-1.6-.2c-.2-.1 0-1 0-1.4l.8-1.8L41.9 28c.5-1.4.9-3 .7-4.4-.2-2.6-3-4.4-6.3-4.4-8.8.2-15 4.5-19.5 11.8-.2.3-.2.6-.3 1.3 3.7-2.8 6.8-6.1 11.8-6.2z"/><circle fill="currentColor" cx="39.3" cy="9.2" r="8.2"/>\x3c!--Created by Arafat Uddin from the Noun Project--\x3e</svg>\n',menu:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 10 80 80"><g fill="currentColor"><circle r="10" cx="20" cy="20"/><circle r="10" cx="50" cy="20"/><circle r="10" cx="80" cy="20"/><circle r="10" cx="20" cy="50"/><circle r="10" cx="50" cy="50"/><circle r="10" cx="80" cy="50"/><circle r="10" cx="20" cy="80"/><circle r="10" cx="50" cy="80"/><circle r="10" cx="80" cy="80"/></g>\x3c!-- Created by Richard Kunák from the Noun Project--\x3e</svg>\n',zoomIn:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M8.728 4.009H6.744v2.737H4.006V8.73h2.738v2.736h1.984V8.73h2.737V6.746H8.728z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n',zoomOut:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20"><path fill="currentColor" d="M14.043 12.22a7.738 7.738 0 1 0-1.823 1.822l4.985 4.985c.503.504 1.32.504 1.822 0a1.285 1.285 0 0 0 0-1.822l-4.984-4.985zm-6.305 1.043a5.527 5.527 0 1 1 0-11.053 5.527 5.527 0 0 1 0 11.053z"/><path fill="currentColor" d="M4.006 6.746h7.459V8.73H4.006z"/>\x3c!--Created by Ryan Canning from the Noun Project--\x3e</svg>\n'},q={linear:t=>t,inQuad:t=>t*t,outQuad:t=>t*(2-t),inOutQuad:t=>t<.5?2*t*t:(4-2*t)*t-1,inCubic:t=>t*t*t,outCubic:t=>--t*t*t+1,inOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,inQuart:t=>t*t*t*t,outQuart:t=>1- --t*t*t*t,inOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,inQuint:t=>t*t*t*t*t,outQuint:t=>1+--t*t*t*t*t,inOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,inSine:t=>1-Math.cos(t*(Math.PI/2)),outSine:t=>Math.sin(t*(Math.PI/2)),inOutSine:t=>.5-.5*Math.cos(Math.PI*t),inExpo:t=>Math.pow(2,10*(t-1)),outExpo:t=>1-Math.pow(2,-10*t),inOutExpo:t=>(t=2*t-1)<0?.5*Math.pow(2,10*t):1-.5*Math.pow(2,-10*t),inCirc:t=>1-Math.sqrt(1-t*t),outCirc:t=>Math.sqrt(1-(t-1)*(t-1)),inOutCirc:t=>(t*=2)<1?.5-.5*Math.sqrt(1-t*t):.5+.5*Math.sqrt(1-(t-=2)*t)},G=t("u",{});function Q(t,e){let i=t%e;return i<0&&(i+=e),i}function J(t){return t.reduce(((t,e)=>t+e),0)}function tt(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function et(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}function it(t,e){return[0,2*Math.PI,2*-Math.PI].reduce(((i,s)=>{const o=e-t+s;return Math.abs(o)<Math.abs(i)?o:i}),1/0)}function st(t,e){return Math.acos(Math.cos(t.pitch)*Math.cos(e.pitch)*Math.cos(t.yaw-e.yaw)+Math.sin(t.pitch)*Math.sin(e.pitch))}function ot([t,e],[i,s]){t-i>Math.PI?t-=2*Math.PI:t-i<-Math.PI&&(t+=2*Math.PI);const o=(i-t)*Math.cos((e+s)/2),n=s-e;return Math.sqrt(o*o+n*n)}function nt(t){return"string"==typeof t?t.match(/^[a-z]/i)?document.getElementById(t):document.querySelector(t):t}function rt(t,e,i){void 0===i?t.classList.toggle(e):i?t.classList.add(e):i||t.classList.remove(e)}function at(t,e){t.classList.add(...e.split(" ").filter((t=>!!t)))}function ht(t,e){t.classList.remove(...e.split(" ").filter((t=>!!t)))}function lt(t,e){let i=t;do{if(i===e)return!0;i=i.parentElement}while(i);return!1}function ct(t,e){if(!t?.matches)return null;let i=t;do{if(i.matches(e))return i;i=i.parentElement}while(i);return null}function dt(t){return t?.composedPath()[0]||null}function pt(t,e){return t?t.composedPath().find((t=>(t instanceof HTMLElement||t instanceof SVGElement)&&t.matches(e))):null}function ut(t){let e=0,i=0,s=t;for(;s;)e+=s.offsetLeft-s.scrollLeft+s.clientLeft,i+=s.offsetTop-s.scrollTop+s.clientTop,s=s.offsetParent;return e-=window.scrollX,i-=window.scrollY,{x:e,y:i}}function vt(t,e){return window.getComputedStyle(t).getPropertyValue(e)}function mt(t){if(t.touches.length<2)return null;const e={x:t.touches[0].clientX,y:t.touches[0].clientY},i={x:t.touches[1].clientX,y:t.touches[1].clientY};return{distance:tt(e,i),angle:et(e,i),center:{x:(e.x+i.x)/2,y:(e.y+i.y)/2}}}function gt(t,e=!1){return e?t===H:document.fullscreenElement===t}function ft(t,e=!1){e?(H=t,t.classList.add("psv-fullscreen-emulation"),document.dispatchEvent(new Event("fullscreenchange"))):t.requestFullscreen()}function wt(t=!1){t?(H.classList.remove("psv-fullscreen-emulation"),H=null,document.dispatchEvent(new Event("fullscreenchange"))):document.exitFullscreen()}function yt(t){return t.replace(/[A-Z](?:(?=[^A-Z])|[A-Z]*(?=[A-Z][^A-Z]|$))/g,((t,e)=>(e>0?"-":"")+t.toLowerCase()))}function bt(t,e){let i=!1;return function(...s){i||(i=!0,setTimeout((()=>{t.apply(this,s),i=!1}),e))}}function xt(t){if("object"!=typeof t||null===t||"[object Object]"!==Object.prototype.toString.call(t))return!1;if(null===Object.getPrototypeOf(t))return!0;let e=t;for(;null!==Object.getPrototypeOf(e);)e=Object.getPrototypeOf(e);return Object.getPrototypeOf(t)===e}function Et(t,e){const i=e;return function t(e,s){return Array.isArray(s)?(e&&Array.isArray(e)?e.length=0:e=[],s.forEach(((i,s)=>{e[s]=t(null,i)}))):"object"==typeof s?(e&&!Array.isArray(e)||(e={}),Object.keys(s).forEach((o=>{"__proto__"!==o&&("object"==typeof s[o]&&s[o]&&xt(s[o])?s[o]!==i&&(e[o]?t(e[o],s[o]):e[o]=t(null,s[o])):e[o]=s[o])}))):e=s,e}(t,e)}function _t(t){return Et(null,t)}function kt(t){return!t||0===Object.keys(t).length&&t.constructor===Object}function Mt(t){return null==t}function Ct(...t){for(const e of t)if(!Mt(e))return e;return null}function Tt(t,e){if(t===e)return!0;if(Lt(t)&&Lt(e)){if(Object.keys(t).length!==Object.keys(e).length)return!1;for(const i of Object.keys(t))if(!Tt(t[i],e[i]))return!1;return!0}return!1}function Lt(t){return"object"==typeof t&&null!==t}D(G,{Animation:()=>ie,Dynamic:()=>se,MultiDynamic:()=>oe,PressHandler:()=>ne,Slider:()=>ae,SliderDirection:()=>re,addClasses:()=>at,angle:()=>et,applyEulerInverse:()=>qt,checkClosedShadowDom:()=>te,checkStylesheet:()=>Qt,checkVersion:()=>Jt,cleanCssPosition:()=>Ft,clone:()=>_t,createTexture:()=>Xt,cssPositionIsOrdered:()=>Wt,dasherize:()=>yt,deepEqual:()=>Tt,deepmerge:()=>Et,distance:()=>tt,exitFullscreen:()=>wt,firstNonNull:()=>Ct,getAbortError:()=>Ot,getAngle:()=>st,getClosest:()=>ct,getConfigParser:()=>Gt,getElement:()=>nt,getEventTarget:()=>dt,getMatchingTarget:()=>pt,getPosition:()=>ut,getShortestArc:()=>it,getStyleProperty:()=>vt,getTouchData:()=>mt,getXMPValue:()=>Ht,greatArcDistance:()=>ot,hasParent:()=>lt,invertResolvableBoolean:()=>Pt,isAbortError:()=>It,isEmpty:()=>kt,isExtendedPosition:()=>At,isFullscreenEnabled:()=>gt,isNil:()=>Mt,isPlainObject:()=>xt,logWarn:()=>Dt,mergePanoData:()=>ee,parseAngle:()=>Bt,parsePoint:()=>$t,parseSpeed:()=>Yt,removeClasses:()=>ht,requestFullscreen:()=>ft,resolveBoolean:()=>zt,speedToDuration:()=>Zt,sum:()=>J,throttle:()=>bt,toggleClass:()=>rt,wrap:()=>Q});var St=class t extends Error{constructor(e,i){super(i&&i instanceof Error?`${e}: ${i.message}`:e),this.name="PSVError",Error.captureStackTrace?.(this,t)}};function zt(t,e){xt(t)?(e(t.initial,!0),t.promise.then((t=>e(t,!1)))):e(t,!0)}function Pt(t){return{initial:!t.initial,promise:t.promise.then((t=>!t))}}function Ot(){const t=new Error("Loading was aborted.");return t.name="AbortError",t}function It(t){return"AbortError"===t?.name}function Dt(t){console.warn(`PhotoSphereViewer: ${t}`)}function At(t){return!(!t||Array.isArray(t))&&[["textureX","textureY"],["yaw","pitch"]].some((([e,i])=>void 0!==t[e]&&void 0!==t[i]))}function Ht(t,e,i=!0){let s=t.match("<GPano:"+e+">(.*)</GPano:"+e+">");if(null!==s){const t=i?parseInt(s[1],10):parseFloat(s[1]);return isNaN(t)?null:t}if(s=t.match("GPano:"+e+'="(.*?)"'),null!==s){const t=i?parseInt(s[1],10):parseFloat(s[1]);return isNaN(t)?null:t}return null}var Rt={top:"0%",bottom:"100%",left:"0%",right:"100%",center:"50%"},Nt=["left","center","right"],jt=["top","center","bottom"],Vt=[...Nt,...jt],Ut="center";function $t(t){if(!t)return{x:.5,y:.5};if("object"==typeof t)return t;let e=t.toLocaleLowerCase().split(" ").slice(0,2);1===e.length&&(e=Rt[e[0]]?[e[0],Ut]:[e[0],e[0]]);const i="left"!==e[1]&&"right"!==e[1]&&"top"!==e[0]&&"bottom"!==e[0];e=e.map((t=>Rt[t]||t)),i||e.reverse();const s=e.join(" ").match(/^([0-9.]+)% ([0-9.]+)%$/);return s?{x:parseFloat(s[1])/100,y:parseFloat(s[2])/100}:{x:.5,y:.5}}function Ft(t,{allowCenter:e,cssOrder:i}={allowCenter:!0,cssOrder:!0}){return t?("string"==typeof t&&(t=t.split(" ")),1===t.length&&(t[0]===Ut?t=[Ut,Ut]:-1!==Nt.indexOf(t[0])?t=[Ut,t[0]]:-1!==jt.indexOf(t[0])&&(t=[t[0],Ut])),2!==t.length||-1===Vt.indexOf(t[0])||-1===Vt.indexOf(t[1])?(Dt(`Unparsable position ${t}`),null):e||t[0]!==Ut||t[1]!==Ut?(i&&!Wt(t)&&(t=[t[1],t[0]]),t[1]===Ut&&-1!==Nt.indexOf(t[0])&&(t=[Ut,t[0]]),t[0]===Ut&&-1!==jt.indexOf(t[1])&&(t=[t[1],Ut]),t):(Dt("Invalid position center center"),null)):null}function Wt(t){return-1!==jt.indexOf(t[0])&&-1!==Nt.indexOf(t[1])}function Yt(t){let e;if("string"==typeof t){const s=t.toString().trim();let o=parseFloat(s.replace(/^(-?[0-9]+(?:\.[0-9]*)?).*$/,"$1"));const n=s.replace(/^-?[0-9]+(?:\.[0-9]*)?(.*)$/,"$1").trim();switch(n.match(/(pm|per minute)$/)&&(o/=60),n){case"dpm":case"degrees per minute":case"dps":case"degrees per second":e=i.degToRad(o);break;case"rdpm":case"radians per minute":case"rdps":case"radians per second":e=o;break;case"rpm":case"revolutions per minute":case"rps":case"revolutions per second":e=o*Math.PI*2;break;default:throw new St(`Unknown speed unit "${n}"`)}}else e=t;return e}function Zt(t,e){if("number"!=typeof t){const i=Yt(t);return e/Math.abs(i)*1e3}return Math.abs(t)}function Bt(t,e=!1,s=e){let o;if("string"==typeof t){const e=t.toLowerCase().trim().match(/^(-?[0-9]+(?:\.[0-9]*)?)(.*)$/);if(!e)throw new St(`Unknown angle "${t}"`);const s=parseFloat(e[1]),n=e[2];if(n)switch(n){case"deg":case"degs":o=i.degToRad(s);break;case"rad":case"rads":o=s;break;default:throw new St(`Unknown angle unit "${n}"`)}else o=s}else{if("number"!=typeof t||isNaN(t))throw new St(`Unknown angle "${t}"`);o=t}return o=Q(e?o+Math.PI:o,2*Math.PI),e?i.clamp(o-Math.PI,-Math.PI/(s?2:1),Math.PI/(s?2:1)):o}function Xt(t,e=!1){const i=new _(t);return i.needsUpdate=!0,i.minFilter=e?k:M,i.generateMipmaps=e,i.anisotropy=e?2:1,i}var Kt=new E;function qt(t,e){Kt.setFromEuler(e).invert(),t.applyQuaternion(Kt)}function Gt(t,e){const i=function(i){const s=_t({...t,...i}),o={};for(let[n,r]of Object.entries(s)){if(e&&n in e)r=e[n](r,{rawConfig:s,defValue:t[n]});else if(!(n in t)){Dt(`Unknown option ${n}`);continue}o[n]=r}return o};return i.defaults=t,i.parsers=e||{},i}function Qt(t,e){"true"!==vt(t,`--psv-${e}-loaded`)&&console.error(`PhotoSphereViewer: stylesheet "@photo-sphere-viewer/${e}/index.css" is not loaded`)}function Jt(t,e,i){e&&e!==i&&console.error(`PhotoSphereViewer: @photo-sphere-viewer/${t} is in version ${e} but @photo-sphere-viewer/core is in version ${i}`)}function te(t){do{if(t instanceof ShadowRoot&&"closed"===t.mode)return void console.error("PhotoSphereViewer: closed shadow DOM detected, the viewer might not work as expected");t=t.parentNode}while(t)}function ee(t,e,i,s){const o={isEquirectangular:!0,fullWidth:Ct(i?.fullWidth,s?.fullWidth),fullHeight:Ct(i?.fullHeight,s?.fullHeight),croppedWidth:t,croppedHeight:e,croppedX:Ct(i?.croppedX,s?.croppedX),croppedY:Ct(i?.croppedY,s?.croppedY),poseHeading:Ct(i?.poseHeading,s?.poseHeading,0),posePitch:Ct(i?.posePitch,s?.posePitch,0),poseRoll:Ct(i?.poseRoll,s?.poseRoll,0),initialHeading:s?.initialHeading,initialPitch:s?.initialPitch,initialFov:s?.initialFov};return o.fullWidth||o.fullHeight||(o.fullWidth=Math.max(t,2*e),o.fullHeight=Math.round(o.fullWidth/2)),o.fullWidth||(o.fullWidth=2*o.fullHeight),o.fullHeight||(o.fullHeight=Math.round(o.fullWidth/2)),null===o.croppedX&&(o.croppedX=Math.round((o.fullWidth-t)/2)),null===o.croppedY&&(o.croppedY=Math.round((o.fullHeight-e)/2)),Math.abs(o.fullWidth-2*o.fullHeight)>1&&(Dt("Invalid panoData, fullWidth should be twice fullHeight"),o.fullHeight=Math.round(o.fullWidth/2)),o.croppedX+o.croppedWidth>o.fullWidth&&(Dt("Invalid panoData, croppedX + croppedWidth > fullWidth"),o.croppedX=o.fullWidth-o.croppedWidth),o.croppedY+o.croppedHeight>o.fullHeight&&(Dt("Invalid panoData, croppedY + croppedHeight > fullHeight"),o.croppedY=o.fullHeight-o.croppedHeight),o.croppedX<0&&(Dt("Invalid panoData, croppedX < 0"),o.croppedX=0),o.croppedY<0&&(Dt("Invalid panoData, croppedY < 0"),o.croppedY=0),o}var ie=class{constructor(t){this.easing=q.linear,this.callbacks=[],this.resolved=!1,this.cancelled=!1,this.options=t,t?(t.easing&&(this.easing="function"==typeof t.easing?t.easing:q[t.easing]||q.linear),this.delayTimeout=setTimeout((()=>{this.delayTimeout=void 0,this.animationFrame=window.requestAnimationFrame((t=>this.__run(t)))}),t.delay||0)):this.resolved=!0}__run(t){if(this.cancelled)return;this.start||(this.start=t);const e=(t-this.start)/this.options.duration,i={};if(e<1){for(const[t,s]of Object.entries(this.options.properties))if(s){const o=s.start+(s.end-s.start)*this.easing(e);i[t]=o}this.options.onTick(i,e),this.animationFrame=window.requestAnimationFrame((t=>this.__run(t)))}else{for(const[t,e]of Object.entries(this.options.properties))e&&(i[t]=e.end);this.options.onTick(i,1),this.__resolve(!0),this.animationFrame=void 0}}__resolve(t){t?this.resolved=!0:this.cancelled=!0,this.callbacks.forEach((e=>e(t))),this.callbacks.length=0}then(t){return this.resolved||this.cancelled?Promise.resolve(this.resolved).then(t):new Promise((t=>{this.callbacks.push(t)})).then(t)}cancel(){this.cancelled||this.resolved||(this.__resolve(!1),this.delayTimeout&&(window.clearTimeout(this.delayTimeout),this.delayTimeout=void 0),this.animationFrame&&(window.cancelAnimationFrame(this.animationFrame),this.animationFrame=void 0))}},se=class{constructor(t,e){if(this.fn=t,this.mode=0,this.speed=0,this.speedMult=0,this.currentSpeed=0,this.target=0,this.__current=0,this.min=e.min,this.max=e.max,this.wrap=e.wrap,this.current=e.defaultValue,this.wrap&&0!==this.min)throw new St("invalid config");this.fn&&this.fn(this.current)}get current(){return this.__current}set current(t){this.__current=t}setSpeed(t){this.speed=t}goto(t,e=1){this.mode=2,this.target=this.wrap?Q(t,this.max):i.clamp(t,this.min,this.max),this.speedMult=e}step(t,e=1){0===e?this.setValue(this.current+t):(2!==this.mode&&(this.target=this.current),this.goto(this.target+t,e))}roll(t=!1,e=1){this.mode=1,this.target=t?-1/0:1/0,this.speedMult=e}stop(){this.mode=0}setValue(t){return this.target=this.wrap?Q(t,this.max):i.clamp(t,this.min,this.max),this.mode=0,this.currentSpeed=0,this.target!==this.current&&(this.current=this.target,this.fn&&this.fn(this.current),!0)}update(t){if(2===this.mode){this.wrap&&Math.abs(this.target-this.current)>this.max/2&&(this.current=this.current<this.target?this.current+this.max:this.current-this.max);const t=this.currentSpeed*this.currentSpeed/(this.speed*this.speedMult*4);Math.abs(this.target-this.current)<=t&&(this.mode=0)}let e=0===this.mode?0:this.speed*this.speedMult;this.target<this.current&&(e=-e),this.currentSpeed<e?this.currentSpeed=Math.min(e,this.currentSpeed+t/1e3*this.speed*this.speedMult*2):this.currentSpeed>e&&(this.currentSpeed=Math.max(e,this.currentSpeed-t/1e3*this.speed*this.speedMult*2));let s=null;return this.current>this.target&&this.currentSpeed?s=Math.max(this.target,this.current+this.currentSpeed*t/1e3):this.current<this.target&&this.currentSpeed&&(s=Math.min(this.target,this.current+this.currentSpeed*t/1e3)),null!==s&&(s=this.wrap?Q(s,this.max):i.clamp(s,this.min,this.max),s!==this.current)&&(this.current=s,this.fn&&this.fn(this.current),!0)}},oe=class{constructor(t,e){this.fn=t,this.dynamics=e,this.fn&&this.fn(this.current)}get current(){return Object.entries(this.dynamics).reduce(((t,[e,i])=>(t[e]=i.current,t)),{})}setSpeed(t){for(const e of Object.values(this.dynamics))e.setSpeed(t)}goto(t,e=1){for(const[i,s]of Object.entries(t))this.dynamics[i].goto(s,e)}step(t,e=1){if(0===e)this.setValue(Object.keys(t).reduce(((e,i)=>(e[i]=t[i]+this.dynamics[i].current,e)),{}));else for(const[i,s]of Object.entries(t))this.dynamics[i].step(s,e)}roll(t,e=1){for(const[i,s]of Object.entries(t))this.dynamics[i].roll(s,e)}stop(){for(const t of Object.values(this.dynamics))t.stop()}setValue(t){let e=!1;for(const[i,s]of Object.entries(t))e=this.dynamics[i].setValue(s)||e;return e&&this.fn&&this.fn(this.current),e}update(t){let e=!1;for(const i of Object.values(this.dynamics))e=i.update(t)||e;return e&&this.fn&&this.fn(this.current),e}},ne=class{constructor(t=200){this.delay=t,this.time=0,this.delay=t}get pending(){return 0!==this.time}down(t){this.timeout&&(clearTimeout(this.timeout),this.timeout=void 0),this.time=(new Date).getTime(),this.data=t}up(t){this.time&&(Date.now()-this.time<this.delay?this.timeout=setTimeout((()=>{t(this.data),this.timeout=void 0,this.time=0,this.data=void 0}),this.delay):(t(this.data),this.time=0,this.data=void 0))}},re=(t=>(t.VERTICAL="VERTICAL",t.HORIZONTAL="HORIZONTAL",t))(re||{}),ae=class{constructor(t,e,i){this.container=t,this.direction=e,this.listener=i,this.mousedown=!1,this.mouseover=!1,this.container.addEventListener("click",this),this.container.addEventListener("mousedown",this),this.container.addEventListener("mouseenter",this),this.container.addEventListener("mouseleave",this),this.container.addEventListener("touchstart",this),this.container.addEventListener("mousemove",this,!0),this.container.addEventListener("touchmove",this,!0),window.addEventListener("mouseup",this),window.addEventListener("touchend",this)}get isVertical(){return"VERTICAL"===this.direction}get isHorizontal(){return"HORIZONTAL"===this.direction}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this)}handleEvent(t){switch(t.type){case"click":t.stopPropagation();break;case"mousedown":this.__onMouseDown(t);break;case"mouseenter":this.__onMouseEnter(t);break;case"mouseleave":this.__onMouseLeave(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t)}}__onMouseDown(t){this.mousedown=!0,this.__update(t.clientX,t.clientY,!0)}__onMouseEnter(t){this.mouseover=!0,this.__update(t.clientX,t.clientY,!0)}__onTouchStart(t){this.mouseover=!0,this.mousedown=!0;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}__onMouseMove(t){(this.mousedown||this.mouseover)&&(t.stopPropagation(),this.__update(t.clientX,t.clientY,!0))}__onTouchMove(t){if(this.mousedown||this.mouseover){t.stopPropagation();const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!0)}}__onMouseUp(t){this.mousedown&&(this.mousedown=!1,this.__update(t.clientX,t.clientY,!1))}__onMouseLeave(t){this.mouseover&&(this.mouseover=!1,this.__update(t.clientX,t.clientY,!0))}__onTouchEnd(t){if(this.mousedown){this.mouseover=!1,this.mousedown=!1;const e=t.changedTouches[0];this.__update(e.clientX,e.clientY,!1)}}__update(t,e,s){const o=this.container.getBoundingClientRect();let n;n=this.isVertical?i.clamp((o.bottom-e)/o.height,0,1):i.clamp((t-o.left)/o.width,0,1),this.listener({value:n,click:!s,mousedown:this.mousedown,mouseover:this.mouseover,cursor:{clientX:t,clientY:e}})}},he={};D(he,{BeforeAnimateEvent:()=>ue,BeforeRenderEvent:()=>me,BeforeRotateEvent:()=>fe,ClickEvent:()=>ye,ConfigChangedEvent:()=>xe,DoubleClickEvent:()=>_e,FullscreenEvent:()=>Me,HideNotificationEvent:()=>Te,HideOverlayEvent:()=>Se,HidePanelEvent:()=>Pe,HideTooltipEvent:()=>Ie,KeypressEvent:()=>Ae,LoadProgressEvent:()=>Re,ObjectEnterEvent:()=>gi,ObjectEvent:()=>vi,ObjectHoverEvent:()=>bi,ObjectLeaveEvent:()=>wi,PanoramaErrorEvent:()=>Fe,PanoramaLoadEvent:()=>je,PanoramaLoadedEvent:()=>Ue,PositionUpdatedEvent:()=>Be,ReadyEvent:()=>Ge,RenderEvent:()=>Je,RollUpdatedEvent:()=>Ke,ShowNotificationEvent:()=>ei,ShowOverlayEvent:()=>si,ShowPanelEvent:()=>ni,ShowTooltipEvent:()=>ai,SizeUpdatedEvent:()=>li,StopAllEvent:()=>di,TransitionDoneEvent:()=>Ye,ViewerEvent:()=>de,ZoomUpdatedEvent:()=>ui});var le=class extends Event{constructor(t,e=!1){super(t,{cancelable:e})}},ce=class extends EventTarget{dispatchEvent(t){return super.dispatchEvent(t)}addEventListener(t,e,i){super.addEventListener(t,e,i)}removeEventListener(t,e,i){super.removeEventListener(t,e,i)}},de=class extends le{},pe=class t extends de{constructor(e,i){super(t.type,!0),this.position=e,this.zoomLevel=i}};pe.type="before-animate";var ue=pe,ve=class t extends de{constructor(e,i){super(t.type),this.timestamp=e,this.elapsed=i}};ve.type="before-render";var me=ve,ge=class t extends de{constructor(e){super(t.type,!0),this.position=e}};ge.type="before-rotate";var fe=ge,we=class t extends de{constructor(e){super(t.type),this.data=e}};we.type="click";var ye=we,be=class t extends de{constructor(e){super(t.type),this.options=e}containsOptions(...t){return t.some((t=>this.options.includes(t)))}};be.type="config-changed";var xe=be,Ee=class t extends de{constructor(e){super(t.type),this.data=e}};Ee.type="dblclick";var _e=Ee,ke=class t extends de{constructor(e){super(t.type),this.fullscreenEnabled=e}};ke.type="fullscreen";var Me=ke,Ce=class t extends de{constructor(e){super(t.type),this.notificationId=e}};Ce.type="hide-notification";var Te=Ce,Le=class t extends de{constructor(e){super(t.type),this.overlayId=e}};Le.type="hide-overlay";var Se=Le,ze=class t extends de{constructor(e){super(t.type),this.panelId=e}};ze.type="hide-panel";var Pe=ze,Oe=class t extends de{constructor(e){super(t.type),this.tooltipData=e}};Oe.type="hide-tooltip";var Ie=Oe,De=class t extends de{constructor(e,i){super(t.type,!0),this.key=e,this.originalEvent=i}};De.type="key-press";var Ae=De,He=class t extends de{constructor(e){super(t.type),this.progress=e}};He.type="load-progress";var Re=He,Ne=class t extends de{constructor(e){super(t.type),this.panorama=e}};Ne.type="panorama-load";var je=Ne,Ve=class t extends de{constructor(e){super(t.type),this.data=e}};Ve.type="panorama-loaded";var Ue=Ve,$e=class t extends de{constructor(e,i){super(t.type),this.panorama=e,this.error=i}};$e.type="panorama-error";var Fe=$e,We=class t extends de{constructor(e){super(t.type),this.completed=e}};We.type="transition-done";var Ye=We,Ze=class t extends de{constructor(e){super(t.type),this.position=e}};Ze.type="position-updated";var Be=Ze,Xe=class t extends de{constructor(e){super(t.type),this.roll=e}};Xe.type="roll-updated";var Ke=Xe,qe=class t extends de{constructor(){super(t.type)}};qe.type="ready";var Ge=qe,Qe=class t extends de{constructor(){super(t.type)}};Qe.type="render";var Je=Qe,ti=class t extends de{constructor(e){super(t.type),this.notificationId=e}};ti.type="show-notification";var ei=ti,ii=class t extends de{constructor(e){super(t.type),this.overlayId=e}};ii.type="show-overlay";var si=ii,oi=class t extends de{constructor(e){super(t.type),this.panelId=e}};oi.type="show-panel";var ni=oi,ri=class t extends de{constructor(e,i){super(t.type),this.tooltip=e,this.tooltipData=i}};ri.type="show-tooltip";var ai=ri,hi=class t extends de{constructor(e){super(t.type),this.size=e}};hi.type="size-updated";var li=hi,ci=class t extends de{constructor(){super(t.type)}};ci.type="stop-all";var di=ci,pi=class t extends de{constructor(e){super(t.type),this.zoomLevel=e}};pi.type="zoom-updated";var ui=pi,vi=class extends de{constructor(t,e,i,s,o){super(t),this.originalEvent=e,this.object=i,this.viewerPoint=s,this.userDataKey=o}},mi=class t extends vi{constructor(e,i,s,o){super(t.type,e,i,s,o)}};mi.type="enter-object";var gi=mi,fi=class t extends vi{constructor(e,i,s,o){super(t.type,e,i,s,o)}};fi.type="leave-object";var wi=fi,yi=class t extends vi{constructor(e,i,s,o){super(t.type,e,i,s,o)}};yi.type="hover-object";var bi=yi,xi=class{constructor(t){this.viewer=t}init(){}destroy(){}supportsTransition(t){return!1}supportsPreload(t){return!1}textureCoordsToSphericalCoords(t,e){throw new St("Current adapter does not support texture coordinates.")}sphericalCoordsToTextureCoords(t,e){throw new St("Current adapter does not support texture coordinates.")}};function Ei(t){if(t)for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof xi)return Jt(e.id,e.VERSION,"5.13.2"),e;return null}xi.supportsDownload=!1;var _i=`${W}_touchSupport`,ki={loaded:!1,pixelRatio:1,isWebGLSupported:!1,maxTextureWidth:0,isTouchEnabled:null,__maxCanvasWidth:null,isIphone:!1,get maxCanvasWidth(){return null===this.__maxCanvasWidth&&(this.__maxCanvasWidth=function(t){let e=t,i=!1;const s=document.createElement("canvas"),o=s.getContext("2d");for(s.width=1,s.height=1;e>1024&&!i;){const t=document.createElement("canvas"),s=t.getContext("2d");t.width=e,t.height=e/2;try{s.fillStyle="white",s.fillRect(e-1,e/2-1,1,1),o.drawImage(t,e-1,e/2-1,1,1,0,0,1,1),o.getImageData(0,0,1,1).data[0]>0&&(i=!0)}catch{}t.width=0,t.height=0,i||(e/=2)}if(i)return e;throw new St("Unable to detect system capabilities")}(this.maxTextureWidth)),this.__maxCanvasWidth},load(){if(!this.loaded){const t=function(){try{return document.createElement("canvas").getContext("webgl2")}catch{return null}}();this.pixelRatio=window.devicePixelRatio||1,this.isWebGLSupported=!!t,this.maxTextureWidth=t?t.getParameter(t.MAX_TEXTURE_SIZE):0,this.isTouchEnabled=function(){let t="ontouchstart"in window||navigator.maxTouchPoints>0;_i in localStorage&&(t="true"===localStorage[_i]);const e=new Promise((e=>{const i=()=>{window.removeEventListener("mousedown",s),window.removeEventListener("touchstart",o),clearTimeout(r)},s=()=>{i(),localStorage[_i]=!1,e(!1)},o=()=>{i(),localStorage[_i]=!0,e(!0)},n=()=>{i(),localStorage[_i]=t,e(t)};window.addEventListener("mousedown",s,!1),window.addEventListener("touchstart",o,!1);const r=setTimeout(n,1e4)}));return{initial:t,promise:e}}(),this.isIphone=/iPhone/i.test(navigator.userAgent),this.loaded=!0}if(!ki.isWebGLSupported)throw new St("WebGL 2 is not supported.");if(0===ki.maxTextureWidth)throw new St("Unable to detect system capabilities")}},Mi=Gt({resolution:64,useXmpData:!0,blur:!1},{resolution:t=>{if(!t||!i.isPowerOfTwo(t))throw new St("EquirectangularAdapter resolution must be power of two.");return t}}),Ci=class extends xi{constructor(t,e){super(t),this.config=Mi(e),this.SPHERE_SEGMENTS=this.config.resolution,this.SPHERE_HORIZONTAL_SEGMENTS=this.SPHERE_SEGMENTS/2}supportsTransition(){return!0}supportsPreload(){return!0}textureCoordsToSphericalCoords(t,e){if(Mt(t.textureX)||Mt(t.textureY))throw new St("Texture position is missing 'textureX' or 'textureY'");const i=(t.textureX+e.croppedX)/e.fullWidth*Math.PI*2,s=(t.textureY+e.croppedY)/e.fullHeight*Math.PI;return{yaw:i>=Math.PI?i-Math.PI:i+Math.PI,pitch:Math.PI/2-s}}sphericalCoordsToTextureCoords(t,e){const i=t.yaw/Math.PI/2*e.fullWidth,s=t.pitch/Math.PI*e.fullHeight;let o=Math.round(t.yaw<Math.PI?i+e.fullWidth/2:i-e.fullWidth/2)-e.croppedX,n=Math.round(e.fullHeight/2-s)-e.croppedY;return(o<0||o>e.croppedWidth||n<0||n>e.croppedHeight)&&(o=n=void 0),{textureX:o,textureY:n}}async loadTexture(t,e=!0,i,s=this.config.useXmpData){if("string"!=typeof t&&("object"!=typeof t||!t.path))return Promise.reject(new St("Invalid panorama url, are you using the right adapter?"));let o;o="string"==typeof t?{path:t,data:i}:{data:i,...t};const n=await this.viewer.textureLoader.loadFile(o.path,e?t=>this.viewer.textureLoader.dispatchProgress(t):null,o.path),r=s?await this.loadXMP(n):null,a=await this.viewer.textureLoader.blobToImage(n);"function"==typeof o.data&&(o.data=o.data(a,r));const h=ee(a.width,a.height,o.data,r);return{panorama:t,texture:this.createEquirectangularTexture(a),panoData:h,cacheKey:o.path}}async loadXMP(t){const e=await this.loadBlobAsString(t),i=e.indexOf("<x:xmpmeta");if(-1===i)return null;const s=e.indexOf("</x:xmpmeta>",i);if(-1===s)return null;const o=e.substring(i,s);return o.includes("GPano:")?{fullWidth:Ht(o,"FullPanoWidthPixels"),fullHeight:Ht(o,"FullPanoHeightPixels"),croppedWidth:Ht(o,"CroppedAreaImageWidthPixels"),croppedHeight:Ht(o,"CroppedAreaImageHeightPixels"),croppedX:Ht(o,"CroppedAreaLeftPixels"),croppedY:Ht(o,"CroppedAreaTopPixels"),poseHeading:Ht(o,"PoseHeadingDegrees",!1),posePitch:Ht(o,"PosePitchDegrees",!1),poseRoll:Ht(o,"PoseRollDegrees",!1),initialHeading:Ht(o,"InitialViewHeadingDegrees",!1),initialPitch:Ht(o,"InitialViewPitchDegrees",!1),initialFov:Ht(o,"InitialHorizontalFOVDegrees",!1)}:null}loadBlobAsString(t){return new Promise(((e,i)=>{const s=new FileReader;s.onload=()=>e(s.result),s.onerror=i,s.readAsText(t)}))}createEquirectangularTexture(t){if(this.config.blur||t.width>ki.maxTextureWidth){const e=Math.min(1,ki.maxCanvasWidth/t.width),i=new OffscreenCanvas(Math.floor(t.width*e),Math.floor(t.height*e)),s=i.getContext("2d");return this.config.blur&&(s.filter=`blur(${i.width/2048}px)`),s.drawImage(t,0,0,i.width,i.height),Xt(i)}return Xt(t)}createMesh(t){const e=t.croppedX/t.fullWidth*2*Math.PI,i=t.croppedWidth/t.fullWidth*2*Math.PI,s=t.croppedY/t.fullHeight*Math.PI,o=t.croppedHeight/t.fullHeight*Math.PI,n=new d(F,Math.round(this.SPHERE_SEGMENTS/(2*Math.PI)*i),Math.round(this.SPHERE_HORIZONTAL_SEGMENTS/Math.PI*o),-Math.PI/2+e,i,s,o).scale(-1,1,1),r=new p({depthTest:!1,depthWrite:!1});return new c(n,r)}setTexture(t,e){t.material.map=e.texture}setTextureOpacity(t,e){t.material.opacity=e,t.material.transparent=e<1}disposeTexture({texture:t}){t.dispose()}disposeMesh(t){t.geometry.dispose(),t.material.dispose()}};Ci.id="equirectangular",Ci.VERSION="5.13.2",Ci.supportsDownload=!0;var Ti=class extends Ci{constructor(t,e){super(t,{resolution:e?.resolution??64,useXmpData:!1})}async loadTexture(t,e){const i=await super.loadTexture(t,e,null,!1);return i.panoData=null,i}createMesh(){const t=new d(F,this.SPHERE_SEGMENTS,this.SPHERE_HORIZONTAL_SEGMENTS).scale(-1,1,1).toNonIndexed(),e=t.getAttribute("uv"),i=t.getAttribute("normal");for(let o=0;o<e.count;o++)for(let t=0;t<3;t++){const s=3*o+t,n=i.getX(s),r=i.getY(s),a=i.getZ(s),h=.947;if(o<e.count/6){const t=0===n&&0===a?1:Math.acos(r)/Math.sqrt(n*n+a*a)*(2/Math.PI);e.setXY(s,n*(h/4)*t+1/4,a*(h/2)*t+.5)}else{const t=0===n&&0===a?1:Math.acos(-r)/Math.sqrt(n*n+a*a)*(2/Math.PI);e.setXY(s,h/4*-n*t+3/4,a*(h/2)*t+.5)}}t.rotateX(-Math.PI/2),t.rotateY(Math.PI);const s=new p({depthTest:!1,depthWrite:!1});return new c(t,s)}};Ti.id="dual-fisheye",Ti.VERSION="5.13.2";var Li=class t{constructor(e,i){this.parent=e,this.children=[],this.state={visible:!0},this.viewer=e instanceof t?e.viewer:e,this.container=document.createElement(i.tagName??"div"),this.container.className=i.className||"",this.parent.children.push(this),this.parent.container.appendChild(this.container)}destroy(){this.parent.container.removeChild(this.container);const t=this.parent.children.indexOf(this);-1!==t&&this.parent.children.splice(t,1),this.children.slice().forEach((t=>t.destroy())),this.children.length=0}toggle(t=!this.isVisible()){t?this.show():this.hide()}hide(t){this.container.style.display="none",this.state.visible=!1}show(t){this.container.style.display="",this.state.visible=!0}isVisible(){return this.state.visible}},Si=Gt({id:null,tagName:null,className:null,title:null,hoverScale:!1,collapsable:!1,tabbable:!0,icon:null,iconActive:null}),zi=class extends Li{constructor(t,e){super(t,{tagName:e.tagName,className:`psv-button ${e.hoverScale?"psv-button--hover-scale":""} ${e.className||""}`}),this.state={visible:!0,enabled:!0,supported:!0,collapsed:!1,active:!1,width:0},this.config=Si(e),e.id||(this.config.id=this.constructor.id),e.icon&&this.__setIcon(e.icon),this.state.width=this.container.offsetWidth,this.config.title?this.container.title=this.viewer.config.lang[this.config.title]??this.config.title:this.id&&this.id in this.viewer.config.lang&&(this.container.title=this.viewer.config.lang[this.id]),e.tabbable&&(this.container.tabIndex=0),this.container.addEventListener("click",(t=>{this.state.enabled&&this.onClick(),t.stopPropagation()})),this.container.addEventListener("keydown",(t=>{t.key===X.Enter&&this.state.enabled&&(this.onClick(),t.stopPropagation())}))}get id(){return this.config.id}get title(){return this.container.title}get content(){return this.container.innerHTML}get width(){return this.state.width}get collapsable(){return this.config.collapsable}show(t=!0){this.isVisible()||(this.state.visible=!0,this.state.collapsed||(this.container.style.display=""),t&&this.viewer.navbar.autoSize())}hide(t=!0){this.isVisible()&&(this.state.visible=!1,this.container.style.display="none",t&&this.viewer.navbar.autoSize())}checkSupported(){zt(this.isSupported(),((t,e)=>{this.state&&(this.state.supported=t,e?t||this.hide():this.toggle(t))}))}autoSize(){}isSupported(){return!0}toggleActive(t=!this.state.active){t!==this.state.active&&(this.state.active=t,rt(this.container,"psv-button--active",this.state.active),this.config.iconActive&&this.__setIcon(this.state.active?this.config.iconActive:this.config.icon))}disable(){this.container.classList.add("psv-button--disabled"),this.state.enabled=!1}enable(){this.container.classList.remove("psv-button--disabled"),this.state.enabled=!0}collapse(){this.state.collapsed=!0,this.container.style.display="none"}uncollapse(){this.state.collapsed=!1,this.state.visible&&(this.container.style.display="")}__setIcon(t){this.container.innerHTML=t,at(this.container.querySelector("svg"),"psv-button-svg")}},Pi=class extends zi{constructor(t,e){super(t,{id:e.id??`psvButton-${Math.random().toString(36).substring(2)}`,className:`psv-custom-button ${e.className||""}`,hoverScale:!1,collapsable:!1!==e.collapsable,tabbable:!1!==e.tabbable,title:e.title}),this.customOnClick=e.onClick,e.content&&("string"==typeof e.content?this.container.innerHTML=e.content:(this.container.classList.add("psv-custom-button--no-padding"),e.content.style.height="100%",e.content.attachViewer?.(this.viewer),this.container.appendChild(e.content))),this.state.width=this.container.offsetWidth,e.disabled&&this.disable(),!1===e.visible&&this.hide()}onClick(){this.customOnClick?.(this.viewer)}},Oi=class extends zi{constructor(t){super(t,{className:"psv-description-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:K.info}),this.mode=0,this.viewer.addEventListener(Te.type,this),this.viewer.addEventListener(ei.type,this),this.viewer.addEventListener(Pe.type,this),this.viewer.addEventListener(ni.type,this),this.viewer.addEventListener(xe.type,this)}destroy(){this.viewer.removeEventListener(Te.type,this),this.viewer.removeEventListener(ei.type,this),this.viewer.removeEventListener(Pe.type,this),this.viewer.removeEventListener(ni.type,this),this.viewer.removeEventListener(xe.type,this),super.destroy()}handleEvent(t){if(t instanceof xe)return void(t.containsOptions("description")&&this.autoSize(!0));if(!this.mode)return;let e=!1;t instanceof Te?e=1===this.mode:t instanceof ei?e=1===this.mode&&t.notificationId!==B.DESCRIPTION:t instanceof Pe?e=2===this.mode:t instanceof ni&&(e=2===this.mode&&t.panelId!==B.DESCRIPTION),e&&(this.toggleActive(!1),this.mode=0)}onClick(){this.mode?this.__close():this.__open()}hide(t){super.hide(t),this.mode&&this.__close()}autoSize(t=!1){if(t){const t=this.viewer.navbar.getButton("caption",!1),e=t&&!t.isVisible(),i=!!this.viewer.config.description;e||i?this.show(!1):this.hide(!1)}}__close(){switch(this.mode){case 1:this.viewer.notification.hide(B.DESCRIPTION);break;case 2:this.viewer.panel.hide(B.DESCRIPTION)}}__open(){this.toggleActive(!0),this.viewer.config.description?(this.mode=2,this.viewer.panel.show({id:B.DESCRIPTION,content:`${this.viewer.config.caption?`<p>${this.viewer.config.caption}</p>`:""}${this.viewer.config.description}`})):(this.mode=1,this.viewer.notification.show({id:B.DESCRIPTION,content:this.viewer.config.caption}))}};Oi.id="description";var Ii=class extends zi{constructor(t){super(t,{tagName:"a",className:"psv-download-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:K.download}),this.viewer.addEventListener(xe.type,this),this.viewer.addEventListener(Ue.type,this)}destroy(){this.viewer.removeEventListener(xe.type,this),this.viewer.removeEventListener(Ue.type,this),super.destroy()}handleEvent(t){t instanceof xe?(t.containsOptions("downloadUrl")&&this.checkSupported(),t.containsOptions("downloadUrl","downloadName")&&this.__update()):t instanceof Ue&&this.__update()}onClick(){}checkSupported(){this.viewer.adapter.constructor.supportsDownload||this.viewer.config.downloadUrl?this.show():this.hide()}__update(){const t=this.container;t.href=this.viewer.config.downloadUrl||this.viewer.config.panorama,t.target="_blank",t.href.startsWith("data:")&&!this.viewer.config.downloadName?t.download="panorama."+t.href.substring(0,t.href.indexOf(";")).split("/").pop():t.download=this.viewer.config.downloadName||t.href.split("/").pop()}};Ii.id="download";var Di=class extends zi{constructor(t){super(t,{className:"psv-fullscreen-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:K.fullscreenIn,iconActive:K.fullscreenOut}),this.viewer.addEventListener(Me.type,this)}destroy(){this.viewer.removeEventListener(Me.type,this),super.destroy()}handleEvent(t){t instanceof Me&&this.toggleActive(t.fullscreenEnabled)}onClick(){this.viewer.toggleFullscreen()}};Di.id="fullscreen";var Ai=class extends zi{constructor(t){super(t,{className:"psv-menu-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:K.menu}),this.viewer.addEventListener(ni.type,this),this.viewer.addEventListener(Pe.type,this),super.hide()}destroy(){this.viewer.removeEventListener(ni.type,this),this.viewer.removeEventListener(Pe.type,this),super.destroy()}handleEvent(t){t instanceof ni?this.toggleActive(t.panelId===B.MENU):t instanceof Pe&&this.toggleActive(!1)}onClick(){this.state.active?this.__hideMenu():this.__showMenu()}hide(t){super.hide(t),this.__hideMenu()}show(t){super.show(t),this.state.active&&this.__showMenu()}__showMenu(){var t,e;this.viewer.panel.show({id:B.MENU,content:(t=this.viewer.navbar.collapsed,e=this.viewer.config.lang.menu,`\n<div class="psv-panel-menu psv-panel-menu--stripped">\n  <h1 class="psv-panel-menu-title">${K.menu} ${e}</h1>\n  <ul class="psv-panel-menu-list">\n    ${t.map((t=>`\n    <li data-psv-button="${t.id}" class="psv-panel-menu-item" tabindex="0">\n      <span class="psv-panel-menu-item-icon">${t.content}</span>\n      <span class="psv-panel-menu-item-label">${t.title}</span>\n    </li>\n    `)).join("")}\n  </ul>\n</div>\n`),noMargin:!0,clickHandler:t=>{const e=t?ct(t,".psv-panel-menu-item"):void 0,i=e?e.dataset.psvButton:void 0;i&&(this.viewer.navbar.getButton(i).onClick(),this.__hideMenu())}})}__hideMenu(){this.viewer.panel.hide(B.MENU)}};function Hi(t){let e=0;switch(t){case 0:e=90;break;case 1:e=-90;break;case 3:e=180;break;default:e=0}return K.arrow.replace("rotate(0",`rotate(${e}`)}Ai.id="menu";var Ri=class extends zi{constructor(t,e){super(t,{className:"psv-move-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:Hi(e)}),this.direction=e,this.handler=new ne,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":t.key===X.Enter&&this.__onMouseDown();break;case"keyup":t.key===X.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return Pt(ki.isTouchEnabled)}__onMouseDown(){if(!this.state.enabled)return;const t={};switch(this.direction){case 0:t.pitch=!1;break;case 1:t.pitch=!0;break;case 3:t.yaw=!1;break;default:t.yaw=!0}this.viewer.stopAll(),this.viewer.dynamics.position.roll(t),this.handler.down()}__onMouseUp(){this.state.enabled&&this.handler.up((()=>{this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer()}))}};Ri.groupId="move";var Ni=class extends Ri{constructor(t){super(t,1)}};Ni.id="moveDown";var ji=class extends Ri{constructor(t){super(t,2)}};ji.id="moveLeft";var Vi=class extends Ri{constructor(t){super(t,3)}};Vi.id="moveRight";var Ui=class extends Ri{constructor(t){super(t,0)}};Ui.id="moveUp";var $i=class extends zi{constructor(t,e,i){super(t,{className:"psv-zoom-button",hoverScale:!0,collapsable:!1,tabbable:!0,icon:e}),this.direction=i,this.handler=new ne,this.container.addEventListener("mousedown",this),this.container.addEventListener("keydown",this),this.container.addEventListener("keyup",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this)}destroy(){this.__onMouseUp(),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown();break;case"mouseup":case"touchend":this.__onMouseUp();break;case"keydown":t.key===X.Enter&&this.__onMouseDown();break;case"keyup":t.key===X.Enter&&this.__onMouseUp()}}onClick(){}isSupported(){return Pt(ki.isTouchEnabled)}__onMouseDown(){this.state.enabled&&(this.viewer.dynamics.zoom.roll(1===this.direction),this.handler.down())}__onMouseUp(){this.state.enabled&&this.handler.up((()=>this.viewer.dynamics.zoom.stop()))}};$i.groupId="zoom";var Fi=class extends $i{constructor(t){super(t,K.zoomIn,0)}};Fi.id="zoomIn";var Wi=class extends $i{constructor(t){super(t,K.zoomOut,1)}};Wi.id="zoomOut";var Yi=class extends zi{constructor(t){super(t,{className:"psv-zoom-range",hoverScale:!1,collapsable:!1,tabbable:!1}),this.zoomRange=document.createElement("div"),this.zoomRange.className="psv-zoom-range-line",this.container.appendChild(this.zoomRange),this.zoomValue=document.createElement("div"),this.zoomValue.className="psv-zoom-range-handle",this.zoomRange.appendChild(this.zoomValue),this.slider=new ae(this.container,"HORIZONTAL",(t=>this.__onSliderUpdate(t))),this.mediaMinWidth=parseInt(vt(this.container,"max-width"),10),this.viewer.addEventListener(ui.type,this),this.viewer.state.ready?this.__moveZoomValue(this.viewer.getZoomLevel()):this.viewer.addEventListener(Ge.type,this)}destroy(){this.slider.destroy(),this.viewer.removeEventListener(ui.type,this),this.viewer.removeEventListener(Ge.type,this),super.destroy()}handleEvent(t){t instanceof ui?this.__moveZoomValue(t.zoomLevel):t instanceof Ge&&this.__moveZoomValue(this.viewer.getZoomLevel())}onClick(){}isSupported(){return Pt(ki.isTouchEnabled)}autoSize(){this.state.supported&&(this.viewer.state.size.width<=this.mediaMinWidth&&this.state.visible?this.hide(!1):this.viewer.state.size.width>this.mediaMinWidth&&!this.state.visible&&this.show(!1))}__moveZoomValue(t){this.zoomValue.style.left=t/100*this.zoomRange.offsetWidth-this.zoomValue.offsetWidth/2+"px"}__onSliderUpdate(t){t.mousedown&&this.viewer.zoom(100*t.value)}};Yi.id="zoomRange",Yi.groupId="zoom";var Zi=class extends ce{constructor(t){super(),this.viewer=t}init(){}destroy(){}},Bi=class extends Zi{constructor(t,e){super(t),this.config=this.constructor.configParser(e)}setOption(t,e){this.setOptions({[t]:e})}setOptions(t){const e={...this.config,...t},i=this.constructor,s=i.configParser,o=i.readonlyOptions,n=i.id;for(let[r,a]of Object.entries(t))r in s.defaults?o.includes(r)?Dt(`${n}: Option "${r}" cannot be updated`):(r in s.parsers&&(a=s.parsers[r](a,{rawConfig:e,defValue:s.defaults[r]})),this.config[r]=a):Dt(`${n}: Unknown option "${r}"`)}};function Xi(t){if(t)for(const[,e]of[["_",t],...Object.entries(t)])if(e.prototype instanceof Zi)return Jt(e.id,e.VERSION,"5.13.2"),e;return null}Bi.readonlyOptions=[];var Ki={panorama:null,container:null,adapter:[Ci,null],plugins:[],caption:null,description:null,downloadUrl:null,downloadName:null,loadingImg:null,loadingTxt:"",size:null,fisheye:0,minFov:30,maxFov:90,defaultZoomLvl:50,defaultYaw:0,defaultPitch:0,sphereCorrection:null,moveSpeed:1,zoomSpeed:1,moveInertia:.8,mousewheel:!0,mousemove:!0,mousewheelCtrlKey:!1,touchmoveTwoFingers:!1,panoData:null,requestHeaders:null,canvasBackground:"#000",defaultTransition:{speed:1500,rotation:!0,effect:"fade"},rendererParameters:{alpha:!0,antialias:!0},withCredentials:!1,navbar:["zoom","move","download","description","caption","fullscreen"],lang:{zoom:"Zoom",zoomOut:"Zoom out",zoomIn:"Zoom in",moveUp:"Move up",moveDown:"Move down",moveLeft:"Move left",moveRight:"Move right",description:"Description",download:"Download",fullscreen:"Fullscreen",loading:"Loading...",menu:"Menu",close:"Close",twoFingers:"Use two fingers to navigate",ctrlZoom:"Use ctrl + scroll to zoom the image",loadError:"The panorama cannot be loaded",webglError:"Your browser does not seem to support WebGL"},keyboard:"fullscreen",keyboardActions:{[X.ArrowUp]:"ROTATE_UP",[X.ArrowDown]:"ROTATE_DOWN",[X.ArrowRight]:"ROTATE_RIGHT",[X.ArrowLeft]:"ROTATE_LEFT",[X.PageUp]:"ZOOM_IN",[X.PageDown]:"ZOOM_OUT",[X.Plus]:"ZOOM_IN",[X.Minus]:"ZOOM_OUT"}},qi={panorama:"Use setPanorama method to change the panorama",panoData:"Use setPanorama method to change the panorama",container:"Cannot change viewer container",adapter:"Cannot change adapter",plugins:"Cannot change plugins"},Gi={container:t=>{if(!t)throw new St("No value given for container.");return t},adapter:(t,{defValue:e})=>{if(!(t=t?Array.isArray(t)?[Ei(t[0]),t[1]]:[Ei(t),null]:e)[0])throw new St("An undefined value was given for adapter.");if(!t[0].id)throw new St("Adapter has no id.");return t},defaultYaw:t=>Bt(t),defaultPitch:t=>Bt(t,!0),defaultZoomLvl:t=>i.clamp(t,0,100),minFov:(t,{rawConfig:e})=>(e.maxFov<t&&(Dt("maxFov cannot be lower than minFov"),t=e.maxFov),i.clamp(t,1,179)),maxFov:(t,{rawConfig:e})=>(t<e.minFov&&(t=e.minFov),i.clamp(t,1,179)),moveInertia:(t,{defValue:e})=>!0===t?e:!1===t?0:t,lang:t=>({...Ki.lang,...t}),keyboardActions:(t,{rawConfig:e})=>e.keyboard&&"object"==typeof e.keyboard?e.keyboard:t,fisheye:t=>!0===t?1:!1===t?0:t,requestHeaders:t=>t&&"object"==typeof t?()=>t:"function"==typeof t?t:null,defaultTransition:(t,{defValue:e})=>null===t||0===t.speed?null:{...e,...t},rendererParameters:(t,{defValue:e})=>({...t,...e}),plugins:t=>t.map(((t,e)=>{if(!(t=Array.isArray(t)?[Xi(t[0]),t[1]]:[Xi(t),null])[0])throw new St(`An undefined value was given for plugin ${e}.`);if(!t[0].id)throw new St(`Plugin ${e} has no id.`);return t})),navbar:t=>!1===t?null:!0===t?_t(Ki.navbar):"string"==typeof t?t.split(/[ ,]/):t},Qi=Gt(Ki,Gi),Ji=class extends zi{constructor(t){super(t,{className:"psv-caption",hoverScale:!1,collapsable:!1,tabbable:!0}),this.contentWidth=0,this.state.width=0,this.contentElt=document.createElement("div"),this.contentElt.className="psv-caption-content",this.container.appendChild(this.contentElt),this.setCaption(this.viewer.config.caption)}hide(){this.contentElt.style.display="none",this.state.visible=!1}show(){this.contentElt.style.display="",this.state.visible=!0}onClick(){}setCaption(t){this.show(),this.contentElt.innerHTML=t??"",this.contentElt.innerHTML?this.contentWidth=this.contentElt.offsetWidth:this.contentWidth=0,this.autoSize()}autoSize(){this.toggle(this.container.offsetWidth>=this.contentWidth),this.__refreshButton()}__refreshButton(){this.viewer.navbar.getButton(Oi.id,!1)?.autoSize(!0)}};Ji.id="caption";var ts={},es={};function is(t,e){if(!t.id)throw new St("Button id is required");if(ts[t.id]=t,t.groupId&&(es[t.groupId]=es[t.groupId]||[]).push(t),e){const i=Ki.navbar;switch(e){case"start":i.unshift(t.id);break;case"end":i.push(t.id);break;default:{const[s,o]=e.split(":"),n=i.indexOf(s);if(!s||!o||-1===n)throw new St(`Invalid defaultPosition ${e}`);i.splice(n+("right"===o?1:0),0,t.id)}}}}[Wi,Yi,Fi,Oi,Ji,Ii,Di,ji,Vi,Ui,Ni].forEach((t=>is(t)));var ss=class extends Li{constructor(t){super(t,{className:`psv-navbar ${Y}`}),this.collapsed=[],this.state.visible=!1}show(){this.viewer.container.classList.add("psv--has-navbar"),this.container.classList.add("psv-navbar--open"),this.state.visible=!0}hide(){this.viewer.container.classList.remove("psv--has-navbar"),this.container.classList.remove("psv-navbar--open"),this.state.visible=!1}setButtons(t){this.children.slice().forEach((t=>t.destroy())),this.children.length=0,-1!==t.indexOf(Ji.id)&&-1===t.indexOf(Oi.id)&&t.splice(t.indexOf(Ji.id),0,Oi.id),t.forEach((t=>{"object"==typeof t?new Pi(this,t):ts[t]?new ts[t](this):es[t]?es[t].forEach((t=>{new t(this)})):Dt(`Unknown button ${t}`)})),new Ai(this),this.children.forEach((t=>{t instanceof zi&&t.checkSupported()})),this.autoSize()}setCaption(t){this.children.some((e=>e instanceof Ji&&(e.setCaption(t),!0)))}getButton(t,e=!0){const i=this.children.find((e=>e instanceof zi&&e.id===t));return!i&&e&&Dt(`button "${t}" not found in the navbar`),i}focusButton(t){this.isVisible()&&(this.getButton(t,!1)?.container||this.container.firstElementChild)?.focus()}autoSize(){this.children.forEach((t=>{t instanceof zi&&t.autoSize()}));const t=this.container.offsetWidth;let e=0;const i=[];this.children.forEach((t=>{t.isVisible()&&t instanceof zi&&(e+=t.width,t.collapsable&&i.push(t))})),0!==e&&(t<e&&i.length>0?(i.forEach((t=>t.collapse())),this.collapsed=i,this.getButton(Ai.id).show(!1)):t>=e&&this.collapsed.length>0&&(this.collapsed.forEach((t=>t.uncollapse())),this.collapsed=[],this.getButton(Ai.id).hide(!1)),this.getButton(Ji.id,!1)?.autoSize())}};o.enabled=!1;var os={enabled:!0,maxItems:10,ttl:600,items:{},purgeInterval:null,init(){o.enabled&&(Dt("ThreeJS cache should be disabled"),o.enabled=!1),!this.purgeInterval&&this.enabled&&(this.purgeInterval=setInterval((()=>this.purge()),6e4))},add(t,e,i){this.enabled&&e&&(this.items[e]=this.items[e]??{files:{},lastAccess:null},this.items[e].files[t]=i,this.items[e].lastAccess=Date.now())},get(t,e){if(this.enabled&&e&&this.items[e])return this.items[e].lastAccess=Date.now(),this.items[e].files[t]},remove(t,e){this.enabled&&e&&this.items[e]&&(delete this.items[e].files[t],0===Object.keys(this.items[e].files).length&&delete this.items[e])},purge(){Object.entries(this.items).sort((([,t],[,e])=>e.lastAccess-t.lastAccess)).forEach((([t,{lastAccess:e}],i)=>{i>0&&(Date.now()-e>=1e3*this.ttl||i>=this.maxItems)&&delete this.items[t]}))}},ns=class extends Li{constructor(t){super(t,{className:"psv-loader-container"}),this.loader=document.createElement("div"),this.loader.className="psv-loader",this.container.appendChild(this.loader),this.size=this.loader.offsetWidth,this.canvas=document.createElementNS("http://www.w3.org/2000/svg","svg"),this.canvas.setAttribute("class","psv-loader-canvas"),this.canvas.setAttribute("viewBox",`0 0 ${this.size} ${this.size}`),this.loader.appendChild(this.canvas),this.textColor=vt(this.loader,"color"),this.color=vt(this.canvas,"color"),this.border=parseInt(vt(this.loader,"--psv-loader-border"),10),this.thickness=parseInt(vt(this.loader,"--psv-loader-tickness"),10);const e=this.size/2;this.canvas.innerHTML=`\n            <circle cx="${e}" cy="${e}" r="${e}" fill="${this.color}"/>\n            <path d="" fill="none" stroke="${this.textColor}" stroke-width="${this.thickness}" stroke-linecap="round"/>\n        `,this.viewer.addEventListener(xe.type,this),this.__updateContent(),this.hide()}destroy(){this.viewer.removeEventListener(xe.type,this),super.destroy()}handleEvent(t){t instanceof xe&&t.containsOptions("loadingImg","loadingTxt","lang")&&this.__updateContent()}setProgress(t){this.container.classList.remove("psv-loader--undefined");const e=i.clamp(t,0,99.999)/100*Math.PI*2,s=this.size/2,o=s,n=this.thickness/2+this.border,r=(this.size-this.thickness)/2-this.border,a=Math.sin(e)*r+s,h=-Math.cos(e)*r+s,l=t>50?"1":"0";this.canvas.querySelector("path").setAttributeNS(null,"d",`M ${o} ${n} A ${r} ${r} 0 ${l} 1 ${a} ${h}`)}showUndefined(){this.show(),this.setProgress(25),this.container.classList.add("psv-loader--undefined")}__updateContent(){const t=this.loader.querySelector(".psv-loader-image, .psv-loader-text");let e;if(t&&this.loader.removeChild(t),this.viewer.config.loadingImg?(e=document.createElement("img"),e.className="psv-loader-image",e.src=this.viewer.config.loadingImg):null!==this.viewer.config.loadingTxt&&(e=document.createElement("div"),e.className="psv-loader-text",e.innerHTML=this.viewer.config.loadingTxt||this.viewer.config.lang.loading),e){const t=Math.round(Math.sqrt(2*Math.pow(this.size/2-this.thickness/2-this.border,2)));e.style.maxWidth=t+"px",e.style.maxHeight=t+"px",this.loader.appendChild(e)}}},rs=class extends Li{constructor(t){super(t,{className:"psv-notification"}),this.state={visible:!1,contentId:null,timeout:null},this.content=document.createElement("div"),this.content.className="psv-notification-content",this.container.appendChild(this.content),this.content.addEventListener("click",(()=>this.hide()))}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new St("Notification cannot be toggled")}show(t){this.state.timeout&&(clearTimeout(this.state.timeout),this.state.timeout=null),"string"==typeof t&&(t={content:t}),this.state.contentId=t.id||null,this.content.innerHTML=t.content,this.container.classList.add("psv-notification--visible"),this.state.visible=!0,this.viewer.dispatchEvent(new ei(this.state.contentId)),t.timeout&&(this.state.timeout=setTimeout((()=>this.hide(this.state.contentId)),t.timeout))}hide(t){if(this.isVisible(t)){const t=this.state.contentId;this.container.classList.remove("psv-notification--visible"),this.state.visible=!1,this.state.contentId=null,this.viewer.dispatchEvent(new Te(t))}}},as=class extends Li{constructor(t){super(t,{className:`psv-overlay ${Y}`}),this.state={visible:!1,contentId:null,dismissible:!0},this.image=document.createElement("div"),this.image.className="psv-overlay-image",this.container.appendChild(this.image),this.title=document.createElement("div"),this.title.className="psv-overlay-title",this.container.appendChild(this.title),this.text=document.createElement("div"),this.text.className="psv-overlay-text",this.container.appendChild(this.text),this.container.addEventListener("click",this),this.viewer.addEventListener(Ae.type,this),super.hide()}destroy(){this.viewer.removeEventListener(Ae.type,this),super.destroy()}handleEvent(t){"click"===t.type?this.isVisible()&&this.state.dismissible&&(this.hide(),t.stopPropagation()):t instanceof Ae&&this.isVisible()&&this.state.dismissible&&t.key===X.Escape&&(this.hide(),t.preventDefault())}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new St("Overlay cannot be toggled")}show(t){"string"==typeof t&&(t={title:t}),this.state.contentId=t.id||null,this.state.dismissible=!1!==t.dismissible,this.image.innerHTML=t.image||"",this.title.innerHTML=t.title||"",this.text.innerHTML=t.text||"",super.show(),this.viewer.dispatchEvent(new si(this.state.contentId))}hide(t){if(this.isVisible(t)){const t=this.state.contentId;super.hide(),this.state.contentId=null,this.viewer.dispatchEvent(new Se(t))}}},hs="psv-panel-content--no-interaction",ls=class extends Li{constructor(t){super(t,{className:`psv-panel ${Y}`}),this.state={visible:!1,contentId:null,mouseX:0,mouseY:0,mousedown:!1,clickHandler:null,keyHandler:null,width:{}};const e=document.createElement("div");e.className="psv-panel-resizer",this.container.appendChild(e);const i=document.createElement("div");i.className="psv-panel-close-button",i.innerHTML=K.close,i.title=t.config.lang.close,this.container.appendChild(i),this.content=document.createElement("div"),this.content.className="psv-panel-content",this.container.appendChild(this.content),i.addEventListener("click",(()=>this.hide())),e.addEventListener("mousedown",this),e.addEventListener("touchstart",this),this.viewer.container.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchend",this),this.viewer.container.addEventListener("mousemove",this),this.viewer.container.addEventListener("touchmove",this),this.viewer.addEventListener(Ae.type,this)}destroy(){this.viewer.removeEventListener(Ae.type,this),this.viewer.container.removeEventListener("mousemove",this),this.viewer.container.removeEventListener("touchmove",this),this.viewer.container.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"mousemove":this.__onMouseMove(t);break;case"touchmove":this.__onTouchMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchend":this.__onTouchEnd(t);break;case Ae.type:this.__onKeyPress(t)}}isVisible(t){return this.state.visible&&(!t||!this.state.contentId||this.state.contentId===t)}toggle(){throw new St("Panel cannot be toggled")}show(t){"string"==typeof t&&(t={content:t});const e=this.isVisible(t.id);this.state.contentId=t.id||null,this.state.visible=!0,this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),t.id&&this.state.width[t.id]?this.container.style.width=this.state.width[t.id]:t.width?this.container.style.width=t.width:this.container.style.width=null,this.content.innerHTML=t.content,this.content.scrollTop=0,this.container.classList.add("psv-panel--open"),rt(this.content,"psv-panel-content--no-margin",!0===t.noMargin),t.clickHandler&&(this.state.clickHandler=e=>{t.clickHandler(dt(e))},this.state.keyHandler=e=>{e.key===X.Enter&&t.clickHandler(dt(e))},this.content.addEventListener("click",this.state.clickHandler),this.content.addEventListener("keydown",this.state.keyHandler),e||setTimeout((()=>{this.content.querySelector("a,button,[tabindex]")?.focus()}),300)),this.viewer.dispatchEvent(new ni(this.state.contentId))}hide(t){if(this.isVisible(t)){const t=this.state.contentId;this.state.visible=!1,this.state.contentId=null,this.content.innerHTML=null,this.container.classList.remove("psv-panel--open"),this.state.clickHandler&&(this.content.removeEventListener("click",this.state.clickHandler),this.content.removeEventListener("keydown",this.state.keyHandler),this.state.clickHandler=null,this.state.keyHandler=null),this.viewer.dispatchEvent(new Pe(t))}}__onMouseDown(t){t.stopPropagation(),this.__startResize(t.clientX,t.clientY)}__onTouchStart(t){if(t.stopPropagation(),1===t.touches.length){const e=t.touches[0];this.__startResize(e.clientX,e.clientY)}}__onMouseUp(t){this.state.mousedown&&(t.stopPropagation(),this.state.mousedown=!1,this.content.classList.remove(hs))}__onTouchEnd(t){this.state.mousedown&&(t.stopPropagation(),0===t.touches.length&&(this.state.mousedown=!1,this.content.classList.remove(hs)))}__onMouseMove(t){this.state.mousedown&&(t.stopPropagation(),this.__resize(t.clientX,t.clientY))}__onTouchMove(t){if(this.state.mousedown){const e=t.touches[0];this.__resize(e.clientX,e.clientY)}}__onKeyPress(t){this.isVisible()&&t.key===X.Escape&&(this.hide(),t.preventDefault())}__startResize(t,e){this.state.mouseX=t,this.state.mouseY=e,this.state.mousedown=!0,this.content.classList.add(hs)}__resize(t,e){const i=t,s=e,o=Math.max(200,this.container.offsetWidth-(i-this.state.mouseX))+"px";this.state.contentId&&(this.state.width[this.state.contentId]=o),this.container.style.width=o,this.state.mouseX=i,this.state.mouseY=s}},cs=class extends Li{constructor(t,e){super(t,{className:"psv-tooltip"}),this.state={visible:!0,arrow:0,border:0,state:0,width:0,height:0,pos:"",config:null,data:null,hideTimeout:null},this.content=document.createElement("div"),this.content.className="psv-tooltip-content",this.container.appendChild(this.content),this.arrow=document.createElement("div"),this.arrow.className="psv-tooltip-arrow",this.container.appendChild(this.arrow),this.container.addEventListener("transitionend",this),this.container.addEventListener("touchdown",(t=>t.stopPropagation())),this.container.addEventListener("mousedown",(t=>t.stopPropagation())),this.container.style.top="-1000px",this.container.style.left="-1000px",this.show(e)}handleEvent(t){"transitionend"===t.type&&this.__onTransitionEnd(t)}destroy(){clearTimeout(this.state.hideTimeout),delete this.state.data,super.destroy()}toggle(){throw new St("Tooltip cannot be toggled")}show(t){if(0!==this.state.state)throw new St("Initialized tooltip cannot be re-initialized");t.className&&at(this.container,t.className),t.style&&Object.assign(this.container.style,t.style),this.state.state=3,this.update(t.content,t),this.state.data=t.data,this.state.state=1,this.viewer.dispatchEvent(new ai(this,this.state.data)),this.__waitImages()}update(t,e){this.content.innerHTML=t;const i=this.container.getBoundingClientRect();this.state.width=i.right-i.left,this.state.height=i.bottom-i.top,this.state.arrow=parseInt(vt(this.arrow,"border-top-width"),10),this.state.border=parseInt(vt(this.container,"border-top-left-radius"),10),this.move(e??this.state.config),this.__waitImages()}move(t){if(1!==this.state.state&&3!==this.state.state)throw new St("Uninitialized tooltip cannot be moved");t.box=t.box??this.state.config?.box??{width:0,height:0},this.state.config=t;const e=this.container,i=this.arrow,s={posClass:Ft(t.position,{allowCenter:!1,cssOrder:!1})||["top","center"],width:this.state.width,height:this.state.height,top:0,left:0,arrowTop:0,arrowLeft:0};this.__computeTooltipPosition(s,t);let o=null,n=null;if(s.top<0?o="bottom":s.top+s.height>this.viewer.state.size.height&&(o="top"),s.left<0?n="right":s.left+s.width>this.viewer.state.size.width&&(n="left"),n||o){const e=Wt(s.posClass);o&&(s.posClass[e?0:1]=o),n&&(s.posClass[e?1:0]=n),this.__computeTooltipPosition(s,t)}e.style.top=s.top+"px",e.style.left=s.left+"px",i.style.top=s.arrowTop+"px",i.style.left=s.arrowLeft+"px";const r=s.posClass.join("-");r!==this.state.pos&&(e.classList.remove(`psv-tooltip--${this.state.pos}`),this.state.pos=r,e.classList.add(`psv-tooltip--${this.state.pos}`))}hide(){this.container.classList.remove("psv-tooltip--visible"),this.state.state=2,this.viewer.dispatchEvent(new Ie(this.state.data));const t=parseFloat(vt(this.container,"transition-duration"));this.state.hideTimeout=setTimeout((()=>{this.destroy()}),2*t)}__onTransitionEnd(t){if("transform"===t.propertyName)switch(this.state.state){case 1:this.container.classList.add("psv-tooltip--visible"),this.state.state=3;break;case 2:this.state.state=0,this.destroy()}}__computeTooltipPosition(t,e){const i=this.state.arrow,s=e.top,o=t.height,n=e.left,r=t.width,a=i+this.state.border,h=e.box.width/2+2*i,l=e.box.height/2+2*i;switch(t.posClass.join("-")){case"top-left":t.top=s-l-o,t.left=n+a-r,t.arrowTop=o,t.arrowLeft=r-a-i;break;case"top-center":t.top=s-l-o,t.left=n-r/2,t.arrowTop=o,t.arrowLeft=r/2-i;break;case"top-right":t.top=s-l-o,t.left=n-a,t.arrowTop=o,t.arrowLeft=i;break;case"bottom-left":t.top=s+l,t.left=n+a-r,t.arrowTop=2*-i,t.arrowLeft=r-a-i;break;case"bottom-center":t.top=s+l,t.left=n-r/2,t.arrowTop=2*-i,t.arrowLeft=r/2-i;break;case"bottom-right":t.top=s+l,t.left=n-a,t.arrowTop=2*-i,t.arrowLeft=i;break;case"left-top":t.top=s+a-o,t.left=n-h-r,t.arrowTop=o-a-i,t.arrowLeft=r;break;case"center-left":t.top=s-o/2,t.left=n-h-r,t.arrowTop=o/2-i,t.arrowLeft=r;break;case"left-bottom":t.top=s-a,t.left=n-h-r,t.arrowTop=i,t.arrowLeft=r;break;case"right-top":t.top=s+a-o,t.left=n+h,t.arrowTop=o-a-i,t.arrowLeft=2*-i;break;case"center-right":t.top=s-o/2,t.left=n+h,t.arrowTop=o/2-i,t.arrowLeft=2*-i;break;case"right-bottom":t.top=s-a,t.left=n+h,t.arrowTop=i,t.arrowLeft=2*-i}}__waitImages(){const t=this.content.querySelectorAll("img");if(t.length>0){const e=[];t.forEach((t=>{t.complete||e.push(new Promise((e=>{t.onload=e,t.onerror=e})))})),e.length&&Promise.all(e).then((()=>{if(1===this.state.state||3===this.state.state){const t=this.container.getBoundingClientRect();this.state.width=t.right-t.left,this.state.height=t.bottom-t.top,this.move(this.state.config)}}))}}},ds=class{constructor(t){this.viewer=t,this.config=t.config,this.state=t.state}destroy(){}},ps=new s,us=new b(0,0,0,"ZXY"),vs=class extends ds{constructor(t){super(t)}fovToZoomLevel(t){const e=Math.round((t-this.config.minFov)/(this.config.maxFov-this.config.minFov)*100);return i.clamp(e-2*(e-50),0,100)}zoomLevelToFov(t){return this.config.maxFov+t/100*(this.config.minFov-this.config.maxFov)}vFovToHFov(t){return i.radToDeg(2*Math.atan(Math.tan(i.degToRad(t)/2)*this.state.aspect))}hFovToVFov(t){return i.radToDeg(2*Math.atan(Math.tan(i.degToRad(t)/2)/this.state.aspect))}getAnimationProperties(t,e,i){const s=!Mt(e),o=!Mt(i),n={};let r=null;if(s){const i=this.viewer.getPosition(),s=it(i.yaw,e.yaw);n.yaw={start:i.yaw,end:i.yaw+s},n.pitch={start:i.pitch,end:e.pitch},r=Zt(t,st(i,e))}if(o){const e=this.viewer.getZoomLevel(),s=Math.abs(i-e);n.zoom={start:e,end:i},null===r&&(r=Zt(t,Math.PI/4*s/100))}return r=null===r?"number"==typeof t?t:R:Math.max(R,r),{duration:r,properties:n}}getTransitionOptions(t){let e;const i=this.config.defaultTransition??Ki.defaultTransition;return e=!1===t.transition||null===t.transition?null:!0===t.transition?{...i}:"object"==typeof t.transition?{...i,...t.transition}:this.config.defaultTransition,e}textureCoordsToSphericalCoords(t){if(!this.state.textureData?.panoData)throw new St("Current adapter does not support texture coordinates or no texture has been loaded");const e=this.viewer.adapter.textureCoordsToSphericalCoords(t,this.state.textureData.panoData);return us.equals(this.viewer.renderer.panoramaPose)&&us.equals(this.viewer.renderer.sphereCorrection)?e:(this.sphericalCoordsToVector3(e,ps),ps.applyEuler(this.viewer.renderer.panoramaPose),ps.applyEuler(this.viewer.renderer.sphereCorrection),this.vector3ToSphericalCoords(ps))}sphericalCoordsToTextureCoords(t){if(!this.state.textureData?.panoData)throw new St("Current adapter does not support texture coordinates or no texture has been loaded");return us.equals(this.viewer.renderer.panoramaPose)&&us.equals(this.viewer.renderer.sphereCorrection)||(this.sphericalCoordsToVector3(t,ps),qt(ps,this.viewer.renderer.sphereCorrection),qt(ps,this.viewer.renderer.panoramaPose),t=this.vector3ToSphericalCoords(ps)),this.viewer.adapter.sphericalCoordsToTextureCoords(t,this.state.textureData.panoData)}sphericalCoordsToVector3(t,e,i=F){return e||(e=new s),e.x=i*-Math.cos(t.pitch)*Math.sin(t.yaw),e.y=i*Math.sin(t.pitch),e.z=i*Math.cos(t.pitch)*Math.cos(t.yaw),e}vector3ToSphericalCoords(t){const e=Math.acos(t.y/Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z)),i=Math.atan2(t.x,t.z);return{yaw:i<0?-i:2*Math.PI-i,pitch:Math.PI/2-e}}viewerCoordsToVector3(t){const e=this.viewer.renderer.getIntersections(t).filter((t=>t.object.userData[W]));return e.length?e[0].point:null}viewerCoordsToSphericalCoords(t){const e=this.viewerCoordsToVector3(t);return e?this.vector3ToSphericalCoords(e):null}vector3ToViewerCoords(t){const e=t.clone();return e.project(this.viewer.renderer.camera),{x:Math.round((e.x+1)/2*this.state.size.width),y:Math.round((1-e.y)/2*this.state.size.height)}}sphericalCoordsToViewerCoords(t){return this.sphericalCoordsToVector3(t,ps),this.vector3ToViewerCoords(ps)}isPointVisible(t){let e,i;if(t instanceof s)e=t,i=this.vector3ToViewerCoords(t);else{if(!At(t))return!1;e=this.sphericalCoordsToVector3(t,ps),i=this.vector3ToViewerCoords(e)}return e.dot(this.viewer.state.direction)>0&&i.x>=0&&i.x<=this.viewer.state.size.width&&i.y>=0&&i.y<=this.viewer.state.size.height}cleanPosition(t){if("yaw"in t||"pitch"in t){if(!("yaw"in t)||!("pitch"in t))throw new St("Position is missing 'yaw' or 'pitch'");return{yaw:Bt(t.yaw),pitch:Bt(t.pitch,!0)}}return this.textureCoordsToSphericalCoords(t)}cleanSphereCorrection(t){return{pan:Bt(t?.pan||0),tilt:Bt(t?.tilt||0,!0),roll:Bt(t?.roll||0,!0,!1)}}cleanPanoramaPose(t){return{pan:i.degToRad(t?.poseHeading||0),tilt:i.degToRad(t?.posePitch||0),roll:i.degToRad(t?.poseRoll||0)}}cleanPanoramaOptions(t,e){return e?.isEquirectangular?(Mt(t.zoom)&&!Mt(e.initialFov)&&(t={...t,zoom:this.fovToZoomLevel(this.hFovToVFov(e.initialFov))}),!Mt(t.position)||Mt(e.initialHeading)||Mt(e.initialPitch)||(t={...t,position:{yaw:Bt(e.initialHeading),pitch:Bt(e.initialPitch,!0)}}),t):t}},ms=class t{constructor(){this.$=t.IDLE}is(...t){return t.some((t=>this.$&t))}set(t){this.$=t}add(t){this.$|=t}remove(t){this.$&=~t}};ms.IDLE=0,ms.CLICK=1,ms.MOVING=2;var gs=ms,fs=class extends ds{constructor(t){super(t),this.data={startMouseX:0,startMouseY:0,mouseX:0,mouseY:0,pinchDist:0,moveDelta:{yaw:0,pitch:0,zoom:0},accumulatorFactor:0,ctrlKeyDown:!1,dblclickData:null,dblclickTimeout:null,longtouchTimeout:null,twofingersTimeout:null,ctrlZoomTimeout:null},this.step=new gs,this.keyHandler=new ne,this.resizeObserver=new ResizeObserver(bt((()=>this.viewer.autoSize()),50)),this.moveThreshold=N*ki.pixelRatio}init(){window.addEventListener("keydown",this,{passive:!1}),window.addEventListener("keyup",this),this.viewer.container.addEventListener("mousedown",this),window.addEventListener("mousemove",this,{passive:!1}),window.addEventListener("mouseup",this),this.viewer.container.addEventListener("touchstart",this,{passive:!1}),window.addEventListener("touchmove",this,{passive:!1}),window.addEventListener("touchend",this,{passive:!1}),this.viewer.container.addEventListener("wheel",this,{passive:!1}),document.addEventListener("fullscreenchange",this),this.resizeObserver.observe(this.viewer.container),this.viewer.addEventListener(me.type,this),this.viewer.addEventListener(di.type,this)}destroy(){window.removeEventListener("keydown",this),window.removeEventListener("keyup",this),this.viewer.container.removeEventListener("mousedown",this),window.removeEventListener("mousemove",this),window.removeEventListener("mouseup",this),this.viewer.container.removeEventListener("touchstart",this),window.removeEventListener("touchmove",this),window.removeEventListener("touchend",this),this.viewer.container.removeEventListener("wheel",this),document.removeEventListener("fullscreenchange",this),this.resizeObserver.disconnect(),this.viewer.removeEventListener(me.type,this),this.viewer.removeEventListener(di.type,this),clearTimeout(this.data.dblclickTimeout),clearTimeout(this.data.longtouchTimeout),clearTimeout(this.data.twofingersTimeout),clearTimeout(this.data.ctrlZoomTimeout),super.destroy()}handleEvent(t){switch(t.type){case"keydown":this.__onKeyDown(t);break;case"keyup":this.__onKeyUp();break;case"mousemove":this.__onMouseMove(t);break;case"mouseup":this.__onMouseUp(t);break;case"touchmove":this.__onTouchMove(t);break;case"touchend":this.__onTouchEnd(t);break;case"fullscreenchange":this.__onFullscreenChange();break;case me.type:this.__applyMoveDelta();break;case di.type:this.__clearMoveDelta()}if(!pt(t,"."+Y))switch(t.type){case"mousedown":this.__onMouseDown(t);break;case"touchstart":this.__onTouchStart(t);break;case"wheel":this.__onMouseWheel(t)}}__onKeyDown(t){if(this.config.mousewheelCtrlKey&&(this.data.ctrlKeyDown=t.key===X.Control,this.data.ctrlKeyDown&&(clearTimeout(this.data.ctrlZoomTimeout),this.viewer.overlay.hide(B.CTRL_ZOOM))),!this.viewer.dispatchEvent(new Ae(t.key,t)))return;if(!this.state.keyboardEnabled)return;const e=this.config.keyboardActions?.[t.key];if("function"==typeof e)return e(this.viewer,t),void t.preventDefault();if(!(t.ctrlKey||t.altKey||t.shiftKey||t.metaKey)&&e&&!this.keyHandler.pending){switch("ZOOM_IN"!==e&&"ZOOM_OUT"!==e&&this.viewer.stopAll(),e){case"ROTATE_UP":this.viewer.dynamics.position.roll({pitch:!1});break;case"ROTATE_DOWN":this.viewer.dynamics.position.roll({pitch:!0});break;case"ROTATE_RIGHT":this.viewer.dynamics.position.roll({yaw:!1});break;case"ROTATE_LEFT":this.viewer.dynamics.position.roll({yaw:!0});break;case"ZOOM_IN":this.viewer.dynamics.zoom.roll(!1);break;case"ZOOM_OUT":this.viewer.dynamics.zoom.roll(!0)}this.keyHandler.down(e),t.preventDefault()}}__onKeyUp(){this.data.ctrlKeyDown=!1,this.state.keyboardEnabled&&this.keyHandler.up((t=>{"ZOOM_IN"===t||"ZOOM_OUT"===t?this.viewer.dynamics.zoom.stop():(this.viewer.dynamics.position.stop(),this.viewer.resetIdleTimer())}))}__onMouseDown(t){this.step.add(gs.CLICK),this.data.startMouseX=t.clientX,this.data.startMouseY=t.clientY}__onMouseUp(t){this.step.is(gs.CLICK,gs.MOVING)&&this.__stopMove(t.clientX,t.clientY,t,2===t.button)}__onMouseMove(t){this.config.mousemove&&this.step.is(gs.CLICK,gs.MOVING)&&(t.preventDefault(),this.__doMove(t.clientX,t.clientY)),this.__handleObjectsEvents(t)}__onTouchStart(t){1===t.touches.length?(this.step.add(gs.CLICK),this.data.startMouseX=t.touches[0].clientX,this.data.startMouseY=t.touches[0].clientY,this.data.longtouchTimeout||(this.data.longtouchTimeout=setTimeout((()=>{const e=t.touches[0];this.__stopMove(e.clientX,e.clientY,t,!0),this.data.longtouchTimeout=null}),V))):2===t.touches.length&&(this.step.set(gs.IDLE),this.__cancelLongTouch(),this.config.mousemove&&(this.__cancelTwoFingersOverlay(),this.__startMoveZoom(t),t.preventDefault()))}__onTouchEnd(t){if(this.__cancelLongTouch(),this.step.is(gs.CLICK,gs.MOVING))if(t.preventDefault(),this.__cancelTwoFingersOverlay(),1===t.touches.length)this.__stopMove(this.data.mouseX,this.data.mouseY);else if(0===t.touches.length){const e=t.changedTouches[0];this.__stopMove(e.clientX,e.clientY,t)}}__onTouchMove(t){if(this.__cancelLongTouch(),this.config.mousemove)if(1===t.touches.length){if(this.config.touchmoveTwoFingers)this.step.is(gs.CLICK)&&!this.data.twofingersTimeout&&(this.data.twofingersTimeout=setTimeout((()=>{this.viewer.overlay.show({id:B.TWO_FINGERS,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><path fill="currentColor" d="M33.38 33.2a1.96 1.96 0 0 0 1.5-3.23 10.61 10.61 0 0 1 7.18-17.51c.7-.06 1.31-.49 1.61-1.12a13.02 13.02 0 0 1 11.74-7.43c7.14 0 12.96 5.8 12.96 12.9 0 3.07-1.1 6.05-3.1 8.38-.7.82-.61 2.05.21 2.76.83.7 2.07.6 2.78-.22a16.77 16.77 0 0 0 4.04-10.91C72.3 7.54 64.72 0 55.4 0a16.98 16.98 0 0 0-14.79 8.7 14.6 14.6 0 0 0-12.23 14.36c0 3.46 1.25 6.82 3.5 9.45.4.45.94.69 1.5.69m45.74 43.55a22.13 22.13 0 0 1-5.23 12.4c-4 4.55-9.53 6.86-16.42 6.86-12.6 0-20.1-10.8-20.17-10.91a1.82 1.82 0 0 0-.08-.1c-5.3-6.83-14.55-23.82-17.27-28.87-.05-.1 0-.21.02-.23a6.3 6.3 0 0 1 8.24 1.85l9.38 12.59a1.97 1.97 0 0 0 3.54-1.17V25.34a4 4 0 0 1 1.19-2.87 3.32 3.32 0 0 1 2.4-.95c1.88.05 3.4 1.82 3.4 3.94v24.32a1.96 1.96 0 0 0 3.93 0v-33.1a3.5 3.5 0 0 1 7 0v35.39a1.96 1.96 0 0 0 3.93 0v-.44c.05-2.05 1.6-3.7 3.49-3.7 1.93 0 3.5 1.7 3.5 3.82v5.63c0 .24.04.48.13.71l.1.26a1.97 1.97 0 0 0 3.76-.37c.33-1.78 1.77-3.07 3.43-3.07 1.9 0 3.45 1.67 3.5 3.74l-1.77 18.1zM77.39 51c-1.25 0-2.45.32-3.5.9v-.15c0-4.27-3.33-7.74-7.42-7.74-1.26 0-2.45.33-3.5.9V16.69a7.42 7.42 0 0 0-14.85 0v1.86a7 7 0 0 0-3.28-.94 7.21 7.21 0 0 0-5.26 2.07 7.92 7.92 0 0 0-2.38 5.67v37.9l-5.83-7.82a10.2 10.2 0 0 0-13.35-2.92 4.1 4.1 0 0 0-1.53 5.48C20 64.52 28.74 80.45 34.07 87.34c.72 1.04 9.02 12.59 23.4 12.59 7.96 0 14.66-2.84 19.38-8.2a26.06 26.06 0 0 0 6.18-14.6l1.78-18.2v-.2c0-4.26-3.32-7.73-7.42-7.73z"/>\x3c!--Created by AomAm from the Noun Project--\x3e</svg>\n',title:this.config.lang.twoFingers})}),U));else if(this.step.is(gs.CLICK,gs.MOVING)){t.preventDefault();const e=t.touches[0];this.__doMove(e.clientX,e.clientY)}}else this.__doMoveZoom(t),this.__cancelTwoFingersOverlay()}__cancelLongTouch(){this.data.longtouchTimeout&&(clearTimeout(this.data.longtouchTimeout),this.data.longtouchTimeout=null)}__cancelTwoFingersOverlay(){this.config.touchmoveTwoFingers&&(this.data.twofingersTimeout&&(clearTimeout(this.data.twofingersTimeout),this.data.twofingersTimeout=null),this.viewer.overlay.hide(B.TWO_FINGERS))}__onMouseWheel(t){if(!this.config.mousewheel||!t.deltaY)return;if(this.config.mousewheelCtrlKey&&!this.data.ctrlKeyDown)return this.viewer.overlay.show({id:B.CTRL_ZOOM,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 17 79 79"><path fill="currentColor" d="M38.1 29.27c-.24 0-.44.2-.44.45v10.7a.45.45 0 00.9 0v-10.7c0-.25-.2-.45-.45-.45zm10.2 26.66a11.54 11.54 0 01-8.48-6.14.45.45 0 10-.8.41 12.45 12.45 0 009.22 6.62.45.45 0 00.07-.9zm24.55-13.08a23.04 23.04 0 00-22.56-23v7.07l-.01.05a2.83 2.83 0 012.39 2.78v14.03l.09-.02h8.84v-9.22a.45.45 0 11.9 0v9.22h10.35v-.9zm0 27.33V44.66H62.5c-.02 2.01-.52 4-1.47 5.76a.45.45 0 01-.61.18.45.45 0 01-.19-.61 11.54 11.54 0 001.36-5.33h-8.83l-.1-.01a2.83 2.83 0 01-2.83 2.84h-.04-.04a2.83 2.83 0 01-2.83-2.83v-14.9a2.82 2.82 0 012.47-2.8v-7.11a23.04 23.04 0 00-22.57 23v.91h14.72V29.88a8.2 8.2 0 015.02-7.57c.22-.1.5.01.59.24.1.23-.01.5-.24.6a7.3 7.3 0 00-4.47 6.73v13.88h3.9a.45.45 0 110 .9h-3.9v.15a7.32 7.32 0 0011.23 6.17.45.45 0 01.49.76 8.22 8.22 0 01-12.62-6.93v-.15H26.82v25.52a23.04 23.04 0 0023.01 23.01 23.04 23.04 0 0023.02-23.01zm1.8-27.33v27.33A24.85 24.85 0 0149.84 95a24.85 24.85 0 01-24.82-24.82V42.85a24.85 24.85 0 0124.82-24.82 24.85 24.85 0 0124.83 24.82zM57.98 29.88v9.36a.45.45 0 11-.9 0v-9.36a7.28 7.28 0 00-3.4-6.17.45.45 0 01.49-.76 8.18 8.18 0 013.8 6.93z"/>\x3c!-- Created by Icon Island from the Noun Project --\x3e</svg>\n',title:this.config.lang.ctrlZoom}),clearTimeout(this.data.ctrlZoomTimeout),void(this.data.ctrlZoomTimeout=setTimeout((()=>this.viewer.overlay.hide(B.CTRL_ZOOM)),$));t.preventDefault(),t.stopPropagation();const e=t.deltaY/Math.abs(t.deltaY)*5*this.config.zoomSpeed;0!==e&&this.viewer.dynamics.zoom.step(-e,5)}__onFullscreenChange(){const t=this.viewer.isFullscreenEnabled();"fullscreen"===this.config.keyboard&&(t?this.viewer.startKeyboardControl():this.viewer.stopKeyboardControl()),this.viewer.dispatchEvent(new Me(t))}__resetMove(){this.step.set(gs.IDLE),this.data.mouseX=0,this.data.mouseY=0,this.data.startMouseX=0,this.data.startMouseY=0}__startMoveZoom(t){this.viewer.stopAll(),this.__resetMove();const e=mt(t);this.step.set(gs.MOVING),this.data.accumulatorFactor=this.config.moveInertia,({distance:this.data.pinchDist,center:{x:this.data.mouseX,y:this.data.mouseY}}=e)}__stopMove(t,e,i,s=!1){this.step.is(gs.CLICK)&&!this.__moveThresholdReached(t,e)&&this.__doClick(t,e,i,s),this.config.moveInertia&&(this.data.accumulatorFactor=Math.pow(this.config.moveInertia,.5)),this.__resetMove(),this.viewer.resetIdleTimer()}__doClick(t,e,i,s=!1){const o=this.viewer.container.getBoundingClientRect(),n=t-o.left,r=e-o.top,a=this.viewer.renderer.getIntersections({x:n,y:r}),h=a.find((t=>t.object.userData[W]));if(h){const o=this.viewer.dataHelper.vector3ToSphericalCoords(h.point),l={rightclick:s,originalEvent:i,target:dt(i),clientX:t,clientY:e,viewerX:n,viewerY:r,yaw:o.yaw,pitch:o.pitch,objects:a.map((t=>t.object)).filter((t=>!t.userData[W]))};try{const t=this.viewer.dataHelper.sphericalCoordsToTextureCoords(l);Object.assign(l,t)}catch{}this.data.dblclickTimeout?(Math.abs(this.data.dblclickData.clientX-l.clientX)<this.moveThreshold&&Math.abs(this.data.dblclickData.clientY-l.clientY)<this.moveThreshold&&this.viewer.dispatchEvent(new _e(this.data.dblclickData)),clearTimeout(this.data.dblclickTimeout),this.data.dblclickTimeout=null,this.data.dblclickData=null):(this.viewer.dispatchEvent(new ye(l)),this.data.dblclickData=_t(l),this.data.dblclickTimeout=setTimeout((()=>{this.data.dblclickTimeout=null,this.data.dblclickData=null}),j))}}__handleObjectsEvents(t){if(!kt(this.state.objectsObservers)&&t.composedPath().includes(this.viewer.container)){const e=ut(this.viewer.container),i={x:t.clientX-e.x,y:t.clientY-e.y},s=this.viewer.renderer.getIntersections(i),o=(e,s,o)=>{this.viewer.dispatchEvent(new o(t,e,i,s))};for(const[t,n]of Object.entries(this.state.objectsObservers)){const e=s.find((e=>e.object.userData[t]));e?(n&&e.object!==n&&(o(n,t,wi),this.state.objectsObservers[t]=null),n?o(e.object,t,bi):(this.state.objectsObservers[t]=e.object,o(e.object,t,gi))):n&&(o(n,t,wi),this.state.objectsObservers[t]=null)}}}__doMove(t,e){if(this.step.is(gs.CLICK)&&this.__moveThresholdReached(t,e))this.viewer.stopAll(),this.__resetMove(),this.step.set(gs.MOVING),this.data.mouseX=t,this.data.mouseY=e,this.data.accumulatorFactor=this.config.moveInertia;else if(this.step.is(gs.MOVING)){const s=(t-this.data.mouseX)*Math.cos(this.state.roll)-(e-this.data.mouseY)*Math.sin(this.state.roll),o=(e-this.data.mouseY)*Math.cos(this.state.roll)+(t-this.data.mouseX)*Math.sin(this.state.roll),n={yaw:this.config.moveSpeed*(s/this.state.size.width)*i.degToRad(this.state.hFov),pitch:this.config.moveSpeed*(o/this.state.size.height)*i.degToRad(this.state.vFov)};this.data.moveDelta.yaw+=n.yaw,this.data.moveDelta.pitch+=n.pitch,this.data.mouseX=t,this.data.mouseY=e}}__moveThresholdReached(t,e){return Math.abs(t-this.data.startMouseX)>=this.moveThreshold||Math.abs(e-this.data.startMouseY)>=this.moveThreshold}__doMoveZoom(t){if(this.step.is(gs.MOVING)){t.preventDefault();const e=mt(t);this.__doMove(e.center.x,e.center.y),this.data.moveDelta.zoom+=this.config.zoomSpeed*((e.distance-this.data.pinchDist)/ki.pixelRatio),this.data.pinchDist=e.distance}}__applyMoveDelta(){const t=.001;if(Math.abs(this.data.moveDelta.yaw)>0||Math.abs(this.data.moveDelta.pitch)>0){const e=this.viewer.getPosition();this.viewer.rotate({yaw:e.yaw-this.data.moveDelta.yaw*(1-this.config.moveInertia),pitch:e.pitch+this.data.moveDelta.pitch*(1-this.config.moveInertia)}),this.data.moveDelta.yaw*=this.data.accumulatorFactor,this.data.moveDelta.pitch*=this.data.accumulatorFactor,Math.abs(this.data.moveDelta.yaw)<=t&&(this.data.moveDelta.yaw=0),Math.abs(this.data.moveDelta.pitch)<=t&&(this.data.moveDelta.pitch=0)}if(Math.abs(this.data.moveDelta.zoom)>0){const e=this.viewer.getZoomLevel();this.viewer.zoom(e+this.data.moveDelta.zoom*(1-this.config.moveInertia)),this.data.moveDelta.zoom*=this.config.moveInertia,Math.abs(this.data.moveDelta.zoom)<=t&&(this.data.moveDelta.zoom=0)}}__clearMoveDelta(){this.data.moveDelta.yaw=0,this.data.moveDelta.pitch=0,this.data.moveDelta.zoom=0}};C.enabled=!1;var ws=new f,ys=new w,bs=new y,xs=class extends ds{constructor(t){super(t),this.frustumNeedsUpdate=!0,this.renderer=new n(this.config.rendererParameters),this.renderer.setPixelRatio(ki.pixelRatio),this.renderer.outputColorSpace=r,this.renderer.toneMapping=a,this.renderer.domElement.className="psv-canvas",this.renderer.domElement.style.background=this.config.canvasBackground,this.scene=new h,this.camera=new l(50,16/9,.1,2*F),this.camera.matrixAutoUpdate=!1;const e=new c(new d(F).scale(-1,1,1),new p({opacity:0,transparent:!0,depthTest:!1,depthWrite:!1}));e.userData={[W]:!0},this.scene.add(e),this.raycaster=new u,this.frustum=new v,this.container=document.createElement("div"),this.container.className="psv-canvas-container",this.container.appendChild(this.renderer.domElement),this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",(t=>t.preventDefault())),this.viewer.addEventListener(li.type,this),this.viewer.addEventListener(ui.type,this),this.viewer.addEventListener(Be.type,this),this.viewer.addEventListener(Ke.type,this),this.viewer.addEventListener(xe.type,this),this.hide()}get panoramaPose(){return this.mesh.rotation}get sphereCorrection(){return this.meshContainer.rotation}init(){this.show(),this.renderer.setAnimationLoop((t=>this.__renderLoop(t)))}destroy(){this.renderer.setAnimationLoop(null),this.cleanScene(this.scene),this.renderer.dispose(),this.viewer.container.removeChild(this.container),this.viewer.removeEventListener(li.type,this),this.viewer.removeEventListener(ui.type,this),this.viewer.removeEventListener(Be.type,this),this.viewer.removeEventListener(Ke.type,this),this.viewer.removeEventListener(xe.type,this),super.destroy()}handleEvent(t){switch(t.type){case li.type:this.__onSizeUpdated();break;case ui.type:this.__onZoomUpdated();break;case Be.type:case Ke.type:this.__onPositionUpdated();break;case xe.type:t.containsOptions("fisheye")&&this.__onPositionUpdated(),t.containsOptions("canvasBackground")&&(this.renderer.domElement.style.background=this.config.canvasBackground)}}hide(){this.container.style.opacity="0"}show(){this.container.style.opacity="1"}setCustomRenderer(t){this.customRenderer=t?t(this.renderer):null,this.viewer.needsUpdate()}__onSizeUpdated(){this.renderer.setSize(this.state.size.width,this.state.size.height),this.camera.aspect=this.state.aspect,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onZoomUpdated(){this.camera.fov=this.state.vFov,this.camera.updateProjectionMatrix(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__onPositionUpdated(){this.camera.position.set(0,0,0),this.camera.lookAt(this.state.direction),this.config.fisheye&&this.camera.position.copy(this.state.direction).multiplyScalar(this.config.fisheye/2).negate(),this.camera.rotateZ(-this.state.roll),this.camera.updateMatrix(),this.camera.updateMatrixWorld(),this.viewer.needsUpdate(),this.frustumNeedsUpdate=!0}__renderLoop(t){const e=this.timestamp?t-this.timestamp:0;this.timestamp=t,this.viewer.dispatchEvent(new me(t,e)),this.viewer.dynamics.update(e),(this.state.needsUpdate||this.state.continuousUpdateCount>0)&&(this.state.needsUpdate=!1,(this.customRenderer||this.renderer).render(this.scene,this.camera),this.viewer.dispatchEvent(new Je))}setTexture(t){this.meshContainer||(this.meshContainer=new m,this.scene.add(this.meshContainer)),this.state.textureData&&this.viewer.adapter.disposeTexture(this.state.textureData),this.mesh&&(this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh)),this.mesh=this.viewer.adapter.createMesh(t.panoData),this.viewer.adapter.setTexture(this.mesh,t,!1),this.meshContainer.add(this.mesh),this.state.textureData=t,this.viewer.needsUpdate()}setPanoramaPose(t,e=this.mesh){const i=this.viewer.dataHelper.cleanPanoramaPose(t);e.rotation.set(i.tilt,i.pan,i.roll,"YXZ")}setSphereCorrection(t,e=this.meshContainer){const i=this.viewer.dataHelper.cleanSphereCorrection(t);e.rotation.set(i.tilt,i.pan,i.roll,"YXZ")}transition(t,e,o){const n="fade"===o.effect||o.rotation,r=!Mt(e.position),a=!Mt(e.zoom),h=new ue(r?this.viewer.dataHelper.cleanPosition(e.position):void 0,e.zoom);this.viewer.dispatchEvent(h);const l=new m,c=this.viewer.adapter.createMesh(t.panoData);if(this.viewer.adapter.setTexture(c,t,!0),this.viewer.adapter.setTextureOpacity(c,0),this.setPanoramaPose(t.panoData,c),this.setSphereCorrection(e.sphereCorrection,l),r&&!o.rotation){const t=this.viewer.getPosition(),e=new s(0,1,0);l.rotateOnWorldAxis(e,h.position.yaw-t.yaw);const i=new s(0,1,0).cross(this.camera.getWorldDirection(new s)).normalize();l.rotateOnWorldAxis(i,h.position.pitch-t.pitch)}l.add(c),this.scene.add(l),this.renderer.setRenderTarget(new g),this.renderer.render(this.scene,this.camera),this.renderer.setRenderTarget(null);const{duration:d,properties:p}=this.viewer.dataHelper.getAnimationProperties(o.speed,o.rotation?h.position:null,n?h.zoomLevel:null),u=new ie({properties:{...p,opacity:{start:0,end:1}},duration:d,easing:"inOutCubic",onTick:t=>{switch(o.effect){case"fade":this.viewer.adapter.setTextureOpacity(c,t.opacity);break;case"black":case"white":t.opacity<.5?this.renderer.toneMappingExposure="black"===o.effect?i.mapLinear(t.opacity,0,.5,1,0):i.mapLinear(t.opacity,0,.5,1,4):(this.renderer.toneMappingExposure="black"===o.effect?i.mapLinear(t.opacity,.5,1,0,1):i.mapLinear(t.opacity,.5,1,4,1),this.mesh.visible=!1,this.viewer.adapter.setTextureOpacity(c,1),a&&!n&&this.viewer.dynamics.zoom.setValue(h.zoomLevel))}r&&o.rotation&&this.viewer.dynamics.position.setValue({yaw:t.yaw,pitch:t.pitch}),a&&n&&this.viewer.dynamics.zoom.setValue(t.zoom),this.viewer.needsUpdate()}});return u.then((i=>{l.remove(c),this.scene.remove(l),i?(this.viewer.adapter.disposeTexture(this.state.textureData),this.meshContainer.remove(this.mesh),this.viewer.adapter.disposeMesh(this.mesh),this.mesh=c,this.meshContainer.add(c),this.state.textureData=t,this.setPanoramaPose(t.panoData),this.setSphereCorrection(e.sphereCorrection),r&&!o.rotation&&this.viewer.rotate(e.position)):(this.viewer.adapter.disposeTexture(t),this.viewer.adapter.disposeMesh(c))})),u}getIntersections(t){ws.x=2*t.x/this.state.size.width-1,ws.y=-2*t.y/this.state.size.height+1,this.raycaster.setFromCamera(ws,this.camera);const e=this.raycaster.intersectObjects(this.scene.children,!0).filter((t=>t.object.visible)).filter((t=>t.object.isMesh&&!!t.object.userData));return this.customRenderer?.getIntersections&&e.push(...this.customRenderer.getIntersections(this.raycaster,ws)),e}isObjectVisible(t){if(!t)return!1;if(this.frustumNeedsUpdate&&(ys.multiplyMatrices(this.camera.projectionMatrix,this.camera.matrixWorldInverse),this.frustum.setFromProjectionMatrix(ys),this.frustumNeedsUpdate=!1),t.isVector3)return this.frustum.containsPoint(t);if(t.isMesh&&t.geometry){const e=t;return e.geometry.boundingBox||e.geometry.computeBoundingBox(),bs.copy(e.geometry.boundingBox).applyMatrix4(e.matrixWorld),this.frustum.intersectsBox(bs)}return!!t.isObject3D&&this.frustum.intersectsObject(t)}addObject(t){this.scene.add(t)}removeObject(t){this.scene.remove(t)}cleanScene(t){const e=t=>{t.map?.dispose(),t.uniforms&&Object.values(t.uniforms).forEach((t=>{t.value?.dispose?.()})),t.dispose()};t.traverse((i=>{i.geometry?.dispose(),i.material&&(Array.isArray(i.material)?i.material.forEach((t=>{e(t)})):e(i.material)),i instanceof h||i.dispose?.(),i!==t&&this.cleanScene(i)}))}},Es=class extends x{load(t,e,i,s,o){const n=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"});fetch(n,{signal:o}).then((t=>{if(200===t.status||0===t.status){const e=t.body.getReader(),o=t.headers.get("Content-Length")||t.headers.get("X-File-Size"),n=o?parseInt(o):0,r=0!==n;let a=0;const h=new ReadableStream({start(t){!function o(){e.read().then((({done:e,value:s})=>{if(e)t.close();else{a+=s.byteLength;const e=new ProgressEvent("progress",{lengthComputable:r,loaded:a,total:n});i(e),t.enqueue(s),o()}})).catch((t=>{s(t)}))}()}});return new Response(h)}throw new Error(`fetch for "${t.url}" responded with ${t.status}: ${t.statusText}`)})).then((t=>t.blob())).then((t=>{e(t)})).catch((t=>{s(t)}))}},_s=class extends x{load(t,e,i,s){const o=document.createElement("img");function n(){h(),e(this)}function r(t){if(h(),s?.aborted){const t=new Error;t.name="AbortError",t.message="The operation was aborted.",i(t)}else i(t)}function a(){o.src=""}function h(){o.removeEventListener("load",n,!1),o.removeEventListener("error",r,!1),s?.removeEventListener("abort",a,!1)}return o.addEventListener("load",n,!1),o.addEventListener("error",r,!1),s?.addEventListener("abort",a,!1),t.startsWith("data:")||void 0===this.crossOrigin||(o.crossOrigin=this.crossOrigin),o.src=t,o}},ks=class extends ds{constructor(t){super(t),this.abortCtrl={},this.fileLoader=new Es,this.imageLoader=new _s,this.config.withCredentials&&(this.fileLoader.setWithCredentials(!0),this.imageLoader.setCrossOrigin("use-credentials"))}destroy(){this.abortLoading(),super.destroy()}abortLoading(){Object.values(this.abortCtrl).forEach((t=>t.abort())),this.abortCtrl={}}loadFile(t,e,i){const s=os.get(t,i);if(s){if(s instanceof Blob)return e?.(100),Promise.resolve(s);os.remove(t,i)}return this.config.requestHeaders&&this.fileLoader.setRequestHeader(this.config.requestHeaders(t)),new Promise(((s,o)=>{let n=0;e?.(n),this.fileLoader.load(t,(o=>{n=100,e?.(n),os.add(t,i,o),s(o)}),(t=>{if(t.lengthComputable){const i=t.loaded/t.total*100;i>n&&(n=i,e?.(n))}}),(t=>{o(t)}),this.__getAbortSignal(i))}))}loadImage(t,e,i){const s=os.get(t,i);return s?(e?.(100),s instanceof Blob?this.blobToImage(s):Promise.resolve(s)):e||this.config.requestHeaders?this.loadFile(t,e,i).then((t=>this.blobToImage(t))):new Promise(((e,s)=>{this.imageLoader.load(t,(s=>{os.add(t,i,s),e(s)}),(t=>{s(t)}),this.__getAbortSignal(i))}))}blobToImage(t){return new Promise(((e,i)=>{const s=document.createElement("img");s.onload=()=>{URL.revokeObjectURL(s.src),e(s)},s.onerror=i,s.src=URL.createObjectURL(t)}))}preloadPanorama(t){return this.viewer.adapter.supportsPreload(t)?this.viewer.adapter.loadTexture(t,!1):Promise.reject(new St("Current adapter does not support preload"))}dispatchProgress(t){this.viewer.loader.setProgress(t),this.viewer.dispatchEvent(new Re(Math.round(t)))}__getAbortSignal(t){return t?(this.abortCtrl[t]?.signal.aborted&&delete this.abortCtrl[t],this.abortCtrl[t]||(this.abortCtrl[t]=new AbortController),this.abortCtrl[t].signal):null}},Ms=class extends ds{constructor(t){super(t),this.zoom=new se((t=>{this.viewer.state.vFov=this.viewer.dataHelper.zoomLevelToFov(t),this.viewer.state.hFov=this.viewer.dataHelper.vFovToHFov(this.viewer.state.vFov),this.viewer.dispatchEvent(new ui(t))}),{defaultValue:this.viewer.config.defaultZoomLvl,min:0,max:100,wrap:!1}),this.position=new oe((t=>{this.viewer.dataHelper.sphericalCoordsToVector3(t,this.viewer.state.direction),this.viewer.dispatchEvent(new Be(t))}),{yaw:new se(null,{defaultValue:this.config.defaultYaw,min:0,max:2*Math.PI,wrap:!0}),pitch:new se(null,{defaultValue:this.config.defaultPitch,min:-Math.PI/2,max:Math.PI/2,wrap:!1})}),this.roll=new se((t=>{this.viewer.state.roll=t,this.viewer.dispatchEvent(new Ke(t))}),{defaultValue:0,min:-Math.PI,max:Math.PI,wrap:!1}),this.updateSpeeds()}updateSpeeds(){this.zoom.setSpeed(50*this.config.zoomSpeed),this.position.setSpeed(i.degToRad(50*this.config.moveSpeed)),this.roll.setSpeed(i.degToRad(50*this.config.moveSpeed))}update(t){this.zoom.update(t),this.position.update(t),this.roll.update(t)}},Cs=class{constructor(){this.ready=!1,this.needsUpdate=!1,this.continuousUpdateCount=0,this.keyboardEnabled=!1,this.direction=new s(0,0,F),this.roll=0,this.vFov=60,this.hFov=60,this.aspect=1,this.animation=null,this.transitionAnimation=null,this.loadingPromise=null,this.idleTime=-1,this.objectsObservers={},this.size={width:0,height:0}}},Ts=(t("V",class extends ce{constructor(t){if(super(),this.plugins={},this.children=[],this.parent=nt(t.container),!this.parent)throw new St('"container" element not found.');this.parent[W]=this,this.container=document.createElement("div"),this.container.classList.add("psv-container"),this.parent.appendChild(this.container),te(this.parent),Qt(this.container,"core"),this.state=new Cs,this.config=Qi(t),this.__setSize(this.config.size),this.overlay=new as(this);try{ki.load()}catch(e){return console.error(e),void this.showError(this.config.lang.webglError)}os.init(),this.adapter=new this.config.adapter[0](this,this.config.adapter[1]),this.renderer=new xs(this),this.textureLoader=new ks(this),this.eventsHandler=new fs(this),this.dataHelper=new vs(this),this.dynamics=new Ms(this),this.adapter.init?.(),this.loader=new ns(this),this.navbar=new ss(this),this.panel=new ls(this),this.notification=new rs(this),this.autoSize(),this.setCursor(null),zt(ki.isTouchEnabled,(t=>{rt(this.container,"psv--is-touch",t)})),this.config.plugins.forEach((([t,e])=>{this.plugins[t.id]=new t(this,e)}));for(const i of Object.values(this.plugins))i.init?.();this.config.navbar&&this.navbar.setButtons(this.config.navbar),this.state.loadingPromise||(this.config.panorama?this.setPanorama(this.config.panorama,{sphereCorrection:this.config.sphereCorrection,panoData:this.config.panoData}):this.loader.show())}destroy(){this.stopAll(),this.stopKeyboardControl(),this.exitFullscreen();for(const[t,e]of Object.entries(this.plugins))e.destroy(),delete this.plugins[t];this.children.slice().forEach((t=>t.destroy())),this.children.length=0,this.eventsHandler?.destroy(),this.renderer?.destroy(),this.textureLoader?.destroy(),this.dataHelper?.destroy(),this.adapter?.destroy(),this.dynamics?.destroy(),this.parent.removeChild(this.container),delete this.parent[W]}init(){this.eventsHandler.init(),this.renderer.init(),this.config.navbar&&this.navbar.show(),"always"===this.config.keyboard&&this.startKeyboardControl(),this.resetIdleTimer(),this.state.ready=!0,this.dispatchEvent(new Ge)}resetIdleTimer(){this.state.idleTime=performance.now()}disableIdleTimer(){this.state.idleTime=-1}getPlugin(t){if("string"==typeof t)return this.plugins[t];{const e=Xi(t);return e?this.plugins[e.id]:null}}getPosition(){return this.dataHelper.cleanPosition(this.dynamics.position.current)}getZoomLevel(){return this.dynamics.zoom.current}getSize(){return{...this.state.size}}isFullscreenEnabled(){return gt(this.parent,ki.isIphone)}needsUpdate(){this.state.needsUpdate=!0}needsContinuousUpdate(t){t?this.state.continuousUpdateCount++:this.state.continuousUpdateCount>0&&this.state.continuousUpdateCount--}autoSize(){this.container.clientWidth===this.state.size.width&&this.container.clientHeight===this.state.size.height||(this.state.size.width=Math.round(this.container.clientWidth),this.state.size.height=Math.round(this.container.clientHeight),this.state.aspect=this.state.size.width/this.state.size.height,this.state.hFov=this.dataHelper.vFovToHFov(this.state.vFov),this.dispatchEvent(new li(this.getSize())),this.navbar.autoSize())}setPanorama(t,e={}){this.textureLoader.abortLoading(),this.state.transitionAnimation?.cancel();const i=this.dataHelper.getTransitionOptions(e);void 0===e.showLoader&&(e.showLoader=!0),void 0===e.caption&&(e.caption=this.config.caption),void 0===e.description&&(e.description=this.config.description),e.panoData||"function"!=typeof this.config.panoData||(e.panoData=this.config.panoData),this.hideError(),this.resetIdleTimer(),this.config.panorama=t,this.config.caption=e.caption,this.config.description=e.description,this.config.sphereCorrection=e.sphereCorrection;const s=e=>{if(It(e))return!1;if(this.loader.hide(),this.state.loadingPromise=null,e)throw this.navbar.setCaption(null),this.showError(this.config.lang.loadError),console.error(e),this.dispatchEvent(new Fe(t,e)),e;return this.navbar.setCaption(this.config.caption),!0};this.navbar.setCaption(`<em>${this.config.lang.loading}</em>`),!e.showLoader&&this.state.ready||this.loader.show(),this.dispatchEvent(new je(t));const o=this.adapter.loadTexture(this.config.panorama,!0,e.panoData).then((t=>{if(t.panorama!==this.config.panorama)throw this.adapter.disposeTexture(t),Ot();const i=this.dataHelper.cleanPanoramaOptions(e,t.panoData);return Mt(i.zoom)&&Mt(i.position)||this.stopAll(),{textureData:t,cleanOptions:i}}));return i&&this.state.ready&&this.adapter.supportsTransition(this.config.panorama)?this.state.loadingPromise=o.then((({textureData:t,cleanOptions:e})=>(this.loader.hide(),this.dispatchEvent(new Ue(t)),this.state.transitionAnimation=this.renderer.transition(t,e,i),this.state.transitionAnimation))).then((t=>{if(this.state.transitionAnimation=null,this.dispatchEvent(new Ye(t)),!t)throw Ot()})).then((()=>s()),(t=>s(t))):this.state.loadingPromise=o.then((({textureData:t,cleanOptions:i})=>{this.renderer.show(),this.renderer.setTexture(t),this.renderer.setPanoramaPose(t.panoData),this.renderer.setSphereCorrection(e.sphereCorrection),this.state.ready||this.init(),this.dispatchEvent(new Ue(t)),Mt(i.zoom)||this.zoom(i.zoom),Mt(i.position)||this.rotate(i.position)})).then((()=>s()),(t=>s(t))),this.state.loadingPromise}setOptions(t){const e={...this.config,...t};for(let[i,s]of Object.entries(t))if(i in Ki)if(i in qi)Dt(qi[i]);else switch(i in Gi&&(s=Gi[i](s,{rawConfig:e,defValue:Ki[i]})),this.config[i]=s,i){case"mousemove":this.state.cursorOverride||this.setCursor(null);break;case"caption":this.navbar.setCaption(this.config.caption);break;case"size":this.resize(this.config.size);break;case"sphereCorrection":this.renderer.setSphereCorrection(this.config.sphereCorrection);break;case"navbar":case"lang":this.navbar.setButtons(this.config.navbar);break;case"moveSpeed":case"zoomSpeed":this.dynamics.updateSpeeds();break;case"minFov":case"maxFov":this.dynamics.zoom.setValue(this.dataHelper.fovToZoomLevel(this.state.vFov)),this.dispatchEvent(new ui(this.getZoomLevel()));break;case"keyboard":"always"===this.config.keyboard?this.startKeyboardControl():this.stopKeyboardControl()}else Dt(`Unknown option ${i}`);this.needsUpdate(),this.dispatchEvent(new xe(Object.keys(t)))}setOption(t,e){this.setOptions({[t]:e})}showError(t){this.overlay.show({id:B.ERROR,image:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="15 15 70 70"><path fill="currentColor" d="M50,16.2c-18.6,0-33.8,15.1-33.8,33.8S31.4,83.7,50,83.7S83.8,68.6,83.8,50S68.6,16.2,50,16.2z M50,80.2c-16.7,0-30.2-13.6-30.2-30.2S33.3,19.7,50,19.7S80.3,33.3,80.3,50S66.7,80.2,50,80.2z"/><rect fill="currentColor" x="48" y="31.7" width="4" height="28"/><rect fill="currentColor" x="48" y="63.2" width="4" height="5"/>\x3c!--Created by Shastry from the Noun Project--\x3e</svg>\n',title:t,dismissible:!1})}hideError(){this.overlay.hide(B.ERROR)}rotate(t){const e=new fe(this.dataHelper.cleanPosition(t));this.dispatchEvent(e),e.defaultPrevented||this.dynamics.position.setValue(e.position)}zoom(t){this.dynamics.zoom.setValue(t)}zoomIn(t=1){this.dynamics.zoom.step(t)}zoomOut(t=1){this.dynamics.zoom.step(-t)}animate(t){const e=At(t),i=!Mt(t.zoom),s=new ue(e?this.dataHelper.cleanPosition(t):void 0,t.zoom);if(this.dispatchEvent(s),s.defaultPrevented)return;this.stopAll();const{duration:o,properties:n}=this.dataHelper.getAnimationProperties(t.speed,s.position,s.zoomLevel);return o?(this.state.animation=new ie({properties:n,duration:o,easing:t.easing||"inOutSine",onTick:t=>{e&&this.dynamics.position.setValue({yaw:t.yaw,pitch:t.pitch}),i&&this.dynamics.zoom.setValue(t.zoom)}}),this.state.animation.then((()=>{this.state.animation=null,this.resetIdleTimer()})),this.state.animation):(e&&this.rotate(s.position),i&&this.zoom(s.zoomLevel),new ie(null))}stopAnimation(){return this.state.animation?(this.state.animation.cancel(),this.state.animation):Promise.resolve()}resize(t){this.__setSize(t),this.autoSize()}__setSize(t){["width","height"].forEach((e=>{t?.[e]&&(/^[0-9.]+$/.test(t[e])&&(t[e]+="px"),this.parent.style[e]=t[e])}))}enterFullscreen(){this.isFullscreenEnabled()||ft(this.parent,ki.isIphone)}exitFullscreen(){this.isFullscreenEnabled()&&wt(ki.isIphone)}toggleFullscreen(){this.isFullscreenEnabled()?this.exitFullscreen():this.enterFullscreen()}startKeyboardControl(){this.state.keyboardEnabled=!0}stopKeyboardControl(){this.state.keyboardEnabled=!1}createTooltip(t){return new cs(this,t)}setCursor(t){this.state.cursorOverride=t,this.container.style.cursor=t||(this.config.mousemove?"move":"default")}observeObjects(t){this.state.objectsObservers[t]||(this.state.objectsObservers[t]=null)}unobserveObjects(t){delete this.state.objectsObservers[t]}stopAll(){return this.dispatchEvent(new di),this.disableIdleTimer(),this.stopAnimation()}}),Object.defineProperty);((t,e)=>{for(var i in e)Ts(t,i,{get:e[i],enumerable:!0})})({},{EnterMarkerEvent:()=>Hs,GotoMarkerDoneEvent:()=>Os,HideMarkersEvent:()=>Ws,LeaveMarkerEvent:()=>Ds,MarkerVisibilityEvent:()=>zs,MarkersPluginEvent:()=>Ls,RenderMarkersListEvent:()=>qs,SelectMarkerEvent:()=>Ns,SelectMarkerListEvent:()=>Vs,SetMarkersEvent:()=>Zs,ShowMarkersEvent:()=>Xs,UnselectMarkerEvent:()=>$s});var Ls=class extends le{},Ss=class t extends Ls{constructor(e,i){super(t.type),this.marker=e,this.visible=i}};Ss.type="marker-visibility";var zs=Ss,Ps=class t extends Ls{constructor(e){super(t.type),this.marker=e}};Ps.type="goto-marker-done";var Os=Ps,Is=class t extends Ls{constructor(e){super(t.type),this.marker=e}};Is.type="leave-marker";var Ds=Is,As=class t extends Ls{constructor(e){super(t.type),this.marker=e}};As.type="enter-marker";var Hs=As,Rs=class t extends Ls{constructor(e,i,s){super(t.type),this.marker=e,this.doubleClick=i,this.rightClick=s}};Rs.type="select-marker";var Ns=Rs,js=class t extends Ls{constructor(e){super(t.type),this.marker=e}};js.type="select-marker-list";var Vs=js,Us=class t extends Ls{constructor(e){super(t.type),this.marker=e}};Us.type="unselect-marker";var $s=Us,Fs=class t extends Ls{constructor(){super(t.type)}};Fs.type="hide-markers";var Ws=Fs,Ys=class t extends Ls{constructor(e){super(t.type),this.markers=e}};Ys.type="set-markers";var Zs=Ys,Bs=class t extends Ls{constructor(){super(t.type)}};Bs.type="show-markers";var Xs=Bs,Ks=class t extends Ls{constructor(e){super(t.type),this.markers=e}};Ks.type="render-markers-list";var qs=Ks,Gs=class extends zi{constructor(t){super(t,{className:"psv-markers-button",icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="10 9 81 81"><path fill="currentColor" d="M50.5 90S22.9 51.9 22.9 36.6 35.2 9 50.5 9s27.6 12.4 27.6 27.6S50.5 90 50.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11z"/>\x3c!--Created by Rohith M S from the Noun Project--\x3e</svg>\n',hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.plugin.addEventListener(Xs.type,this),this.plugin.addEventListener(Ws.type,this),this.toggleActive(!0))}destroy(){this.plugin&&(this.plugin.removeEventListener(Xs.type,this),this.plugin.removeEventListener(Ws.type,this)),super.destroy()}isSupported(){return!!this.plugin}handleEvent(t){t instanceof Xs?this.toggleActive(!0):t instanceof Ws&&this.toggleActive(!1)}onClick(){this.plugin.toggleAllMarkers()}};Gs.id="markers";var Qs='<svg xmlns="http://www.w3.org/2000/svg" viewBox="9 9 81 81"><path fill="currentColor" d="M37.5 90S9.9 51.9 9.9 36.6 22.2 9 37.5 9s27.6 12.4 27.6 27.6S37.5 90 37.5 90zm0-66.3c-6.1 0-11 4.9-11 11s4.9 11 11 11 11-4.9 11-11-4.9-11-11-11zM86.7 55H70c-1.8 0-3.3-1.5-3.3-3.3s1.5-3.3 3.3-3.3h16.7c1.8 0 3.3 1.5 3.3 3.3S88.5 55 86.7 55zm0-25h-15a3.3 3.3 0 0 1-3.3-3.3c0-1.8 1.5-3.3 3.3-3.3h15c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3zM56.5 73h30c1.8 0 3.3 1.5 3.3 3.3 0 1.8-1.5 3.3-3.3 3.3h-30a3.3 3.3 0 0 1-3.3-3.3 3.2 3.2 0 0 1 3.3-3.3z"/>\x3c!--Created by Rohith M S from the Noun Project--\x3e</svg>\n',Js="http://www.w3.org/2000/svg",to="psvMarker",eo=G.dasherize(to),io="marker",so="markersList",oo={amount:2,duration:100,easing:"linear"},no=(t,e)=>`\n<div class="psv-panel-menu psv-panel-menu--stripped">\n    <h1 class="psv-panel-menu-title">${Qs} ${e}</h1>\n    <ul class="psv-panel-menu-list">\n    ${t.map((t=>`\n        <li data-${eo}="${t.id}" class="psv-panel-menu-item" tabindex="0">\n          ${"image"===t.type?`<span class="psv-panel-menu-item-icon"><img src="${t.definition}"/></span>`:""}\n          <span class="psv-panel-menu-item-label">${t.getListContent()}</span>\n        </li>\n    `)).join("")}\n    </ul>\n</div>\n`,ro=class extends zi{constructor(t){super(t,{className:" psv-markers-list-button",icon:Qs,hoverScale:!0,collapsable:!0,tabbable:!0}),this.plugin=this.viewer.getPlugin("markers"),this.plugin&&(this.viewer.addEventListener(he.ShowPanelEvent.type,this),this.viewer.addEventListener(he.HidePanelEvent.type,this))}destroy(){this.viewer.removeEventListener(he.ShowPanelEvent.type,this),this.viewer.removeEventListener(he.HidePanelEvent.type,this),super.destroy()}isSupported(){return!!this.plugin}handleEvent(t){t instanceof he.ShowPanelEvent?this.toggleActive(t.panelId===so):t instanceof he.HidePanelEvent&&this.toggleActive(!1)}onClick(){this.plugin.toggleMarkersList()}};ro.id="markersList";var ao=new s,ho=new E,lo=new s,co=class extends S{constructor(t=document.createElement("div")){super(),this.isCSS3DObject=!0,this.element=t,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.addEventListener("removed",(function(){this.traverse((function(t){t.element instanceof t.element.ownerDocument.defaultView.Element&&null!==t.element.parentNode&&t.element.remove()}))}))}copy(t,e){return super.copy(t,e),this.element=t.element.cloneNode(!0),this}},po=new w,uo=new w,vo=class{constructor(t={}){const e=this;let i,s,o,n;const r={camera:{style:""},objects:new WeakMap},a=void 0!==t.element?t.element:document.createElement("div");a.style.overflow="hidden",this.domElement=a;const h=document.createElement("div");h.style.transformOrigin="0 0",h.style.pointerEvents="none",a.appendChild(h);const l=document.createElement("div");function c(t){return Math.abs(t)<1e-10?0:t}function d(t){const e=t.elements;return"matrix3d("+c(e[0])+","+c(-e[1])+","+c(e[2])+","+c(e[3])+","+c(e[4])+","+c(-e[5])+","+c(e[6])+","+c(e[7])+","+c(e[8])+","+c(-e[9])+","+c(e[10])+","+c(e[11])+","+c(e[12])+","+c(-e[13])+","+c(e[14])+","+c(e[15])+")"}function p(t){const e=t.elements;return"translate(-50%,-50%)matrix3d("+c(e[0])+","+c(e[1])+","+c(e[2])+","+c(e[3])+","+c(-e[4])+","+c(-e[5])+","+c(-e[6])+","+c(-e[7])+","+c(e[8])+","+c(e[9])+","+c(e[10])+","+c(e[11])+","+c(e[12])+","+c(e[13])+","+c(e[14])+","+c(e[15])+")"}function u(t){t.isCSS3DObject&&(t.element.style.display="none");for(let e=0,i=t.children.length;e<i;e++)u(t.children[e])}function v(t,i,s,o){if(!1!==t.visible){if(t.isCSS3DObject){const o=!0===t.layers.test(s.layers),n=t.element;if(n.style.display=!0===o?"":"none",!0===o){let o;t.onBeforeRender(e,i,s),t.isCSS3DSprite?(po.copy(s.matrixWorldInverse),po.transpose(),0!==t.rotation2D&&po.multiply(uo.makeRotationZ(t.rotation2D)),t.matrixWorld.decompose(ao,ho,lo),po.setPosition(ao),po.scale(lo),po.elements[3]=0,po.elements[7]=0,po.elements[11]=0,po.elements[15]=1,o=p(po)):o=p(t.matrixWorld);const a=r.objects.get(t);if(void 0===a||a.style!==o){n.style.transform=o;const e={style:o};r.objects.set(t,e)}n.parentNode!==l&&l.appendChild(n),t.onAfterRender(e,i,s)}}for(let e=0,o=t.children.length;e<o;e++)v(t.children[e],i,s)}else u(t)}l.style.transformStyle="preserve-3d",h.appendChild(l),this.getSize=function(){return{width:i,height:s}},this.render=function(t,e){const a=e.projectionMatrix.elements[5]*n;let p,u;e.view&&e.view.enabled?(h.style.transform=`translate( ${-e.view.offsetX*(i/e.view.width)}px, ${-e.view.offsetY*(s/e.view.height)}px )`,h.style.transform+=`scale( ${e.view.fullWidth/e.view.width}, ${e.view.fullHeight/e.view.height} )`):h.style.transform="",!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),null===e.parent&&!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),e.isOrthographicCamera&&(p=-(e.right+e.left)/2,u=(e.top+e.bottom)/2);const m=e.view&&e.view.enabled?e.view.height/e.view.fullHeight:1,g=e.isOrthographicCamera?`scale( ${m} )scale(`+a+")translate("+c(p)+"px,"+c(u)+"px)"+d(e.matrixWorldInverse):`scale( ${m} )translateZ(`+a+"px)"+d(e.matrixWorldInverse),f=(e.isPerspectiveCamera?"perspective("+a+"px) ":"")+g+"translate("+o+"px,"+n+"px)";r.camera.style!==f&&(l.style.transform=f,r.camera.style=f),v(t,t,e)},this.setSize=function(t,e){i=t,s=e,o=i/2,n=s/2,a.style.width=t+"px",a.style.height=e+"px",h.style.width=t+"px",h.style.height=e+"px",l.style.width=t+"px",l.style.height=e+"px"}}},mo=class{constructor(t){this.viewer=t,this.element=document.createElement("div"),this.element.className="psv-markers-css3d-container",this.renderer=new vo({element:this.element}),this.scene=new h,this.intersectionObserver=new IntersectionObserver((t=>{t.forEach((t=>{const e=t.target[to];e.config.visible&&(e.viewportIntersection=t.isIntersecting)}))}),{root:this.element}),t.addEventListener(he.ReadyEvent.type,this,{once:!0}),t.addEventListener(he.SizeUpdatedEvent.type,this),t.addEventListener(he.RenderEvent.type,this)}handleEvent(t){switch(t.type){case he.ReadyEvent.type:case he.SizeUpdatedEvent.type:this.updateSize();break;case he.RenderEvent.type:this.render()}}destroy(){this.viewer.removeEventListener(he.ReadyEvent.type,this),this.viewer.removeEventListener(he.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(he.RenderEvent.type,this),this.intersectionObserver.disconnect()}updateSize(){const t=this.viewer.getSize();this.renderer.setSize(t.width,t.height)}render(){this.renderer.render(this.scene,this.viewer.renderer.camera)}addObject(t){this.scene.add(t.threeElement),this.intersectionObserver.observe(t.domElement)}removeObject(t){this.scene.remove(t.threeElement),this.intersectionObserver.unobserve(t.domElement)}},go=(t=>(t.image="image",t.html="html",t.element="element",t.imageLayer="imageLayer",t.videoLayer="videoLayer",t.elementLayer="elementLayer",t.polygon="polygon",t.polygonPixels="polygonPixels",t.polyline="polyline",t.polylinePixels="polylinePixels",t.square="square",t.rect="rect",t.circle="circle",t.ellipse="ellipse",t.path="path",t))(go||{});function fo(t,e=!1){const i=[];if(Object.keys(go).forEach((e=>{t[e]&&i.push(e)})),0===i.length&&!e)throw new St(`missing marker content, either ${Object.keys(go).join(", ")}`);if(i.length>1)throw new St(`multiple marker content, either ${Object.keys(go).join(", ")}`);return i[0]}var wo=class{constructor(t,e,i){if(this.viewer=t,this.plugin=e,this.state={anchor:null,visible:!1,staticTooltip:!1,position:null,position2D:null,positions3D:null,size:null},!i.id)throw new St("missing marker id");this.type=fo(i),this.createElement(),this.update(i)}get id(){return this.config.id}get data(){return this.config.data}get domElement(){return null}get threeElement(){return null}get video(){return null}destroy(){delete this.viewer,delete this.plugin,delete this.element,this.hideTooltip()}is3d(){return!1}isNormal(){return!1}isPoly(){return!1}isSvg(){return!1}isCss3d(){return!1}update(t){const e=fo(t,!0);if(void 0!==e&&e!==this.type)throw new St(`cannot change marker ${t.id} type`);if(this.config=G.deepmerge(this.config,t),"string"==typeof this.config.tooltip&&(this.config.tooltip={content:this.config.tooltip}),this.config.tooltip&&!this.config.tooltip.trigger&&(this.config.tooltip.trigger="hover"),G.isNil(this.config.visible)&&(this.config.visible=!0),G.isNil(this.config.zIndex)&&(this.config.zIndex=1),G.isNil(this.config.opacity)&&(this.config.opacity=1),this.config.rotation){const t=this.config.rotation;this.config.rotation="object"==typeof t?{yaw:t.yaw?G.parseAngle(t.yaw,!0,!1):0,pitch:t.pitch?G.parseAngle(t.pitch,!0,!1):0,roll:t.roll?G.parseAngle(t.roll,!0,!1):0}:{yaw:0,pitch:0,roll:G.parseAngle(t,!0,!1)}}else this.config.rotation={yaw:0,pitch:0,roll:0};this.state.anchor=G.parsePoint(this.config.anchor)}getListContent(){return this.config.listContent?this.config.listContent:this.config.tooltip?.content?this.config.tooltip.content:this.config.html?this.config.html:this.id}showTooltip(t,e,i=!1){if(this.state.visible&&this.config.tooltip?.content&&this.state.position2D){const s={...this.config.tooltip,style:{pointerEvents:this.state.staticTooltip?"auto":"none"},data:this,top:0,left:0};if(this.isPoly()||this.is3d()||this.isCss3d())if(t||e){const i=G.getPosition(this.viewer.container);s.top=e-i.y+10,s.left=t-i.x,s.box={width:20,height:20}}else s.top=this.state.position2D.y,s.left=this.state.position2D.x;else{const t=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);let e=this.state.size.width,i=this.state.size.height;this.config.hoverScale&&!this.state.staticTooltip&&(e*=this.config.hoverScale.amount,i*=this.config.hoverScale.amount),s.top=t.y-i*this.state.anchor.y+i/2,s.left=t.x-e*this.state.anchor.x+e/2,s.box={width:e,height:i}}this.tooltip?i?this.tooltip.update(this.config.tooltip.content,s):this.tooltip.move(s):this.tooltip=this.viewer.createTooltip(s)}}hideTooltip(){this.tooltip&&(this.tooltip.hide(),this.tooltip=null)}},yo=class extends wo{get domElement(){return this.element}constructor(t,e,i){super(t,e,i)}afterCreateElement(){this.element[to]=this}destroy(){delete this.element[to],super.destroy()}update(t){super.update(t);const e=this.domElement;e.id=`psv-marker-${this.config.id}`,e.setAttribute("class","psv-marker"),this.state.visible&&e.classList.add("psv-marker--visible"),this.config.tooltip&&e.classList.add("psv-marker--has-tooltip"),this.config.content&&e.classList.add("psv-marker--has-content"),this.config.className&&G.addClasses(e,this.config.className),e.style.opacity=`${this.config.opacity}`,e.style.zIndex=`${30+this.config.zIndex}`,this.config.style&&Object.assign(e.style,this.config.style)}},bo=class extends yo{constructor(t,e,i){super(t,e,i)}afterCreateElement(){super.afterCreateElement(),this.domElement.addEventListener("transitionend",(()=>{this.domElement.style.transition=""}))}render({viewerPosition:t,zoomLevel:e,hoveringMarker:i}){this.__updateSize();const s=this.viewer.dataHelper.vector3ToViewerCoords(this.state.positions3D[0]);return s.x-=this.state.size.width*this.state.anchor.x,s.y-=this.state.size.height*this.state.anchor.y,this.state.positions3D[0].dot(this.viewer.state.direction)>0&&s.x+this.state.size.width>=0&&s.x-this.state.size.width<=this.viewer.state.size.width&&s.y+this.state.size.height>=0&&s.y-this.state.size.height<=this.viewer.state.size.height?(this.domElement.style.translate=`${s.x}px ${s.y}px 0px`,this.applyScale({zoomLevel:e,viewerPosition:t,mouseover:this===i}),s):null}update(t){if(super.update(t),!G.isExtendedPosition(this.config.position))throw new St(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(s){throw new St(`invalid marker ${this.id} position`,s)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const e=this.domElement;e.classList.add("psv-marker--normal"),this.config.scale&&Array.isArray(this.config.scale)&&(this.config.scale={zoom:this.config.scale}),"boolean"==typeof this.config.hoverScale?this.config.hoverScale=this.config.hoverScale?this.plugin.config.defaultHoverScale||oo:null:"number"==typeof this.config.hoverScale?this.config.hoverScale={amount:this.config.hoverScale}:this.config.hoverScale||(this.config.hoverScale=this.plugin.config.defaultHoverScale),this.config.hoverScale&&(this.config.hoverScale={...this.plugin.config.defaultHoverScale,...this.config.hoverScale}),e.style.rotate=0!==this.config.rotation.roll?i.radToDeg(this.config.rotation.roll)+"deg":null,e.style.transformOrigin=`${100*this.state.anchor.x}% ${100*this.state.anchor.y}%`}__updateSize(){if(!this.needsUpdateSize)return;const t=this.domElement,e=!this.state.visible||!this.state.size;if(e&&t.classList.add("psv-marker--transparent"),this.isSvg()){const e=t.firstElementChild.getBoundingClientRect();this.state.size={width:e.width,height:e.height}}else this.state.size={width:t.offsetWidth,height:t.offsetHeight};e&&t.classList.remove("psv-marker--transparent"),this.isSvg()&&(t.style.width=this.state.size.width+"px",t.style.height=this.state.size.height+"px"),"element"!==this.type&&(this.needsUpdateSize=!1)}applyScale({zoomLevel:t,viewerPosition:e,mouseover:s}){null!==s&&this.config.hoverScale&&(this.domElement.style.transition=`scale ${this.config.hoverScale.duration}ms ${this.config.hoverScale.easing}`);let o=1;if("function"==typeof this.config.scale)o=this.config.scale(t,e);else if(this.config.scale){if(Array.isArray(this.config.scale.zoom)){const[e,i]=this.config.scale.zoom;o*=e+(i-e)*A.EASINGS.inQuad(t/100)}if(Array.isArray(this.config.scale.yaw)){const[t,s]=this.config.scale.yaw,n=i.degToRad(this.viewer.state.hFov)/2,r=Math.abs(G.getShortestArc(this.state.position.yaw,e.yaw));o*=s+(t-s)*A.EASINGS.outQuad(Math.max(0,(n-r)/n))}}s&&this.config.hoverScale&&(o*=this.config.hoverScale.amount),this.domElement.style.scale=`${o}`}},xo=class extends z{get map(){return this.uniforms.map.value}set map(t){this.uniforms.map.value=t}set alpha(t){this.uniforms.alpha.value=t}get offset(){return this.uniforms.offset.value}get repeat(){return this.uniforms.repeat.value}set chromaKey(t){this.uniforms.keying.value=!0===t?.enabled,t?.enabled&&("object"==typeof t.color&&"r"in t.color?this.uniforms.color.value.set(t.color.r/255,t.color.g/255,t.color.b/255):this.uniforms.color.value.set(t.color??65280),this.uniforms.similarity.value=t.similarity??.2,this.uniforms.smoothness.value=t.smoothness??.2)}constructor(t){super({transparent:!0,depthTest:!1,depthWrite:!1,uniforms:{map:{value:t?.map},repeat:{value:new f(1,1)},offset:{value:new f(0,0)},alpha:{value:t?.alpha??1},keying:{value:!1},color:{value:new P(65280)},similarity:{value:.2},smoothness:{value:.2},spill:{value:.1}},vertexShader:"varying vec2 vUv;\nuniform vec2 repeat;\nuniform vec2 offset;\n\nvoid main() {\n    vUv = uv * repeat + offset;\n    gl_Position = projectionMatrix *  modelViewMatrix * vec4( position, 1.0 );\n}\n",fragmentShader:"// https://www.8thwall.com/playground/chromakey-threejs\n\nuniform sampler2D map;\nuniform float alpha;\nuniform bool keying;\nuniform vec3 color;\nuniform float similarity;\nuniform float smoothness;\nuniform float spill;\n\nvarying vec2 vUv;\n\nvec2 RGBtoUV(vec3 rgb) {\n    return vec2(\n        rgb.r * -0.169 + rgb.g * -0.331 + rgb.b *  0.5    + 0.5,\n        rgb.r *  0.5   + rgb.g * -0.419 + rgb.b * -0.081  + 0.5\n    );\n}\n\nvoid main(void) {\n    gl_FragColor = texture2D(map, vUv);\n\n    if (keying) {\n        float chromaDist = distance(RGBtoUV(gl_FragColor.rgb), RGBtoUV(color));\n\n        float baseMask = chromaDist - similarity;\n        float fullMask = pow(clamp(baseMask / smoothness, 0., 1.), 1.5);\n        gl_FragColor.a *= fullMask * alpha;\n\n        float spillVal = pow(clamp(baseMask / spill, 0., 1.), 1.5);\n        float desat = clamp(gl_FragColor.r * 0.2126 + gl_FragColor.g * 0.7152 + gl_FragColor.b * 0.0722, 0., 1.);\n        gl_FragColor.rgb = mix(vec3(desat, desat, desat), gl_FragColor.rgb, spillVal);\n    } else {\n        gl_FragColor.a *= alpha;\n    }\n}\n"}),this.chromaKey=t?.chromaKey}};function Eo(t,e,i){const[s,o]=t,[n,r]=e,a=G.greatArcDistance(t,e),h=Math.sin((1-i)*a)/Math.sin(a),l=Math.sin(i*a)/Math.sin(a),c=h*Math.cos(o)*Math.cos(s)+l*Math.cos(r)*Math.cos(n),d=h*Math.cos(o)*Math.sin(s)+l*Math.cos(r)*Math.sin(n),p=h*Math.sin(o)+l*Math.sin(r);return[Math.atan2(d,c),Math.atan2(p,Math.sqrt(c*c+d*d))]}function _o(t){const e=[t[0]];let i=0;for(let s=1;s<t.length;s++){const o=t[s-1][0]-t[s][0];o>Math.PI?i+=1:o<-Math.PI&&(i-=1),e.push([t[s][0]+2*i*Math.PI,t[s][1]])}return e}function ko(t){const e=_o(t).reduce(((t,e)=>[t[0]+e[0],t[1]+e[1]]));return[G.parseAngle(e[0]/t.length),e[1]/t.length]}var Mo=new s,Co=new s,To=new s,Lo=new s,So=new s,zo=new s;function Po(t,e,i){Mo.copy(i).normalize(),Co.crossVectors(t,e).normalize(),To.crossVectors(Co,t).normalize(),Lo.copy(t).multiplyScalar(-Mo.dot(To)),So.copy(To).multiplyScalar(Mo.dot(t));const o=(new s).addVectors(Lo,So).normalize();return zo.crossVectors(o,Mo),o.applyAxisAngle(zo,.01).multiplyScalar(A.SPHERE_RADIUS)}var Oo=class extends wo{get threeElement(){return this.element}get threeMesh(){return this.threeElement.children[0]}get video(){return"videoLayer"===this.type?this.threeMesh.material.map.image:null}constructor(t,e,i){super(t,e,i)}is3d(){return!0}createElement(){const t=new xo({alpha:0}),e=new T(1,1),i=new c(e,t);i.userData={[to]:this},Object.defineProperty(i,"visible",{enumerable:!0,get:function(){return this.userData[to].config.visible},set:function(t){this.userData[to].config.visible=t}}),this.element=(new m).add(i),"videoLayer"===this.type&&this.viewer.needsContinuousUpdate(!0)}destroy(){delete this.threeMesh.userData[to],"videoLayer"===this.type&&(this.video.pause(),this.viewer.needsContinuousUpdate(!1)),super.destroy()}render(){return this.viewer.renderer.isObjectVisible(this.threeMesh)?this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position):null}update(t){super.update(t);const e=this.threeMesh,i=e.parent,o=e.material;if(G.isExtendedPosition(this.config.position)){try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(n){throw new St(`invalid marker ${this.id} position`,n)}if(!this.config.size)throw new St(`missing marker ${this.id} size`);this.state.size=this.config.size,e.scale.set(this.config.size.width/100,this.config.size.height/100,1),e.position.set(e.scale.x*(.5-this.state.anchor.x),e.scale.y*(this.state.anchor.y-.5),0),e.rotation.set(0,0,0),this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position,i.position),i.lookAt(0,i.position.y,0),e.rotateY(-this.config.rotation.yaw),e.rotateX(-this.config.rotation.pitch),e.rotateZ(-this.config.rotation.roll);const t=e.geometry.getAttribute("position");this.state.positions3D=[0,1,3,2].map((i=>{const o=new s;return o.fromBufferAttribute(t,i),e.localToWorld(o)}))}else{if(4!==this.config.position?.length)throw new St(`missing marker ${this.id} position`);let t;try{t=this.config.position.map((t=>this.viewer.dataHelper.cleanPosition(t)))}catch(n){throw new St(`invalid marker ${this.id} position`,n)}const i=t.map((t=>this.viewer.dataHelper.sphericalCoordsToVector3(t))),s=ko(t.map((({yaw:t,pitch:e})=>[t,e])));this.state.position={yaw:s[0],pitch:s[1]},this.state.positions3D=i;const r=e.geometry.getAttribute("position");[i[0],i[1],i[3],i[2]].forEach(((t,e)=>{r.setX(e,t.x),r.setY(e,t.y),r.setZ(e,t.z)})),r.needsUpdate=!0,this.__setTextureWrap(o)}switch(this.type){case"videoLayer":if(this.definition!==this.config.videoLayer){o.map?.dispose();const t=function({src:t,withCredentials:e,muted:i,autoplay:s}){const o=document.createElement("video");return o.crossOrigin=e?"use-credentials":"anonymous",o.loop=!0,o.playsInline=!0,o.autoplay=s,o.muted=i,o.preload="metadata",t instanceof MediaStream?o.srcObject=t:o.src=t,o}({src:this.config.videoLayer,withCredentials:this.viewer.config.withCredentials,muted:!0,autoplay:this.config.autoplay??!0}),i=new L(t);o.map=i,o.alpha=0,t.addEventListener("loadedmetadata",(()=>{this.viewer&&(o.alpha=this.config.opacity,G.isExtendedPosition(this.config.position)||(e.material.userData[to]={width:t.videoWidth,height:t.videoHeight},this.__setTextureWrap(o)))}),{once:!0}),t.autoplay&&t.play(),this.definition=this.config.videoLayer}else o.alpha=this.config.opacity;break;case"imageLayer":if(this.definition!==this.config.imageLayer){o.map?.dispose();const t=new _;o.map=t,o.alpha=0,this.viewer.textureLoader.loadImage(this.config.imageLayer).then((i=>{this.viewer&&(G.isExtendedPosition(this.config.position)||(e.material.userData[to]={width:i.width,height:i.height},this.__setTextureWrap(o)),t.image=i,t.anisotropy=4,t.needsUpdate=!0,o.alpha=this.config.opacity,this.viewer.needsUpdate())})),this.definition=this.config.imageLayer}else o.alpha=this.config.opacity}o.chromaKey=this.config.chromaKey,e.renderOrder=1e3+this.config.zIndex,e.geometry.boundingBox=null}__setTextureWrap(t){const e=t.userData[to];if(!e||!e.height||!e.width)return t.repeat.set(1,1),void t.offset.set(0,0);const i=this.config.position.map((t=>this.viewer.dataHelper.cleanPosition(t))),s=(G.greatArcDistance([i[0].yaw,i[0].pitch],[i[1].yaw,i[1].pitch])+G.greatArcDistance([i[3].yaw,i[3].pitch],[i[2].yaw,i[2].pitch]))/(G.greatArcDistance([i[1].yaw,i[1].pitch],[i[2].yaw,i[2].pitch])+G.greatArcDistance([i[0].yaw,i[0].pitch],[i[3].yaw,i[3].pitch])),o=e.width/e.height;let n=0,r=0;s<o?n=o-s:r=1/o-1/s,t.repeat.set(1-n,1-r),t.offset.set(n/2,r/2)}},Io=class extends yo{constructor(t,e,i){super(t,e,i),this.viewportIntersection=!1}get threeElement(){return this.object}isCss3d(){return!0}createElement(){this.element=document.createElement("div"),this.object=new co(this.element),this.object.userData={[to]:this},Object.defineProperty(this.object,"visible",{enumerable:!0,get:function(){return this.userData[to].config.visible},set:function(t){this.userData[to].config.visible=t}}),this.afterCreateElement()}destroy(){delete this.object.userData[to],delete this.object,super.destroy()}render({viewerPosition:t,zoomLevel:e}){const i=this.domElement;if(this.state.size={width:i.offsetWidth,height:i.offsetHeight},this.state.positions3D[0].dot(this.viewer.state.direction)>0&&this.viewportIntersection){const i=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position);return this.config.elementLayer.updateMarker?.({marker:this,position:i,viewerPosition:t,zoomLevel:e,viewerSize:this.viewer.state.size}),i}return null}update(t){if(super.update(t),!G.isExtendedPosition(this.config.position))throw new St(`missing marker ${this.id} position`);try{this.state.position=this.viewer.dataHelper.cleanPosition(this.config.position)}catch(s){throw new St(`invalid marker ${this.id} position`,s)}this.state.positions3D=[this.viewer.dataHelper.sphericalCoordsToVector3(this.state.position)];const e=this.threeElement,i=this.domElement;i.classList.add("psv-marker--css3d"),i.childNodes.forEach((t=>t.remove())),i.appendChild(this.config.elementLayer),this.config.elementLayer.style.display="block",e.position.copy(this.state.positions3D[0]).multiplyScalar(100),e.lookAt(0,100*this.state.positions3D[0].y,0),e.rotateY(-this.config.rotation.yaw),e.rotateX(-this.config.rotation.pitch),e.rotateZ(-this.config.rotation.roll)}},Do=class extends bo{constructor(t,e,i){super(t,e,i)}isNormal(){return!0}createElement(){this.element=document.createElement("div"),this.afterCreateElement()}render(t){const e=super.render(t);return e&&"element"===this.type&&this.config.element.updateMarker?.({marker:this,position:e,viewerPosition:t.viewerPosition,zoomLevel:t.zoomLevel,viewerSize:this.viewer.state.size}),e}update(t){super.update(t);const e=this.domElement;if(this.config.image&&!this.config.size)throw new St(`missing marker ${this.id} size`);switch(this.config.size?(this.needsUpdateSize=!1,this.state.size=this.config.size,e.style.width=this.config.size.width+"px",e.style.height=this.config.size.height+"px"):this.needsUpdateSize=!0,this.type){case"image":this.definition=this.config.image,e.style.backgroundImage=`url("${this.config.image}")`;break;case"html":this.definition=this.config.html,e.innerHTML=this.config.html;break;case"element":this.definition!==this.config.element&&(this.definition=this.config.element,e.childNodes.forEach((t=>t.remove())),e.appendChild(this.config.element),this.config.element.style.display="block")}}},Ao=class extends yo{constructor(t,e,i){super(t,e,i)}createElement(){this.element=document.createElementNS(Js,"path"),this.element[to]=this}isPoly(){return!0}get isPixels(){return"polygonPixels"===this.type||"polylinePixels"===this.type}get isPolygon(){return"polygon"===this.type||"polygonPixels"===this.type}get isPolyline(){return"polyline"===this.type||"polylinePixels"===this.type}get coords(){return this.definition}render(){const t=this.__getAllPolyPositions();if(t[0].length>(this.isPolygon?2:1)){const e=this.viewer.dataHelper.sphericalCoordsToViewerCoords(this.state.position),i=t.filter((t=>t.length>0)).map((t=>{let i="M";return i+=t.map((t=>`${t.x-e.x},${t.y-e.y}`)).join("L"),this.isPolygon&&(i+="Z"),i})).join(" ");return this.domElement.setAttributeNS(null,"d",i),this.domElement.setAttributeNS(null,"transform",`translate(${e.x} ${e.y})`),e}return null}update(t){super.update(t);const e=this.domElement;e.classList.add("psv-marker--poly"),this.config.svgStyle?(Object.entries(this.config.svgStyle).forEach((([t,i])=>{e.setAttributeNS(null,G.dasherize(t),i)})),this.isPolyline&&!this.config.svgStyle.fill&&e.setAttributeNS(null,"fill","none")):this.isPolygon?e.setAttributeNS(null,"fill","rgba(0,0,0,0.5)"):this.isPolyline&&(e.setAttributeNS(null,"fill","none"),e.setAttributeNS(null,"stroke","rgb(0,0,0)"));try{let t=this.config[this.type];if(!Array.isArray(t[0])&&"object"!=typeof t[0])for(let e=0;e<t.length;e++)t.splice(e,2,[t[e],t[e+1]]);if(Array.isArray(t[0][0])||"object"==typeof t[0][0]||(t=[t]),this.isPolyline&&t.length>1)throw new St("polylines cannot have holes");this.isPixels?this.definition=t.map((t=>t.map((t=>{let e;return e=G.isExtendedPosition(t)?this.viewer.dataHelper.cleanPosition(t):this.viewer.dataHelper.textureCoordsToSphericalCoords({textureX:t[0],textureY:t[1]}),[e.yaw,e.pitch]})))):this.definition=t.map((t=>t.map((t=>{let e;return e=G.isExtendedPosition(t)?this.viewer.dataHelper.cleanPosition(t):this.viewer.dataHelper.cleanPosition({yaw:t[0],pitch:t[1]}),[e.yaw,e.pitch]}))))}catch(s){throw new St(`invalid marker ${this.id} position`,s)}const i=this.isPolygon?ko(this.coords[0]):function(t){const e=_o(t);let i=0;const s=[];for(let n=0;n<e.length-1;n++){const t=G.greatArcDistance(e[n],e[n+1])*A.SPHERE_RADIUS;s.push(t),i+=t}let o=0;for(let n=0;n<e.length-1;n++){if(o+s[n]>i/2){const t=(i/2-o)/s[n];return Eo(e[n],e[n+1],t)}o+=s[n]}return e[Math.round(e.length/2)]}(this.coords[0]);this.state.position={yaw:i[0],pitch:i[1]},this.positions3D=this.coords.map((t=>t.map((t=>this.viewer.dataHelper.sphericalCoordsToVector3({yaw:t[0],pitch:t[1]}))))),this.state.positions3D=this.positions3D[0]}__getAllPolyPositions(){return this.positions3D.map((t=>this.__getPolyPositions(t)))}__getPolyPositions(t){const e=t.length,i=t.map((t=>({vector:t,visible:t.dot(this.viewer.state.direction)>0}))),s=[];return i.forEach(((t,o)=>{t.visible||[0===o?i[e-1]:i[o-1],o===e-1?i[0]:i[o+1]].forEach((e=>{e.visible&&s.push({visible:e.vector,invisible:t.vector,index:o})}))})),s.reverse().forEach((t=>{i.splice(t.index,0,{vector:Po(t.visible,t.invisible,this.viewer.state.direction),visible:!0})})),i.filter((t=>t.visible)).map((t=>this.viewer.dataHelper.vector3ToViewerCoords(t.vector)))}},Ho=class extends bo{get svgElement(){return this.domElement.firstElementChild}constructor(t,e,i){super(t,e,i)}isSvg(){return!0}createElement(){const t="square"===this.type?"rect":this.type,e=document.createElementNS(Js,t);this.element=document.createElementNS(Js,"svg"),this.element.appendChild(e),this.afterCreateElement()}update(t){super.update(t);const e=this.svgElement;switch(this.needsUpdateSize=!0,this.type){case"square":this.definition={x:0,y:0,width:this.config.square,height:this.config.square};break;case"rect":Array.isArray(this.config.rect)?this.definition={x:0,y:0,width:this.config.rect[0],height:this.config.rect[1]}:this.definition={x:0,y:0,width:this.config.rect.width,height:this.config.rect.height};break;case"circle":this.definition={cx:this.config.circle,cy:this.config.circle,r:this.config.circle};break;case"ellipse":Array.isArray(this.config.ellipse)?this.definition={cx:this.config.ellipse[0],cy:this.config.ellipse[1],rx:this.config.ellipse[0],ry:this.config.ellipse[1]}:this.definition={cx:this.config.ellipse.rx,cy:this.config.ellipse.ry,rx:this.config.ellipse.rx,ry:this.config.ellipse.ry};break;case"path":this.definition={d:this.config.path}}Object.entries(this.definition).forEach((([t,i])=>{e.setAttributeNS(null,t,i)})),this.config.svgStyle?Object.entries(this.config.svgStyle).forEach((([t,i])=>{e.setAttributeNS(null,G.dasherize(t),i)})):e.setAttributeNS(null,"fill","rgba(0,0,0,0.5)")}},Ro=G.getConfigParser({clickEventOnMarker:!1,gotoMarkerSpeed:"8rpm",markers:null,defaultHoverScale:null},{defaultHoverScale:t=>t?(!0===t&&(t=oo),"number"==typeof t&&(t={amount:t}),{...oo,...t}):null}),No=t("M",class extends Bi{constructor(t,e){super(t,e),this.markers={},this.state={allVisible:!0,showAllTooltips:!1,currentMarker:null,hoveringMarker:null,needsReRender:!1,lastClientX:null,lastClientY:null},this.container=document.createElement("div"),this.container.className="psv-markers",this.viewer.container.appendChild(this.container),this.container.addEventListener("contextmenu",(t=>t.preventDefault())),this.svgContainer=document.createElementNS(Js,"svg"),this.svgContainer.setAttribute("class","psv-markers-svg-container"),this.container.appendChild(this.svgContainer),this.css3DContainer=new mo(t),this.container.appendChild(this.css3DContainer.element),this.container.addEventListener("mouseenter",this,!0),this.container.addEventListener("mouseleave",this,!0),this.container.addEventListener("mousemove",this,!0)}init(){super.init(),G.checkStylesheet(this.viewer.container,"markers-plugin"),this.viewer.addEventListener(he.ClickEvent.type,this),this.viewer.addEventListener(he.DoubleClickEvent.type,this),this.viewer.addEventListener(he.RenderEvent.type,this),this.viewer.addEventListener(he.ConfigChangedEvent.type,this),this.viewer.addEventListener(he.ObjectEnterEvent.type,this),this.viewer.addEventListener(he.ObjectHoverEvent.type,this),this.viewer.addEventListener(he.ObjectLeaveEvent.type,this),this.viewer.addEventListener(he.ReadyEvent.type,this,{once:!0})}destroy(){this.clearMarkers(!1),this.viewer.unobserveObjects(to),this.viewer.removeEventListener(he.ClickEvent.type,this),this.viewer.removeEventListener(he.DoubleClickEvent.type,this),this.viewer.removeEventListener(he.RenderEvent.type,this),this.viewer.removeEventListener(he.ObjectEnterEvent.type,this),this.viewer.removeEventListener(he.ObjectHoverEvent.type,this),this.viewer.removeEventListener(he.ObjectLeaveEvent.type,this),this.viewer.removeEventListener(he.ReadyEvent.type,this),this.css3DContainer.destroy(),this.viewer.container.removeChild(this.container),super.destroy()}handleEvent(t){switch(t.type){case he.ReadyEvent.type:this.config.markers&&(this.setMarkers(this.config.markers),delete this.config.markers);break;case he.RenderEvent.type:this.renderMarkers();break;case he.ClickEvent.type:this.__onClick(t,!1);break;case he.DoubleClickEvent.type:this.__onClick(t,!0);break;case he.ObjectEnterEvent.type:case he.ObjectLeaveEvent.type:case he.ObjectHoverEvent.type:if(t.userDataKey===to){const e=t.originalEvent,i=t.object.userData[to];switch(t.type){case he.ObjectEnterEvent.type:i.config.style?.cursor?this.viewer.setCursor(i.config.style.cursor):(i.config.tooltip||i.config.content)&&this.viewer.setCursor("pointer"),this.__onEnterMarker(e,i);break;case he.ObjectLeaveEvent.type:this.viewer.setCursor(null),this.__onLeaveMarker(i);break;case he.ObjectHoverEvent.type:this.__onHoverMarker(e,i)}}break;case"mouseenter":{const e=this.__getTargetMarker(G.getEventTarget(t));this.__onEnterMarker(t,e);break}case"mouseleave":{const e=this.__getTargetMarker(G.getEventTarget(t));this.__onLeaveMarker(e);break}case"mousemove":{const e=this.__getTargetMarker(G.getEventTarget(t),!0);this.__onHoverMarker(t,e);break}}}toggleAllMarkers(){this.state.allVisible?this.hideAllMarkers():this.showAllMarkers()}showAllMarkers(){this.state.allVisible=!0,Object.values(this.markers).forEach((t=>{t.config.visible=!0})),this.renderMarkers(),this.dispatchEvent(new Xs)}hideAllMarkers(){this.state.allVisible=!1,Object.values(this.markers).forEach((t=>{t.config.visible=!1})),this.renderMarkers(),this.dispatchEvent(new Ws)}toggleAllTooltips(){this.state.showAllTooltips?this.hideAllTooltips():this.showAllTooltips()}showAllTooltips(){this.state.showAllTooltips=!0,Object.values(this.markers).forEach((t=>{t.state.staticTooltip=!0,t.showTooltip()}))}hideAllTooltips(){this.state.showAllTooltips=!1,Object.values(this.markers).forEach((t=>{t.state.staticTooltip=!1,t.hideTooltip()}))}getNbMarkers(){return Object.keys(this.markers).length}getMarkers(){return Object.values(this.markers)}addMarker(t,e=!0){if(this.markers[t.id])throw new St(`marker "${t.id}" already exists`);const i=new(function(t){switch(fo(t,!1)){case"image":case"html":case"element":return Do;case"imageLayer":case"videoLayer":return Oo;case"elementLayer":return Io;case"polygon":case"polyline":case"polygonPixels":case"polylinePixels":return Ao;case"square":case"rect":case"circle":case"ellipse":case"path":return Ho;default:throw new St("invalid marker type")}}(t))(this.viewer,this,t);i.isPoly()?this.svgContainer.appendChild(i.domElement):i.isCss3d()?this.css3DContainer.addObject(i):i.is3d()?this.viewer.renderer.addObject(i.threeElement):this.container.appendChild(i.domElement),this.markers[i.id]=i,this.state.showAllTooltips&&(i.state.staticTooltip=!0),e&&this.__afterChangeMarkers()}getMarker(t){const e="object"==typeof t?t.id:t;if(!this.markers[e])throw new St(`cannot find marker "${e}"`);return this.markers[e]}getCurrentMarker(){return this.state.currentMarker}updateMarker(t,e=!0){const i=this.getMarker(t.id);i.update(t),e&&(this.__afterChangeMarkers(),(i===this.state.hoveringMarker&&"hover"===i.config.tooltip?.trigger||i.state.staticTooltip)&&i.showTooltip(this.state.lastClientX,this.state.lastClientY,!0))}removeMarker(t,e=!0){const i=this.getMarker(t);i.isPoly()?this.svgContainer.removeChild(i.domElement):i.isCss3d()?this.css3DContainer.removeObject(i):i.is3d()?this.viewer.renderer.removeObject(i.threeElement):this.container.removeChild(i.domElement),this.state.hoveringMarker===i&&(this.state.hoveringMarker=null),this.state.currentMarker===i&&(this.state.currentMarker=null),i.destroy(),delete this.markers[i.id],e&&this.__afterChangeMarkers()}removeMarkers(t,e=!0){t.forEach((t=>this.removeMarker(t,!1))),e&&this.__afterChangeMarkers()}setMarkers(t,e=!0){this.clearMarkers(!1),t?.forEach((t=>{this.addMarker(t,!1)})),e&&this.__afterChangeMarkers()}clearMarkers(t=!0){Object.keys(this.markers).forEach((t=>{this.removeMarker(t,!1)})),t&&this.__afterChangeMarkers()}gotoMarker(t,e=this.config.gotoMarkerSpeed){const i=this.getMarker(t);return e?this.viewer.animate({...i.state.position,zoom:i.config.zoomLvl,speed:e}).then((()=>{this.dispatchEvent(new Os(i))})):(this.viewer.rotate(i.state.position),G.isNil(i.config.zoomLvl)||this.viewer.zoom(i.config.zoomLvl),this.dispatchEvent(new Os(i)),Promise.resolve())}hideMarker(t){this.toggleMarker(t,!1)}showMarker(t){this.toggleMarker(t,!0)}showMarkerTooltip(t){const e=this.getMarker(t);e.state.staticTooltip=!0,e.showTooltip()}hideMarkerTooltip(t){const e=this.getMarker(t);e.state.staticTooltip=!1,e.hideTooltip()}toggleMarker(t,e){const i=this.getMarker(t);i.config.visible=G.isNil(e)?!i.config.visible:e,this.renderMarkers()}showMarkerPanel(t){const e=this.getMarker(t);e.config.content?this.viewer.panel.show({id:io,content:e.config.content}):this.hideMarkerPanel()}hideMarkerPanel(){this.viewer.panel.hide(io)}toggleMarkersList(){this.viewer.panel.isVisible(so)?this.hideMarkersList():this.showMarkersList()}showMarkersList(){let t=[];Object.values(this.markers).forEach((e=>{e.config.visible&&!e.config.hideList&&t.push(e)}));const e=new qs(t);this.dispatchEvent(e),t=e.markers,this.viewer.panel.show({id:so,content:no(t,this.viewer.config.lang[Gs.id]),noMargin:!0,clickHandler:t=>{const e=G.getClosest(t,".psv-panel-menu-item"),i=e?e.dataset[to]:void 0;if(i){const t=this.getMarker(i);this.dispatchEvent(new Vs(t)),this.gotoMarker(t.id),this.hideMarkersList()}}})}hideMarkersList(){this.viewer.panel.hide(so)}renderMarkers(){if(this.state.needsReRender)return void(this.state.needsReRender=!1);const t=this.viewer.getZoomLevel(),e=this.viewer.getPosition(),i=this.state.hoveringMarker;Object.values(this.markers).forEach((s=>{let o=s.config.visible,n=!1,r=null;o&&(r=s.render({viewerPosition:e,zoomLevel:t,hoveringMarker:i}),o=!!r),n=s.state.visible!==o,s.state.visible=o,s.state.position2D=r,s.domElement&&G.toggleClass(s.domElement,"psv-marker--visible",o),o?s.state.staticTooltip?s.showTooltip():s!==this.state.hoveringMarker&&s.hideTooltip():s.hideTooltip(),n&&(this.dispatchEvent(new zs(s,o)),(s.is3d()||s.isCss3d())&&(this.state.needsReRender=!0))})),this.state.needsReRender&&this.viewer.needsUpdate()}__getTargetMarker(t,e=!1){if(t instanceof Node){const i=e?G.getClosest(t,".psv-marker"):t;return i?i[to]:void 0}return Array.isArray(t)?t.map((t=>t.userData[to])).filter((t=>!!t)).sort(((t,e)=>e.config.zIndex-t.config.zIndex))[0]:null}__onEnterMarker(t,e){e&&(this.state.hoveringMarker=e,this.state.lastClientX=t.clientX,this.state.lastClientY=t.clientY,this.dispatchEvent(new Hs(e)),e instanceof bo&&e.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!0}),e.state.staticTooltip||"hover"!==e.config.tooltip?.trigger||e.showTooltip(t.clientX,t.clientY))}__onLeaveMarker(t){t&&(this.dispatchEvent(new Ds(t)),t instanceof bo&&t.applyScale({zoomLevel:this.viewer.getZoomLevel(),viewerPosition:this.viewer.getPosition(),mouseover:!1}),this.state.hoveringMarker=null,t.state.staticTooltip||"hover"!==t.config.tooltip?.trigger?t.state.staticTooltip&&t.showTooltip():t.hideTooltip())}__onHoverMarker(t,e){e&&(this.state.lastClientX=t.clientX,this.state.lastClientY=t.clientY,(e.isPoly()||e.is3d()||e.isCss3d())&&"hover"===e.config.tooltip?.trigger&&e.showTooltip(t.clientX,t.clientY))}__onClick(t,e){const i=this.__getTargetMarker(t.data.objects),s=this.__getTargetMarker(t.data.target,!0)||i;this.state.currentMarker&&this.state.currentMarker!==s&&(this.dispatchEvent(new $s(this.state.currentMarker)),this.viewer.panel.hide(io),this.state.showAllTooltips||"click"!==this.state.currentMarker.config.tooltip?.trigger||this.hideMarkerTooltip(this.state.currentMarker.id),this.state.currentMarker=null),s&&(this.state.currentMarker=s,this.dispatchEvent(new Ns(s,e,t.data.rightclick)),this.config.clickEventOnMarker?t.data.marker=s:t.stopImmediatePropagation(),this.markers[s.id]&&!t.data.rightclick&&("click"===s.config.tooltip?.trigger?s.tooltip?this.hideMarkerTooltip(s.id):this.showMarkerTooltip(s.id):this.showMarkerPanel(s.id)))}__afterChangeMarkers(){this.__refreshUi(),this.__checkObjectsObserver(),this.viewer.needsUpdate(),this.dispatchEvent(new Zs(this.getMarkers()))}__refreshUi(){const t=Object.values(this.markers).filter((t=>!t.config.hideList)).length;0===t?(this.viewer.panel.hide(io),this.viewer.panel.hide(so)):this.viewer.panel.isVisible(so)?this.showMarkersList():this.viewer.panel.isVisible(io)&&(this.state.currentMarker?this.showMarkerPanel(this.state.currentMarker.id):this.viewer.panel.hide()),this.viewer.navbar.getButton(Gs.id,!1)?.toggle(t>0),this.viewer.navbar.getButton(ro.id,!1)?.toggle(t>0)}__checkObjectsObserver(){Object.values(this.markers).some((t=>t.is3d()))?this.viewer.observeObjects(to):this.viewer.unobserveObjects(to)}});No.id="markers",No.VERSION="5.13.2",No.configParser=Ro,No.readonlyOptions=["markers"],Ki.lang[Gs.id]="Markers",Ki.lang[ro.id]="Markers list",is(Gs,"caption:left"),is(ro,"caption:left");
/*!
 * Photo Sphere Viewer / Map Plugin 5.13.2
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */
var jo=Object.defineProperty;((t,e)=>{for(var i in e)jo(t,i,{get:e[i],enumerable:!0})})({},{SelectHotspot:()=>Uo,ViewChanged:()=>Fo});var Vo=class t extends le{constructor(e){super(t.type),this.hotspotId=e}};Vo.type="select-hotspot";var Uo=Vo,$o=class t extends le{constructor(e){super(t.type),this.view=e}};$o.type="view-changed";var Fo=$o,Wo="__marker__";function Yo(t,e,i){return{x:(Math.cos(-e)*t.x-Math.sin(-e)*t.y)*i,y:(Math.sin(-e)*t.x+Math.cos(-e)*t.y)*i}}function Zo(t,e,i,s,o="black"){t.shadowOffsetX=e*ki.pixelRatio,t.shadowOffsetY=i*ki.pixelRatio,t.shadowBlur=s*ki.pixelRatio,t.shadowColor=o}function Bo(t,e,i){const s=e.width,o=e.height;Xo(t,e,-i/2,-o/s*i/2,i,o/s*i)}function Xo(t,e,i,s,o,n){t.drawImage(e,0,0,e.width,e.height,i*ki.pixelRatio,s*ki.pixelRatio,o*ki.pixelRatio,n*ki.pixelRatio)}var Ko={top:"bottom",bottom:"top",left:"right",right:"left"},qo=class extends Li{constructor(t,e){super(t,{}),this.map=t,this.position=e}applyConfig(){this.container.className=`psv-map__button psv-map__button--${function(t,e){switch(e){case 1:return[Ko[t[0]],Ko[t[1]]];case 2:return[t[0],Ko[t[1]]];case 3:return[Ko[t[0]],t[1]];default:return t}}(this.map.config.position,this.position).join("-")}`,this.update()}update(){}},Go=class extends qo{constructor(t){super(t,0),this.container.addEventListener("click",(e=>{t.toggleCollapse(),e.stopPropagation()}))}applyConfig(){super.applyConfig(),this.container.classList.add("psv-map__button-close")}update(){this.container.innerHTML=this.map.collapsed?'<svg viewBox="114 45 472 472" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path d="M383.6 196a67.3 67.3 0 1 0-134.5.1 67.3 67.3 0 0 0 134.5-.1zm-100.8 0a33.6 33.6 0 1 1 67.3 0 33.6 33.6 0 0 1-67.3 0z"/><path d="M584 340.8a16.8 16.8 0 0 0-15.6-10.4H403.8c25.2-40.2 47-88 47-133.4A135 135 0 0 0 316.4 61.6 135 135 0 0 0 182 197c0 55.8 33 115.3 64.7 159.8L120.4 469a16.8 16.8 0 0 0 11.2 29.4H434c4.5 0 8.7-1.8 11.9-5l134.4-134.3c4.8-4.8 6.2-12 3.6-18.3zM215.5 197c0-56.1 45.2-101.8 100.8-101.8 55.6 0 100.8 45.6 100.8 101.8 0 65-57.1 144.2-100.8 192.8C273 341.7 215.6 262.3 215.6 197zM427 464.8H175.8l91.3-81.1a575.6 575.6 0 0 0 37.4 42.6 16.8 16.8 0 0 0 23.8 0c2.2-2.2 26.3-26.7 52.6-62.3h147z"/></g>\x3c!-- Created by Ayub Irawan from Noun Project --\x3e</svg>':A.ICONS.close,this.container.title=this.map.collapsed?this.viewer.config.lang.map:this.viewer.config.lang.close}},Qo=class extends qo{constructor(t){super(t,3),this.container.innerHTML='<svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg"><path d="M50,0L70,50L50,100L30,50Z M50,86L64,50L36,50Z" fill="currentColor"/></svg>',this.container.querySelector("svg").style.width="80%",this.container.addEventListener("click",(e=>{this.viewer.dynamics.position.goto({yaw:-t.config.rotation},2),e.stopPropagation()}))}rotate(t){this.container.querySelector("svg").style.transform=`rotate3d(0, 0, 1, ${-t}rad)`}update(){this.container.title=this.viewer.config.lang.mapNorth}},Jo={"bottom-left":0,"bottom-right":-90,"top-right":180,"top-left":90},tn=class extends qo{constructor(t){super(t,1),this.container.addEventListener("click",(e=>{t.toggleMaximized(),e.stopPropagation()}))}update(){this.container.innerHTML=this.map.maximized?'<svg viewBox="95 25 510 510" xmlns="http://www.w3.org/2000/svg"><path d="M109.8 25.8h481c7.8 0 14 6.1 14 14v481c0 7.8-6.2 14-14 14H358.4c-7.8 0-14-6.2-14-14s6.2-14 14-14h217.8v-453H123.8v216.7c0 7.8-6.2 14-14 14-7.9 0-14-6.2-14-14V39.8c0-7.9 6.1-14 14-14zm176.4 508.4H109.8c-7.9 0-14-6.1-14-14V343.8c0-7.8 6.1-14 14-14h176.4c7.8 0 14 6.2 14 14v176.4c0 7.9-6.8 14-14 14zm-14-176.4H123.8v148.4h148.4zm64.4-191.5c-7.9 0-14 6.2-14 14v113.1c0 7.9 6.1 14 14 14h113c8 0 14-6.1 14-14s-6-14-14-14h-79.4l141-141a13.5 13.5 0 0 0 0-19.7 13.5 13.5 0 0 0-19.5 0L350.6 259.8v-79.5c0-7.8-6.2-14-14-14z" fill="currentColor"/>\x3c!-- Created by Gregor Cresnar from Noun Project --\x3e</svg>':'<svg viewBox="95 25 510 510" xmlns="http://www.w3.org/2000/svg"><path d="M604.2 39.8v481c0 7.8-6.1 14-14 14H358.4c-7.8 0-14-6.2-14-14s6.2-14 14-14h217.8v-453H123.8v216.7c0 7.8-6.2 14-14 14-7.9 0-14-6.2-14-14V39.8c0-7.9 6.1-14 14-14h481c7.3 0 13.4 6.1 13.4 14zm-304 304v176.4c0 7.9-6.2 14-14 14H109.8c-7.9 0-14-6.1-14-14V343.8c0-7.8 6.1-14 14-14h176.4c7.2 0 14 6.8 14 14zm-28 14H123.8v148.4h148.4zm215.6-195.4v79.5c0 7.9 6.1 14 14 14 7.8 0 14-6.1 14-14V128.2c0-7.8-6.2-14-14-14H388.6c-7.8 0-14 6.2-14 14 0 7.9 6.2 14 14 14h79L326.5 283.4a13.5 13.5 0 0 0 0 19.6c2.8 2.8 6.1 3.9 10 3.9 4 0 7.3-1.1 10.1-4z" fill="currentColor"/>\x3c!-- Created by Gregor Cresnar from Noun Project --\x3e</svg>',this.container.querySelector("svg").style.transform=`rotate3d(0, 0, 1, ${Jo[this.map.config.position.join("-")]}deg)`,this.container.title=this.map.maximized?this.viewer.config.lang.mapMinimize:this.viewer.config.lang.mapMaximize}},en=class extends qo{constructor(t){super(t,2),this.container.innerHTML='<svg viewBox="170 100 360 360" xmlns="http://www.w3.org/2000/svg"><g fill="currentColor"><path d="M518.6 269h-18.5a150.8 150.8 0 0 0-138-137.9v-20.9c0-5.8-4.7-10.6-10.5-10.6h-3.2c-5.8 0-10.6 4.8-10.6 10.6v21A150.8 150.8 0 0 0 200 269h-18.5c-5.9 0-10.6 4.7-10.6 10.6v3.2c0 5.8 4.7 10.5 10.6 10.5h18.5c6 73.4 64.6 132 138 138v18.5c0 5.8 4.7 10.6 10.5 10.6h3.2c5.8 0 10.6-4.8 10.6-10.6v-18.6c73.3-5.9 132-64.5 137.9-137.9h18.5c5.9 0 10.6-4.7 10.6-10.5v-3.2c0-5.9-4.7-10.6-10.6-10.6zM362.2 414.4v-9.8c0-5.9-4.8-10.6-10.6-10.6h-3.2c-5.8 0-10.6 4.7-10.6 10.6v9.8a134 134 0 0 1-121-121h9.8c5.9 0 10.6-4.8 10.6-10.6v-3.2c0-5.9-4.7-10.6-10.6-10.6h-9.8a134 134 0 0 1 121-121v7.5c0 5.8 4.8 10.5 10.6 10.5h3.2c5.8 0 10.6-4.7 10.6-10.5V148a134 134 0 0 1 121 121h-9.8c-5.9 0-10.6 4.7-10.6 10.6v3.2c0 5.8 4.7 10.5 10.6 10.5h9.8a134 134 0 0 1-121 121z"/><path d="M355.4 222a6 6 0 0 0-10.7 0L291 320a8.3 8.3 0 0 0 9.7 12l39.2-11.7c6.6-2 13.6-2 20.2 0l39.2 11.7a8.3 8.3 0 0 0 9.7-12z"/></g>\x3c!-- Created by muhammad benani from Noun Project --\x3e</svg>',this.container.querySelector("svg").style.width="80%",this.container.addEventListener("click",(e=>{t.reset(),e.stopPropagation()}))}update(){this.container.title=this.viewer.config.lang.mapReset}},sn=class extends Li{constructor(t){super(t,{className:"psv-map__toolbar"}),this.map=t,this.handler=new G.PressHandler(100),this.container.innerHTML='<svg viewBox="128 58 444 444" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M350 58.2a221.8 221.8 0 1 0 0 443.6 221.8 221.8 0 0 0 0-443.6zm130.3 252.7H219.7a31 31 0 1 1 0-61.8h260.6a31 31 0 1 1 0 61.8z"/>\x3c!-- Created by Iconika from Noun Project --\x3e</svg><span class="psv-map__toolbar-text">100%</span><svg viewBox="143.8 73.8 412.5 412.5" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M350 73.8a206.2 206.2 0 1 0 0 412.4 206.2 206.2 0 0 0 0-412.4zm117.3 234H378v89.5a27.9 27.9 0 1 1-55.8 0V308h-89.4a27.9 27.9 0 1 1 0-55.8H322v-89.5a27.9 27.9 0 1 1 55.8 0v89.5h89.5a27.9 27.9 0 1 1 0 55.8z"/>\x3c!-- Created by Iconika from Noun Project --\x3e</svg>',this.zoomIndicator=this.container.querySelector(".psv-map__toolbar-text");const e=this.container.querySelectorAll("svg");e[0].dataset.delta="-1",e[1].dataset.delta="1",this.container.addEventListener("mousedown",this),window.addEventListener("mouseup",this),this.container.addEventListener("touchstart",this),window.addEventListener("touchend",this)}destroy(){window.removeEventListener("mouseup",this),window.removeEventListener("touchend",this),super.destroy()}handleEvent(t){switch(t.type){case"mousedown":case"touchstart":{const e=G.getMatchingTarget(t,"svg[data-delta]"),i=e?.dataset.delta;i&&(cancelAnimationFrame(this.animation),this.handler.down(),this.time=performance.now(),this.animateZoom(parseInt(i,10)),t.preventDefault(),t.stopPropagation());break}case"mouseup":case"touchend":this.animation&&(this.handler.up((()=>{cancelAnimationFrame(this.animation),this.animation=null})),t.preventDefault(),t.stopPropagation())}}setText(t){this.zoomIndicator.innerText=`${Math.round(100*Math.exp(t))}%`}animateZoom(t){this.animation=requestAnimationFrame((e=>{this.map.zoom(t*(e-this.time)/1e3),this.time=e,this.animateZoom(t)}))}},on=class extends Li{constructor(t,e){super(t,{className:`psv-map ${A.CAPTURE_EVENTS_CLASS}`}),this.plugin=e,this.state={visible:!1,maximized:!1,collapsed:!1,galleryWasVisible:!1,imgScale:1,zoom:this.config.defaultZoom,offset:{x:0,y:0},mouseX:null,mouseY:null,mousedown:!1,pinchDist:0,pinchAngle:0,hotspotPos:{},hotspotId:null,hotspotTooltip:null,markers:[],forceRender:!1,needsUpdate:!1,renderLoop:null,images:{}};const i=document.createElement("div");i.className="psv-map__container",i.addEventListener("mousedown",this),window.addEventListener("mousemove",this),window.addEventListener("mouseup",this),i.addEventListener("touchstart",this),window.addEventListener("touchmove",this),window.addEventListener("touchend",this),i.addEventListener("wheel",this),t.addEventListener(he.KeypressEvent.type,this),t.addEventListener(he.ConfigChangedEvent.type,this),this.canvas=document.createElement("canvas"),this.__setCursor("move"),i.appendChild(this.canvas),this.overlay=document.createElement("div"),this.overlay.className="psv-map__overlay",i.appendChild(this.overlay),this.container.appendChild(i),this.container.addEventListener("transitionstart",this),this.container.addEventListener("transitionend",this),this.config.buttons.reset&&(this.resetButton=new en(this)),this.config.buttons.maximize&&(this.maximizeButton=new tn(this)),this.config.buttons.close&&(this.closeButton=new Go(this)),this.config.buttons.north&&(this.compassButton=new Qo(this)),this.zoomToolbar=new sn(this);const s=()=>{this.isVisible()&&(this.state.needsUpdate||this.state.forceRender)&&(this.render(),this.state.needsUpdate=!1),this.state.renderLoop=requestAnimationFrame(s)};s(),this.applyConfig(),this.hide(),this.config.visibleOnLoad||this.toggleCollapse()}get config(){return this.plugin.config}get maximized(){return this.state.maximized}get collapsed(){return this.state.collapsed}init(){this.gallery=this.viewer.getPlugin("gallery"),this.gallery?.addEventListener("show-gallery",this),this.gallery?.addEventListener("hide-gallery",this)}destroy(){this.canvas.width=0,this.canvas.height=0,window.removeEventListener("touchmove",this),window.removeEventListener("mousemove",this),window.removeEventListener("touchend",this),window.removeEventListener("mouseup",this),this.viewer.removeEventListener(he.KeypressEvent.type,this),this.gallery?.removeEventListener("show-gallery",this),this.gallery?.removeEventListener("hide-gallery",this),cancelAnimationFrame(this.state.renderLoop),super.destroy()}handleEvent(t){if(!G.getMatchingTarget(t,`.${A.CAPTURE_EVENTS_CLASS}:not(.psv-map)`))switch(t.type){case he.KeypressEvent.type:this.state.maximized&&(this.__onKeyPress(t.key),t.preventDefault());break;case he.ConfigChangedEvent.type:t.containsOptions("lang")&&(this.resetButton?.update(),this.closeButton?.update(),this.compassButton?.update(),this.maximizeButton?.update());break;case"mousedown":{const e=t;this.state.mouseX=e.clientX,this.state.mouseY=e.clientY,this.state.mousedown=!0,t.stopPropagation();break}case"touchstart":{const e=t;1===e.touches.length?(this.state.mouseX=e.touches[0].clientX,this.state.mouseY=e.touches[0].clientY,this.state.mousedown=!0):2===e.touches.length&&({distance:this.state.pinchDist,angle:this.state.pinchAngle,center:{x:this.state.mouseX,y:this.state.mouseY}}=G.getTouchData(e)),t.stopPropagation(),t.preventDefault();break}case"mousemove":{const e=t;this.state.mousedown?(this.__move(e.clientX,e.clientY),t.stopPropagation()):t.composedPath().includes(this.canvas)&&this.__handleHotspots(e.clientX,e.clientY);break}case"touchmove":{const e=t;if(this.state.mousedown&&1===e.touches.length)this.__move(e.touches[0].clientX,e.touches[0].clientY),t.stopPropagation();else if(this.state.mousedown&&2===e.touches.length){const i=G.getTouchData(e),s=(i.distance-this.state.pinchDist)/ki.pixelRatio;this.zoom(s/100),this.__move(i.center.x,i.center.y),this.state.maximized&&!this.config.static&&this.viewer.dynamics.position.step({yaw:this.state.pinchAngle-i.angle},0),({distance:this.state.pinchDist,angle:this.state.pinchAngle}=i),t.stopPropagation()}break}case"mouseup":case"touchend":{const e=t.changedTouches?.[0]||t;this.state.mousedown&&(this.state.mousedown=!1,t.stopPropagation()),t.composedPath().includes(this.canvas)&&this.__clickHotspot(e.clientX,e.clientY);break}case"wheel":{const e=t,i=e.deltaY/Math.abs(e.deltaY);e.ctrlKey?this.viewer.dynamics.position.step({yaw:i/10}):this.zoom(-i/10),t.stopPropagation(),t.preventDefault();break}case"transitionstart":this.state.forceRender=!0;break;case"transitionend":this.state.maximized||(this.overlay.style.display="",this.recenter()),this.state.forceRender=!1,this.update();break;case"hide-gallery":this.__onToggleGallery(!1);break;case"show-gallery":t.fullscreen||this.__onToggleGallery(!0)}}applyConfig(){var t;this.container.classList.remove("psv-map--top-right","psv-map--top-left","psv-map--bottom-right","psv-map--bottom-left","psv-map--round","psv-map--square"),this.container.classList.add(`psv-map--${this.config.position.join("-")}`),this.container.classList.add(`psv-map--${this.config.shape}`),this.container.style.width=this.config.size,this.container.style.height=this.config.size,this.overlay.innerHTML=null===this.config.overlayImage?"":(t=this.config.overlayImage??("square"===this.config.shape?'<svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">\n    <defs>\n        <linearGradient id="gradient">\n            <stop offset="5%" stop-color="rgba(255, 255, 255, .5)"/>\n            <stop offset="10%" stop-color="rgba(255, 255, 255, 0)"/>\n            <stop offset="90%" stop-color="rgba(255, 255, 255, 0)"/>\n            <stop offset="95%" stop-color="rgba(255, 255, 255, .5)"/>\n        </linearGradient>\n        <linearGradient id="gradient2" x1="0" x2="0" y1="0" y2="1">\n            <stop offset="5%" stop-color="rgba(255, 255, 255, .5)"/>\n            <stop offset="10%" stop-color="rgba(255, 255, 255, 0)"/>\n            <stop offset="90%" stop-color="rgba(255, 255, 255, 0)"/>\n            <stop offset="95%" stop-color="rgba(255, 255, 255, .5)"/>\n        </linearGradient>\n    </defs>=\n    <rect x="0" y="0" width="500" height="500" fill="url(#gradient)"/>\n    <rect x="0" y="0" width="500" height="500" fill="url(#gradient2)"/>\n    <rect x="5" y="5" width="490" height="490" fill="none" stroke="rgba(255, 255, 255, 0.8)" stroke-width="10"/>\n    <g fill="#222">\n        <rect x="1" y="248" width="18" height="4"/>\n        <rect x="481" y="248" width="18" height="4"/>\n        <rect x="248" y="1" width="4" height="18"/>\n        <rect x="248" y="481" width="4" height="18"/>\n    </g>\n</svg>':'<svg viewBox="0 0 500 500" xmlns="http://www.w3.org/2000/svg">\n    <defs>\n        <radialGradient id="gradient">\n            <stop offset="80%" stop-color="rgba(255, 255, 255, 0)"/>\n            <stop offset="90%" stop-color="rgba(255, 255, 255, .5)"/>\n        </radialGradient>\n    </defs>\n    <circle cx="250" cy="250" r="250" fill="url(#gradient)"/>\n    <circle cx="250" cy="250" r="245" fill="none" stroke="rgba(255, 255, 255, 0.8)" stroke-width="10"/>\n    <g fill="#222">\n        <rect x="1" y="248" width="18" height="4"/>\n        <rect x="481" y="248" width="18" height="4"/>\n        <rect x="248" y="1" width="4" height="18"/>\n        <rect x="248" y="481" width="4" height="18"/>\n    </g>\n</svg>'))?t.includes("<svg")?t:`<img src="${t}">`:"",this.resetButton?.applyConfig(),this.closeButton?.applyConfig(),this.compassButton?.applyConfig(),this.maximizeButton?.applyConfig(),this.config.static&&(this.compassButton?.rotate(0),this.overlay.style.transform=""),"square"===this.config.shape&&(this.overlay.style.transform=""),this.update()}isVisible(){return this.state.visible&&!this.state.collapsed}show(){super.show(),this.update(),this.state.maximized||(this.overlay.style.display="")}hide(){super.hide(),this.state.forceRender=!1}update(t=!0){this.state.needsUpdate=!0,t&&(this.state.hotspotPos={},this.__resetHotspot())}reload(t){delete this.state.images[this.config.imageUrl],this.config.imageUrl=t,this.state.imgScale=1,this.__loadImage(this.config.imageUrl,!0),this.recenter()}reset(){this.state.zoom=this.config.defaultZoom,this.recenter()}recenter(){this.state.offset.x=0,this.state.offset.y=0,this.update()}toggleCollapse(){this.state.maximized&&this.toggleMaximized(!1),this.state.collapsed=!this.state.collapsed,G.toggleClass(this.container,"psv-map--collapsed",this.state.collapsed),this.state.collapsed?this.plugin.dispatchEvent(new Fo("closed")):(this.reset(),this.plugin.dispatchEvent(new Fo("normal"))),this.closeButton?.update()}toggleMaximized(t=!0){this.state.collapsed||(this.state.maximized=!this.state.maximized,G.toggleClass(this.container,"psv-map--maximized",this.state.maximized),this.state.maximized?(this.state.galleryWasVisible=this.gallery?.isVisible(),this.gallery?.hide(),this.overlay.style.display="none",this.plugin.dispatchEvent(new Fo("maximized"))):(this.state.galleryWasVisible&&this.gallery.show(),t&&this.plugin.dispatchEvent(new Fo("normal"))),this.maximizeButton?.update())}zoom(t){this.setZoom(this.state.zoom+t)}setZoom(t){this.state.zoom=i.clamp(t,this.config.minZoom,this.config.maxZoom),this.update()}setMarkers(t){this.state.markers=t,this.update()}setActiveHotspot(t){this.state.hotspotId=t,this.update(!1)}render(){if(!this.config.center)return;const t=this.__loadImage(this.config.imageUrl);if(!t)return;const e=this.viewer.getPosition().yaw,s=Math.exp(this.state.zoom)/this.state.imgScale,o=this.config.center.x*this.state.imgScale,n=this.config.center.y*this.state.imgScale,r={x:this.state.offset.x*this.state.imgScale,y:this.state.offset.y*this.state.imgScale},a=this.config.rotation,h=this.config.static?0:e+a;this.config.static||("round"===this.config.shape&&(this.overlay.style.transform=`rotate(${-h}rad)`),this.compassButton?.rotate(h)),this.zoomToolbar.setText(this.state.zoom),this.canvas.width=this.container.clientWidth*ki.pixelRatio,this.canvas.height=this.container.clientHeight*ki.pixelRatio;const l=G.getPosition(this.canvas),c=this.canvas.width,d=this.canvas.height,p=c/2/ki.pixelRatio,u=d/2/ki.pixelRatio,v=this.canvas.getContext("2d");v.clearRect(0,0,c,d);const m=t.width,g=t.height;v.save(),v.translate(c/2,d/2),v.rotate(-h),v.scale(s,s),Zo(v,0,0,10),Xo(v,t,-o-r.x,-n-r.y,m,g),v.restore(),[...this.config.hotspots,...this.state.markers].sort(((t,e)=>this.state.hotspotId===t.id?1:this.state.hotspotId===e.id?-1:(t.zIndex??0)-(e.zIndex??0))).forEach((t=>{const e=this.state.hotspotId===t.id,i=function(t,e,i){return{image:i?e.hoverImage??e.image??t.hoverImage??t.image:e.image??t.image,size:i?e.hoverSize??e.size??t.hoverSize??t.size:e.size??t.size,color:i?e.hoverColor??e.color??t.hoverColor??t.color:e.color??t.color,borderColor:i?e.hoverBorderColor??e.borderColor??t.hoverBorderColor??t.borderColor:e.borderColor??t.borderColor,borderSize:i?e.hoverBorderSize??e.borderSize??t.hoverBorderSize??t.borderSize:e.borderSize??t.borderSize}}(this.config.spotStyle,t,e),c=this.__loadImage(i.image),d={...r};if("yaw"in t&&"distance"in t){const e=G.parseAngle(t.yaw)+a;d.x+=Math.sin(-e)*t.distance*this.state.imgScale,d.y+=Math.cos(-e)*t.distance*this.state.imgScale}else{if(!("x"in t)||!("y"in t))return void G.logWarn(`Hotspot ${t.id} is missing position (yaw+distance or x+y)`);d.x+=o-t.x*this.state.imgScale,d.y+=n-t.y*this.state.imgScale}const m=Yo(d,h,s),g=p-m.x,f=u-m.y;this.state.hotspotPos[t.id]={x:g+l.x,y:f+l.y,s:i.size},v.save(),v.translate(g*ki.pixelRatio,f*ki.pixelRatio),Zo(v,2,2,4),c?Bo(v,c,i.size):(v.fillStyle=i.color,v.beginPath(),v.arc(0,0,i.size*ki.pixelRatio/2,0,2*Math.PI),v.fill(),i.borderColor&&i.borderSize&&(v.shadowColor="transparent",v.strokeStyle=i.borderColor,v.lineWidth=i.borderSize,v.beginPath(),v.arc(0,0,(i.size+i.borderSize)*ki.pixelRatio/2,0,2*Math.PI),v.stroke())),v.restore()}));const f=this.__loadImage(this.config.pinImage);if(f||this.config.coneColor&&this.config.coneSize){const t=Yo(r,h,s),o=p-t.x,n=u-t.y,l=this.config.pinSize,c=this.config.static?e+a:0;if(v.save(),v.translate(o*ki.pixelRatio,n*ki.pixelRatio),v.rotate(c),this.config.coneColor&&this.config.coneSize){const t=i.degToRad(this.viewer.state.hFov),e=-Math.PI/2-t/2,s=e+t,o=this.config.coneSize*ki.pixelRatio,n=v.createRadialGradient(0,0,o/4,0,0,o);n.addColorStop(0,this.config.coneColor),n.addColorStop(1,(w=this.config.coneColor,y=0,`rgba(${w.slice(4,-1)},${y})`)),v.beginPath(),v.moveTo(0,0),v.lineTo(Math.cos(e)*o,Math.sin(e)*o),v.arc(0,0,o,e,s,!1),v.lineTo(0,0),v.fillStyle=n,v.fill()}f&&(Zo(v,2,2,4),Bo(v,f,l)),v.restore()}var w,y}__move(t,e){const i=this.viewer.getPosition().yaw,s=Math.exp(this.state.zoom),o=function(t,e,i){return{x:(Math.cos(e)*t.x-Math.sin(e)*t.y)/i,y:(Math.sin(e)*t.x+Math.cos(e)*t.y)/i}}({x:this.state.mouseX-t,y:this.state.mouseY-e},this.config.static?0:i+this.config.rotation,s);this.state.offset.x+=o.x,this.state.offset.y+=o.y,this.update(),this.state.mouseX=t,this.state.mouseY=e}__findHotspot(t,e){const i=this.config.spotStyle.size/2;let s=null;for(const[o,{x:n,y:r}]of Object.entries(this.state.hotspotPos))if(t>n-i&&t<n+i&&e>r-i&&e<r+i){s=o;break}return s}__handleHotspots(t,e){const i=this.__findHotspot(t,e);if(this.state.hotspotId!==i){if(this.__resetHotspot(),i){let t;if(t=i.startsWith(Wo)?this.state.markers.find((({id:t})=>t===i))?.tooltip:this.config.hotspots.find((({id:t})=>t===i))?.tooltip,t){"string"==typeof t&&(t={content:t});const e=this.state.hotspotPos[i],s=G.getPosition(this.viewer.container);this.state.hotspotTooltip=this.viewer.createTooltip({content:t.content,className:t.className,left:e.x-s.x,top:e.y-s.y,box:{width:e.s,height:e.s}})}}this.setActiveHotspot(i),this.__setCursor(i?"pointer":"move")}}__clickHotspot(t,e){const i=this.__findHotspot(t,e);if(i){if(this.plugin.dispatchEvent(new Uo(i)),i.startsWith(Wo)){const t=i.substring(10);this.viewer.getPlugin("markers").gotoMarker(t)}this.maximized&&this.config.minimizeOnHotspotClick&&this.toggleMaximized()}this.__resetHotspot()}__resetHotspot(){this.state.hotspotTooltip?.hide(),this.state.hotspotTooltip=null,this.state.hotspotId=null}__loadImage(t,e=!1){if(!t)return null;if(!this.state.images[t]){const i=function(t){const e=document.createElement("img");if(t.includes("<svg")){if(!/<svg[^>]*width="/.test(t)&&t.includes("viewBox")){const[,,,e,i]=/viewBox="([0-9-]+) ([0-9-]+) ([0-9]+) ([0-9]+)"/.exec(t);t=t.replace("<svg",`<svg width="${e}px" height="${i}px"`)}const i=`data:image/svg+xml;base64,${window.btoa(t)}`;e.src=i}else e.src=t;return e}(t);return this.state.images[t]={loading:!0,value:i},i.onload=()=>{if(e&&Math.max(i.width,i.height)>ki.maxCanvasWidth){this.state.imgScale=ki.maxCanvasWidth/Math.max(i.width,i.height);const e=document.createElement("canvas");e.width=i.width*this.state.imgScale,e.height=i.height*this.state.imgScale,e.getContext("2d").drawImage(i,0,0,e.width,e.height),this.state.images[t].value=e}this.state.images[t].loading=!1,this.update(!1),e&&this.show()},null}return this.state.images[t].loading?null:this.state.images[t].value}__onKeyPress(t){if(t===A.KEY_CODES.Escape)return void this.toggleMaximized();if(!this.viewer.state.keyboardEnabled)return;let e=0,i=0,s=0;switch(t){case A.KEY_CODES.ArrowUp:i=1;break;case A.KEY_CODES.ArrowDown:i=-1;break;case A.KEY_CODES.ArrowLeft:e=1;break;case A.KEY_CODES.ArrowRight:e=-1;break;case A.KEY_CODES.Plus:s=1;break;case A.KEY_CODES.Minus:s=-1;break;case A.KEY_CODES.PageUp:s=1;break;case A.KEY_CODES.PageDown:s=-1}(e||i)&&(this.state.mouseX=0,this.state.mouseY=0,this.__move(10*e,10*i)),s&&this.zoom(s/10)}__setCursor(t){this.canvas.style.cursor=t}__onToggleGallery(t){this.container.style.marginBottom=t?this.viewer.container.querySelector(".psv-gallery").offsetHeight+10+"px":""}},nn=G.getConfigParser({imageUrl:null,center:null,rotation:0,shape:"round",size:"200px",position:["bottom","left"],visibleOnLoad:!0,overlayImage:void 0,pinImage:'<svg viewBox="-20 -20 740 740" xmlns="http://www.w3.org/2000/svg">\n    <circle cx="350" cy="350" r="190" fill="white"/>\n    <circle cx="350" cy="350" r="150" fill="#1E78E6"/>\n</svg>\n',pinSize:35,coneColor:"#1E78E6",coneSize:40,spotStyle:{size:15,image:null,color:"white",borderSize:0,borderColor:null,hoverSize:null,hoverImage:null,hoverColor:null,hoverBorderSize:4,hoverBorderColor:"rgba(255, 255, 255, 0.6)"},static:!1,defaultZoom:100,minZoom:20,maxZoom:200,hotspots:[],minimizeOnHotspotClick:!0,buttons:{maximize:!0,close:!0,reset:!0,north:!0}},{spotStyle:(t,{defValue:e})=>({...e,...t}),position:(t,{defValue:e})=>G.cleanCssPosition(t,{allowCenter:!1,cssOrder:!0})||e,rotation:t=>G.parseAngle(t),coneColor:t=>t?new P(t).getStyle():null,defaultZoom:t=>Math.log(t/100),maxZoom:t=>Math.log(t/100),minZoom:t=>Math.log(t/100),buttons:(t,{defValue:e})=>({...e,...t})}),rn=class extends Bi{constructor(t,e){super(t,e),this.component=new on(this.viewer,this)}init(){super.init(),G.checkStylesheet(this.viewer.container,"map-plugin"),this.component.init(),this.markers=this.viewer.getPlugin("markers"),this.viewer.addEventListener(he.PositionUpdatedEvent.type,this),this.viewer.addEventListener(he.ZoomUpdatedEvent.type,this),this.viewer.addEventListener(he.SizeUpdatedEvent.type,this),this.viewer.addEventListener(he.ReadyEvent.type,this,{once:!0}),this.markers?.addEventListener("set-markers",this),this.setHotspots(this.config.hotspots,!1)}destroy(){this.viewer.removeEventListener(he.PositionUpdatedEvent.type,this),this.viewer.removeEventListener(he.ZoomUpdatedEvent.type,this),this.viewer.removeEventListener(he.SizeUpdatedEvent.type,this),this.viewer.removeEventListener(he.ReadyEvent.type,this),this.markers?.removeEventListener("set-markers",this),this.component.destroy(),delete this.markers,super.destroy()}handleEvent(t){switch(t.type){case he.ReadyEvent.type:this.component.reload(this.config.imageUrl);break;case he.PositionUpdatedEvent.type:case he.ZoomUpdatedEvent.type:this.component.update();break;case he.SizeUpdatedEvent.type:this.component.maximized&&this.component.update();break;case"set-markers":this.component.setMarkers(this.__markersToHotspots(t.markers))}}setOptions(t){super.setOptions(t),t.center&&this.component.recenter(),void 0!==t.hotspots&&this.setHotspots(t.hotspots),this.component.applyConfig()}hide(){this.component.hide()}show(){this.component.show()}setZoom(t){this.component.setZoom(Math.log(t/100))}close(){this.component.collapsed||this.component.toggleCollapse()}open(){this.component.collapsed&&this.component.toggleCollapse()}minimize(){this.component.maximized&&this.component.toggleMaximized()}maximize(){this.component.maximized||this.component.toggleMaximized()}setImage(t,e,i){G.isNil(i)||(this.config.rotation=G.parseAngle(i)),G.isNil(e)||(this.config.center=e),this.component.reload(t)}setCenter(t){this.config.center=t,this.component.recenter()}setHotspots(t,e=!0){const i=[];let s=1;t?.forEach((t=>{t.id?i.includes(t.id)?G.logWarn(`Duplicated hotspot id "${t.id}`):i.push(t.id):t.id="__generated__"+s++})),this.config.hotspots=t||[],e&&this.component.update()}clearHotspots(){this.setHotspots(null)}setActiveHotspot(t){this.component.setActiveHotspot(t)}__markersToHotspots(t){return t.filter((t=>t.data?.map)).map((t=>{const e={...t.data.map,id:Wo+t.id,tooltip:t.config.tooltip};if("distance"in e)e.yaw=t.state.position.yaw;else if(!("x"in e)||!("y"in e))return G.logWarn(`Marker #${t.id} "map" data is missing position (distance or x+y)`),null;return e})).filter((t=>t))}};rn.id="map",rn.VERSION="5.13.2",rn.configParser=nn,rn.readonlyOptions=["imageUrl","visibleOnLoad","defaultZoom","buttons"],Ki.lang.map="Map",Ki.lang.mapMaximize="Maximize",Ki.lang.mapMinimize="Minimize",Ki.lang.mapNorth="Go to north",Ki.lang.mapReset="Reset";
/*!
 * Photo Sphere Viewer / Autorotate Plugin 5.13.2
 * @copyright 2015-2025 Damien "Mistic" Sorel
 * @licence MIT (https://opensource.org/licenses/MIT)
 */
var an=Object.defineProperty;((t,e)=>{for(var i in e)an(t,i,{get:e[i],enumerable:!0})})({},{AutorotateEvent:()=>ln});var hn=class t extends le{constructor(e){super(t.type),this.autorotateEnabled=e}};hn.type="autorotate";var ln=hn,cn=class extends zi{constructor(t){super(t,{className:"psv-autorotate-button",hoverScale:!0,collapsable:!0,tabbable:!0,icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 41 41" overflow="visible"><g fill="currentColor" transform-origin="center" transform="scale(1.3)"><path d="M40.5 14.1c-.1-.1-1.2-.5-2.899-1-.101 0-.2-.1-.2-.2C34.5 6.5 28 2 20.5 2S6.6 6.5 3.7 12.9c0 .1-.1.1-.2.2-1.7.6-2.8 1-2.9 1l-.6.3v12.1l.6.2c.1 0 1.1.4 2.7.9.1 0 .2.1.2.199C6.3 34.4 12.9 39 20.5 39c7.601 0 14.101-4.6 16.9-11.1 0-.101.1-.101.2-.2 1.699-.6 2.699-1 2.8-1l.6-.3V14.3l-.5-.2zM20.5 4c5.8 0 10.9 3 13.8 7.5.2.3-.1.6-.399.5-3.8-1-8.8-2-13.6-2-4.7 0-9.5 1-13.2 2-.3.1-.5-.2-.4-.5C9.7 7 14.8 4 20.5 4zm0 33c-5.9 0-11.1-3.1-14-7.899-.2-.301.1-.601.4-.5 3.9 1 8.9 2.1 13.6 2.1 5 0 9.9-1 13.601-2 .3-.1.5.2.399.5A16.422 16.422 0 0 1 20.5 37zm18.601-12.1c0 .1-.101.3-.2.3-2.5.9-10.4 3.6-18.4 3.6-7.1 0-15.6-2.699-18.3-3.6C2.1 25.2 2 25 2 24.9V16c0-.1.1-.3.2-.3 2.6-.9 10.6-3.6 18.2-3.6 7.5 0 15.899 2.7 18.5 3.6.1 0 .2.2.2.3v8.9z"/><path d="M18.7 24l6.4-3.7c.3-.2.3-.7 0-.8l-6.4-3.8c-.3-.2-.7 0-.7.4v7.4c0 .5.4.7.7.5z"/></g>\x3c!--Created by Nick Bluth from the Noun Project--\x3e</svg>\n',iconActive:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 41 41" overflow="visible"><g fill="currentColor" transform-origin="center" transform="scale(1.3)"><path d="M40.5 14.1c-.1-.1-1.2-.5-2.898-1-.102 0-.202-.1-.202-.2C34.5 6.5 28 2 20.5 2S6.6 6.5 3.7 12.9c0 .1-.1.1-.2.2-1.7.6-2.8 1-2.9 1l-.6.3v12.1l.6.2c.1 0 1.1.399 2.7.899.1 0 .2.101.2.199C6.3 34.4 12.9 39 20.5 39c7.602 0 14.102-4.6 16.9-11.1 0-.102.1-.102.199-.2 1.699-.601 2.699-1 2.801-1l.6-.3V14.3l-.5-.2zM6.701 11.5C9.7 7 14.8 4 20.5 4c5.8 0 10.9 3 13.8 7.5.2.3-.1.6-.399.5-3.799-1-8.799-2-13.6-2-4.7 0-9.5 1-13.2 2-.3.1-.5-.2-.4-.5zM25.1 20.3L18.7 24c-.3.2-.7 0-.7-.5v-7.4c0-.4.4-.6.7-.4l6.399 3.8c.301.1.301.6.001.8zm9.4 8.901A16.421 16.421 0 0 1 20.5 37c-5.9 0-11.1-3.1-14-7.898-.2-.302.1-.602.4-.5 3.9 1 8.9 2.1 13.6 2.1 5 0 9.9-1 13.602-2 .298-.1.5.198.398.499z"/></g>\x3c!--Created by Nick Bluth from the Noun Project--\x3e</svg>\n'}),this.plugin=this.viewer.getPlugin("autorotate"),this.plugin?.addEventListener(ln.type,this)}destroy(){this.plugin?.removeEventListener(ln.type,this),super.destroy()}isSupported(){return!!this.plugin}handleEvent(t){t instanceof ln&&this.toggleActive(t.autorotateEnabled)}onClick(){this.plugin.isEnabled()&&this.plugin.disableOnIdle(),this.plugin.toggle()}};cn.id="autorotate";var dn=G.getConfigParser({autostartDelay:2e3,autostartOnIdle:!0,autorotateSpeed:G.parseSpeed("2rpm"),autorotatePitch:null,autorotateZoomLvl:null,keypoints:null,startFromClosest:!0},{autostartOnIdle:(t,{rawConfig:e})=>t&&G.isNil(e.autostartDelay)?(G.logWarn("autostartOnIdle requires a non null autostartDelay"),!1):t,autorotateSpeed:t=>G.parseSpeed(t),autorotatePitch:t=>G.isNil(t)?null:G.parseAngle(t,!0),autorotateZoomLvl:t=>G.isNil(t)?null:i.clamp(t,0,100)});function pn(t){return[t.yaw,t.pitch]}var un=t("A",class extends Bi{constructor(t,e){super(t,e),this.state={initialStart:!0,disableOnIdle:!1,enabled:!1,idx:-1,curve:[],startStep:null,endStep:null,startTime:null,stepDuration:null,remainingPause:null,lastTime:null,tooltip:null},this.state.initialStart=!G.isNil(this.config.autostartDelay)}init(){super.init(),this.video=this.viewer.getPlugin("video"),this.markers=this.viewer.getPlugin("markers"),this.config.keypoints&&(this.setKeypoints(this.config.keypoints),delete this.config.keypoints),this.viewer.addEventListener(he.StopAllEvent.type,this),this.viewer.addEventListener(he.BeforeRenderEvent.type,this),this.video||this.viewer.addEventListener(he.KeypressEvent.type,this)}destroy(){this.viewer.removeEventListener(he.StopAllEvent.type,this),this.viewer.removeEventListener(he.BeforeRenderEvent.type,this),this.viewer.removeEventListener(he.KeypressEvent.type,this),delete this.video,delete this.markers,delete this.keypoints,super.destroy()}handleEvent(t){switch(t.type){case he.StopAllEvent.type:this.stop();break;case he.BeforeRenderEvent.type:this.__beforeRender(t.timestamp);break;case he.KeypressEvent.type:this.__onKeyPress(t.originalEvent)}}setKeypoints(t){if(t){if(t.length<2)throw new St("At least two points are required");this.keypoints=t.map(((t,e)=>{const i={position:null,markerId:null,pause:0,tooltip:null};let s;if("string"==typeof t?i.markerId=t:G.isExtendedPosition(t)?s=t:(i.markerId=t.markerId,i.pause=t.pause,s=t.position,t.tooltip&&"object"==typeof t.tooltip?i.tooltip=t.tooltip:"string"==typeof t.tooltip&&(i.tooltip={content:t.tooltip})),i.markerId){if(!this.markers)throw new St(`Keypoint #${e} references a marker but the markers plugin is not loaded`);const t=this.markers.getMarker(i.markerId);i.position=pn(t.state.position)}else{if(!s)throw new St(`Keypoint #${e} is missing marker or position`);i.position=pn(this.viewer.dataHelper.cleanPosition(s))}return i}))}else this.keypoints=null;this.isEnabled()&&(this.stop(),this.start())}isEnabled(){return this.state.enabled}start(){this.isEnabled()||(this.viewer.stopAll(),this.keypoints?this.config.startFromClosest&&this.__shiftKeypoints():this.__animate(),this.state.initialStart=!1,this.state.disableOnIdle=!1,this.state.enabled=!0,this.dispatchEvent(new ln(!0)))}stop(){this.isEnabled()&&(this.__hideTooltip(),this.__reset(),this.viewer.stopAnimation(),this.viewer.dynamics.position.stop(),this.viewer.dynamics.zoom.stop(),this.state.enabled=!1,this.dispatchEvent(new ln(!1)))}toggle(){this.isEnabled()?this.stop():this.start()}reverse(){this.isEnabled()&&!this.keypoints&&(this.config.autorotateSpeed=-this.config.autorotateSpeed,this.__animate())}disableOnIdle(){this.state.disableOnIdle=!0}__animate(){let t;t=G.isNil(this.config.autorotateZoomLvl)?Promise.resolve(!0):this.viewer.animate({zoom:this.config.autorotateZoomLvl,speed:2*this.viewer.config.zoomSpeed+"rpm"}),t.then((t=>{t&&(this.viewer.dynamics.position.roll({yaw:this.config.autorotateSpeed<0},Math.abs(this.config.autorotateSpeed/this.viewer.config.moveSpeed)),G.isNil(this.config.autorotatePitch)||this.viewer.dynamics.position.goto({pitch:this.config.autorotatePitch},Math.abs(this.config.autorotateSpeed/this.viewer.config.moveSpeed)))}))}__reset(){this.state.idx=-1,this.state.curve=[],this.state.startStep=null,this.state.endStep=null,this.state.startTime=null,this.state.stepDuration=null,this.state.remainingPause=null,this.state.lastTime=null,this.state.tooltip=null}__beforeRender(t){(this.state.initialStart||this.config.autostartOnIdle&&!this.state.disableOnIdle)&&this.viewer.state.idleTime>0&&t-this.viewer.state.idleTime>this.config.autostartDelay&&this.start(),this.isEnabled()&&this.keypoints&&(this.state.startTime||(this.state.endStep=pn(this.viewer.getPosition()),this.__nextStep(),this.state.startTime=t,this.state.lastTime=t),this.__nextFrame(t))}__shiftKeypoints(){const t=pn(this.viewer.getPosition()),e=this.__findMinIndex(this.keypoints,(e=>G.greatArcDistance(e.position,t)));this.keypoints.push(...this.keypoints.splice(0,e))}__incrementIdx(){this.state.idx++,this.state.idx===this.keypoints.length&&(this.state.idx=0)}__showTooltip(){const t=this.keypoints[this.state.idx];if(t.tooltip){const e=this.viewer.dataHelper.vector3ToViewerCoords(this.viewer.state.direction);this.state.tooltip=this.viewer.createTooltip({content:t.tooltip.content,position:t.tooltip.position,top:e.y,left:e.x})}else if(t.markerId){const e=this.markers.getMarker(t.markerId);e.showTooltip(),this.state.tooltip=e.tooltip}}__hideTooltip(){if(this.state.tooltip){const t=this.keypoints[this.state.idx];t.tooltip?this.state.tooltip.hide():t.markerId&&this.markers.getMarker(t.markerId).hideTooltip(),this.state.tooltip=null}}__nextPoint(){const t=[];if(-1===this.state.idx){const e=pn(this.viewer.getPosition());t.push(e,e,this.keypoints[0].position,this.keypoints[1].position)}else for(let o=-1;o<3;o++){const e=this.state.idx+o<0?this.keypoints[this.keypoints.length-1]:this.keypoints[(this.state.idx+o)%this.keypoints.length];t.push(e.position)}const e=[new f(t[0][0],t[0][1])];let i=0;for(let o=1;o<=3;o++){const s=t[o-1][0]-t[o][0];s>Math.PI?i+=1:s<-Math.PI&&(i-=1),0!==i&&1===o&&(e[0].x-=2*i*Math.PI,i=0),e.push(new f(t[o][0]+2*i*Math.PI,t[o][1]))}const s=new O(e).getPoints(48).map((t=>[t.x,t.y]));this.state.curve=s.slice(17,33),-1!==this.state.idx?(this.state.remainingPause=this.keypoints[this.state.idx].pause,this.state.remainingPause?this.__showTooltip():this.__incrementIdx()):this.__incrementIdx()}__nextStep(){0===this.state.curve.length&&(this.__nextPoint(),this.state.endStep[0]=G.parseAngle(this.state.endStep[0])),this.state.startStep=this.state.endStep,this.state.endStep=this.state.curve.shift();const t=G.greatArcDistance(this.state.startStep,this.state.endStep);this.state.stepDuration=1e3*t/Math.abs(this.config.autorotateSpeed),0===t&&this.__nextStep()}__nextFrame(t){const e=t-this.state.lastTime;if(this.state.lastTime=t,this.state.remainingPause){if(this.state.remainingPause=Math.max(0,this.state.remainingPause-e),this.state.remainingPause>0)return;this.__hideTooltip(),this.__incrementIdx(),this.state.startTime=t}let i=(t-this.state.startTime)/this.state.stepDuration;i>=1&&(this.__nextStep(),i=0,this.state.startTime=t),this.viewer.rotate({yaw:this.state.startStep[0]+(this.state.endStep[0]-this.state.startStep[0])*i,pitch:this.state.startStep[1]+(this.state.endStep[1]-this.state.startStep[1])*i})}__findMinIndex(t,e){let i=0,s=Number.MAX_VALUE;return t.forEach(((t,o)=>{const n=e(t);n<s&&(s=n,i=o)})),i}__onKeyPress(t){!this.viewer.state.keyboardEnabled||t.key!==A.KEY_CODES.Space||t.ctrlKey||t.altKey||t.shiftKey||t.metaKey||(this.toggle(),t.preventDefault())}});un.id="autorotate",un.VERSION="5.13.2",un.configParser=dn,un.readonlyOptions=["keypoints"],is(cn,"start"),Ki.lang[cn.id]="Automatic rotation"}}}));//# sourceMappingURL=@photo-sphere-viewer-legacy-B6e7Gidc.js.map
